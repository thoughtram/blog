<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/commons.743a077edf8bbf03e9ea.css">/*! normalize.css v7.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}[hidden],template{display:none}:root{--thtrm-color-darkblue:#456474;--thtrm-color-midblue:#4c91a7;--thtrm-color-blue:#69caff;--thtrm-color-lighterblue:#dbe8ec;--thtrm-color-teal:#42899b;--thtrm-color-lightblue:#72c7df;--thtrm-color-text:#000;--thtrm-color-lighttext:#7d7d7d;--thtrm-color-gray:#eee;--thtrm-color-lightgray:#f8f8f9;--thtrm-color-ultralightgray:#fbfbfb;--thtrm-color-white:#fff;--thtrm-rustforjs-yellow:#ffd45e;--thtrm-amc-red:#dd0031;--thtrm-git-orange:#de4c36;--thtrm-rxjs-pink:#b7178c;--thtrm-border-color:var(--thtrm-color-gray);--thtrm-base-font:Roboto;--thtrm-base-font-stack:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";--thtrm-base-fontweight:500;--thtrm-base-fontsize:19px;--thtrm-small-fontsize:calc(0.85*var(--thtrm-base-fontsize));--thtrm-nav-fontsize:calc(1*var(--thtrm-base-fontsize));--thtrm-h1-fontszize:calc(1.75*var(--thtrm-base-fontsize));--thtrm-h2-fontszize:calc(1.5*var(--thtrm-base-fontsize));--thtrm-h3-fontszize:calc(1.3*var(--thtrm-base-fontsize));--thtrm-h4-fontszize:calc(1.1*var(--thtrm-base-fontsize));--thtrm-page-margin:5vw;--thtrm-page-neg-margin:-5vw;--thtrm-layer-submarine:-1;--thtrm-layer-deco:9;--thtrm-layer-navigation:99;--thtrm-layer-surface:99999999999}@font-face{font-family:Roboto;font-style:normal;font-weight:300;src:local("Roboto"),local("Roboto")}@font-face{font-family:Roboto;font-weight:500;src:local("Roboto Medium"),local("Roboto Medium")}@font-face{font-family:Roboto;font-style:italic;font-weight:500;src:local("Roboto Medium Italic"),local("Roboto-MediumItalic")}*,:after,:before{box-sizing:border-box;margin:0;padding:0}html{font-family:var(--thtrm-base-font),var(--thtrm-base-font-stack);font-size:var(--thtrm-base-fontsize);font-weight:var(--thtrm-base-fontweight);line-height:1.45;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body{position:relative}h1,h2,h3,h4{font-weight:var(--thtrm-bold-fontweight);line-height:1.2;letter-spacing:0;margin:0}h1{font-size:var(--thtrm-h1-fontszize)}a{color:var(--thtrm-color-midblue);text-decoration:none}.thtrm-page--yellow a{color:#000}a:after{color:currentColor;content:"\203A";font-weight:400;font-size:1.15em;margin-left:.25em}a[title=Home]:after{display:none}img{width:100%;height:auto}@media screen and (min-width:80em){:root{--thtrm-base-fontsize:25px;--thtrm-small-fontsize:calc(0.75*var(--thtrm-base-fontsize));--thtrm-nav-fontsize:calc(1*var(--thtrm-base-fontsize));--thtrm-h1-fontszize:calc(2.25*var(--thtrm-base-fontsize));--thtrm-h2-fontszize:calc(2*var(--thtrm-base-fontsize));--thtrm-page-margin:10vw;--thtrm-page-neg-margin:-10vw}}@media screen and (min-width:120em){:root{--thtrm-base-fontsize:27px}}.thtrm-page{padding-left:5vw;padding-right:5vw;overflow-x:hidden}.thtrm-page.thtrm-page--yellow{background-color:var(--thtrm-rustforjs-yellow)}.thtrm-banner{display:flex;align-items:center;justify-content:space-between;height:90px}@media screen and (min-width:80em){.thtrm-page{padding-left:10vw;padding-right:10vw}.thtrm-banner{height:160px}}@media screen and (min-width:120em){.thtrm-page{padding-left:10vw;padding-right:10vw}.thtrm-banner{height:260px}}@supports (display:grid){.thtrm-page{display:grid;grid-template-columns:[pad-left] 5vw [center] 90vw [pad-left] 5vw;grid-template-rows:[banner] 90px [main] auto [aside] auto [footer] auto;padding-left:0;padding-right:0}@media screen and (min-width:80em){.thtrm-page{grid-template-columns:[pad-left] 10vw [center] 80vw [pad-left] 10vw;grid-template-rows:[banner] 160px [main] auto [aside] auto [footer] auto}}@media screen and (min-width:120em){.thtrm-page{grid-template-columns:[pad-left] 10vw [center] 80vw [pad-left] 10vw;grid-template-rows:[banner] 260px [main] auto [aside] auto [footer] auto}}.thtrm-banner{height:auto;grid-row-start:1;grid-row-end:1}.thtrm-banner,.thtrm-main{grid-column-start:2;grid-column-end:2}.thtrm-main{grid-row-start:2;grid-row-end:2}.thtrm-aside{grid-row-start:3;grid-row-end:3}.thtrm-aside,.thtrm-footer{grid-column-start:2;grid-column-end:2}.thtrm-footer{grid-row-start:4;grid-row-end:4}}.thtrm-banner{position:relative}.thtrm-footer{border-top:5px solid var(--thtrm-color-text);font-size:var(--thtrm-small-fontsize);padding:2rem 0;margin-top:2rem}.thtrm-footer .thtrm-sitemap{margin-bottom:2rem}.thtrm-footer .thtrm-sitemap__heading{font-size:var(--thtrm-base-fontsize);margin-top:1rem;margin-bottom:.5rem}.thtrm-footer .thtrm-copyright{display:flex;align-items:center;justify-content:space-between}.thtrm-footer .thtrm-sitemap nav ul{list-style:none}.thtrm-footer .thtrm-sitemap nav li a{text-decoration:none}.thtrm-footer .thtrm-sitemap nav li a:after{color:currentColor;content:"\203A";font-weight:400;font-size:1.15em;margin-left:.25em}@media screen and (min-width:31.5em){.thtrm-footer .thtrm-sitemap{display:grid;grid-template-columns:33.33333333333% 33.33333333333% 33.33333333333%;margin-bottom:2rem}.thtrm-footer .thtrm-sitemap__item{-ms-grid-column-span:1}.thtrm-footer .thtrm-sitemap__item:first-of-type{-ms-grid-column:1}.thtrm-footer .thtrm-sitemap__item:nth-of-type(2){-ms-grid-column:2}.thtrm-footer .thtrm-sitemap__item:nth-of-type(3){-ms-grid-column:3}.thtrm-footer .thtrm-sitemap__heading{margin-top:0;margin-bottom:1rem}}.thtrm-box{background-color:var(--thtrm-color-midblue);color:var(--thtrm-color-white);font-size:var(--thtrm-small-fontsize);padding:1.5rem;width:100%}.thtrm-box--light{background-color:var(--thtrm-color-lightblue)}.thtrm-box--red{background-color:var(--thtrm-amc-red)}.thtrm-box--red,.thtrm-box--white{box-shadow:0 2px 24px 0 rgba(0,0,0,.04)}.thtrm-box--white{background-color:var(--thtrm-color-white);color:var(--thtrm-color-text)}.thtrm-box--dark{background-color:var(--thtrm-color-darkblue)}.thtrm-box--mid{background-color:var(--thtrm-color-teal)}.thtrm-box>.thtrm-box__heading{margin-bottom:1rem}.thtrm-box--offset-left,.thtrm-box--offset-right{margin-bottom:.5rem}.thtrm-box>.thtrm-box__more-link{color:var(--thtrm-color-white);display:block;font-size:var(--thtrm-base-fontsize);text-decoration:none;margin-top:1rem}@media screen and (min-width:43.75em){.thtrm-box{padding:2rem}.thtrm-box:not([class*=thtrm-box--offset]){width:auto}.thtrm-box--offset-left,.thtrm-box--offset-right{margin-bottom:1rem;position:absolute;top:2.5rem;width:80%;right:-70%;z-index:var(--thtrm-layer-deco)}.thtrm-box--offset-right{right:-70%}.thtrm-box--offset-left{left:-70%}}.thtrm-button,[class*=thtrm-button],[class^=thtrm-button]{border:none;background-color:var(--thtrm-color-darkblue);color:var(--thtrm-color-white);display:inline-block;font-weight:var(--thtrm-base-fontweight);font-size:inherit;padding:.5rem 1rem;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.thtrm-page--yellow .thtrm-button,.thtrm-page--yellow [class*=thtrm-button],.thtrm-page--yellow [class^=thtrm-button]{background-color:#000}.thtrm-button--bordered{border:4px solid;background-color:transparent}.thtrm-button--ghost{color:inherit;padding:.25rem}.thtrm-button--ghost,.thtrm-page--yellow .thtrm-button--ghost{background-color:transparent}.thtrm-card{background-color:var(--thtrm-color-midblue);color:var(--thtrm-color-white);font-size:var(--thtrm-small-fontsize);padding:1rem;width:100%}.thtrm-card--red{background-color:var(--thtrm-amc-red)}.thtrm-card--black,.thtrm-card--red{box-shadow:0 2px 24px 0 rgba(0,0,0,.04)}.thtrm-card--black{background-color:var(--thtrm-git-orange)}.thtrm-card--pink{background-color:var(--thtrm-rxjs-pink)}.thtrm-card--pink,.thtrm-card--white{box-shadow:0 2px 24px 0 rgba(0,0,0,.04)}.thtrm-card--white{background-color:var(--thtrm-color-white);color:var(--thtrm-color-text)}.thtrm-card>.thtrm-card__heading{margin-bottom:1rem}.thtrm-card__topic{font-size:.625rem;margin-bottom:.5rem;color:var(--thtrm-color-white);text-transform:uppercase;letter-spacing:.02em}.thtrm-card__topic.thtrm-card__topic--red{color:var(--thtrm-amc-red)}.thtrm-card__topic.thtrm-card__topic--pink{color:var(--thtrm-rxjs-pink)}.thtrm-card__topic.thtrm-card__topic--grey{color:var(--thtrm-color-lighttext)}.thtrm-card__topic.thtrm-card__topic--black{color:var(--thtrm-git-orange)}.thtrm-card__list{list-style:none}.thtrm-card__list li{position:relative;padding-left:1rem;margin-top:.5em;line-height:1.2}.thtrm-card__list li:before{content:"\2192   ";margin-left:-1rem;position:absolute}.thtrm-card__paragraph{margin:.5rem 0}.thtrm-card__link{color:inherit}@media screen and (min-width:43.75em){.thtrm-card{padding:1.5rem}}.thtrm-form .thtrm-form__label{display:none}.thtrm-form .thtrm-form__input--text{background-color:var(--thtrm-color-gray);border:none;font-size:inherit;padding:.5rem 1rem;min-width:40%}.thtrm-form__info-text{font-size:.4rem;font-weight:400;max-width:500px;color:#aaa;margin:.4em auto auto}.thtrm-form__info-text a{text-decoration:underline;color:#aaa}.thtrm-form__info-text a:after{display:none}.thtrm-form__row{margin-top:16px}.thtrm-form__column-group{display:grid;grid-column-gap:24px;grid-template-columns:1fr 1fr;grid-template-rows:auto auto}.thtrm-form__column-group label{grid-row:1}.thtrm-form__column-group input{grid-row:2}.thtrm-icon,[class^=thtrm-icon--]{color:inherit;display:inline-block;vertical-align:middle;transition:all .25s linear;height:24px;width:24px}svg.thtrm-icon,svg[class^=thtrm-icon]{fill:currentColor}svg.thtrm-icon path:not([fill=none]),svg.thtrm-icon use,svg[class^=thtrm-icon] path:not([fill=none]),svg[class^=thtrm-icon] use{fill:inherit}.thtrm-image-grid{display:flex;flex-flow:column wrap;align-items:center;justify-content:space-around;z-index:var(--thtrm-layer-submarine);margin-top:-.25rem}.thtrm-image-grid img{text-align:center;-o-object-fit:contain;object-fit:contain;font-family:"object-fit: contain;";width:50%;max-width:200px;max-height:200px}@media screen and (min-width:20em){.thtrm-image-grid{flex-flow:row wrap}}@media screen and (min-width:43.75em){.thtrm-image-grid img{width:25%;max-width:18%;max-height:250px;-o-object-fit:contain;object-fit:contain;font-family:"object-fit: contain;"}}.thtrm-layout{display:grid;grid-gap:1rem;padding:1rem;width:100%}.thtrm-layout.thtrm-layout-fourths,.thtrm-layout.thtrm-layout-halfs,.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr}@media screen and (min-width:43.75em){.thtrm-layout.thtrm-layout-fourths,.thtrm-layout.thtrm-layout-halfs,.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr 1fr}}@media screen and (min-width:50em){.thtrm-layout.thtrm-layout-fourths,.thtrm-layout.thtrm-layout-halfs,.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr 1fr}}@media screen and (min-width:64em){.thtrm-layout.thtrm-layout-halfs,.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr 1fr}.thtrm-layout.thtrm-layout-fourths{grid-template-columns:1fr 1fr 1fr}}@media screen and (min-width:80em){.thtrm-layout{grid-gap:1.5rem;padding:1.5rem}.thtrm-layout.thtrm-layout-halfs{grid-template-columns:1fr 1fr}.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr 1fr 1fr}.thtrm-layout.thtrm-layout-fourths{grid-template-columns:1fr 1fr 1fr 1fr}}@media screen and (min-width:120em){.thtrm-layout{display:grid;grid-gap:1.5rem}.thtrm-layout.thtrm-layout-halfs{grid-template-columns:1fr 1fr}.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr 1fr 1fr}.thtrm-layout.thtrm-layout-fourths{grid-template-columns:1fr 1fr 1fr 1fr 1fr}}.thtrm-logo{max-height:45px;width:160px;margin-top:-1.65rem}@media screen and (min-width:80em){.thtrm-logo{max-height:80px;width:200px;margin-top:-1rem}}@media screen and (min-width:120em){.thtrm-logo{max-height:100px;width:380px}}.thtrm-nav{display:flex;align-items:center;justify-content:space-between;font-size:var(--thtrm-nav-fontsize)}.thtrm-nav .thtrm-nav__list{background-color:var(--thtrm-color-lightgray);box-shadow:0 1px 2px rgba(50,50,50,.1);list-style:none;text-align:left;position:absolute;right:0;top:70%;width:auto;z-index:99;opacity:0;visibility:hidden;transition:.25s;transform:translate3d(0,-10%,0);padding:1rem .5rem}.thtrm-nav .thtrm-nav__list:before{content:"";width:10px;height:10px;border-right:6px solid transparent;border-left:6px solid transparent;border-bottom:6px solid var(--thtrm-color-lightgray);position:absolute;top:-10px;right:10px}.thtrm-nav .thtrm-nav__list li{padding:0 1rem;margin-top:.5rem}.thtrm-nav .thtrm-nav__list a{color:var(--thtrm-color-text);font-weight:var(--thtrm-base-fontweight);text-decoration:none;transition:.25s}.thtrm-nav .thtrm-nav__list a.active{border-bottom:2px solid var(--thtrm-color-text);padding-bottom:.3em}.thtrm-nav .thtrm-nav__list a:hover{color:var(--thtrm-color-blue)}.thtrm-nav .thtrm-nav__list a:after{content:""}.no-js .thtrm-nav .thtrm-nav__button:focus+.thtrm-nav__list,.no-js .thtrm-nav .thtrm-nav__button:hover+.thtrm-nav__list,.no-js .thtrm-nav__list:hover,.thtrm-nav__list.is-visible{opacity:1;pointer-events:all;visibility:visible;transform:translateZ(0)}.thtrm-nav-toc{border-top:3px solid #000;font-size:.75rem}.thtrm-nav-toc li{display:inline-block}.thtrm-nav-toc li:first-child a{padding-left:0}.thtrm-nav-toc li:last-child a{padding-right:0}.thtrm-nav-toc a{color:var(--thtrm-color-text);display:block;padding:.75rem 1rem}.thtrm-nav-toc a.is-active{color:var(--thtrm-color-midblue)}.thtrm-nav-toc a:after{content:""}@media screen and (min-width:50em){.thtrm-nav .thtrm-nav__list li:last-of-type{padding-right:0}.thtrm-nav .thtrm-nav__button,.thtrm-nav .thtrm-nav__list:before{display:none}.thtrm-nav .thtrm-nav__list{background-color:transparent;box-shadow:none;display:flex;flex-flow:row wrap;align-items:center;justify-content:flex-end;opacity:1;pointer-events:all;visibility:visible;transform:translateZ(0);position:static}}[class*=thtrm-ratio--]{position:relative}[class*=thtrm-ratio--]:before{content:"";display:block;width:100%}[class*=thtrm-ratio--]>*{position:absolute;bottom:0;left:0;right:0;top:0}[class*=thtrm-ratio--]>img{height:100%;-o-object-fit:cover;object-fit:cover}.thtrm-ratio--landscape:before{padding-top:75%}.thtrm-ratio--square:before{padding-top:100%}.thtrm-ratio--stripe:before{padding-top:50%}.thtrm-section,[class^=thtrm-section--]{position:relative;margin-bottom:3rem}.thtrm-section .thtrm-section__item,[class^=thtrm-section--] .thtrm-section__item{width:100%}.thtrm-section .thtrm-section__heading,[class^=thtrm-section--] .thtrm-section__heading{width:100%;margin-top:1.5rem;margin-bottom:.75rem}.thtrm-section .thtrm-section__paragraph,[class^=thtrm-section--] .thtrm-section__paragraph{margin-bottom:1rem}.thtrm-section .thtrm-section__paragraph a:after,[class^=thtrm-section--] .thtrm-section__paragraph a:after{display:none}.thtrm-section .thtrm-section__paragraph--small,[class^=thtrm-section--] .thtrm-section__paragraph--small{font-size:.8rem;font-weight:400}.thtrm-section .thtrm-section__link,[class^=thtrm-section--] .thtrm-section__link{display:inline-block;margin-bottom:1rem}.thtrm-section .thtrm-section__link--black,[class^=thtrm-section--] .thtrm-section__link--black{color:#000}.thtrm-section .thtrm-section__link--black .thtrm-section__link,[class^=thtrm-section--] .thtrm-section__link--black .thtrm-section__link{color:var(--thtrm-color-midblue)}.thtrm-section .thtrm-section__link--black .thtrm-section__link:after,[class^=thtrm-section--] .thtrm-section__link--black .thtrm-section__link:after{color:currentColor}.thtrm-section .thtrm-section__heading--unpadded-top,[class^=thtrm-section--] .thtrm-section__heading--unpadded-top{width:100%;margin-top:0;margin-bottom:.75rem}.thtrm-section .thtrm-section__heading--small,[class^=thtrm-section--] .thtrm-section__heading--small{width:100%;margin-bottom:1rem;font-size:1.25rem;line-height:1.3}.thtrm-section--centered{text-align:center}.thtrm-section--unpadded-bottom{margin-bottom:0}.thtrm-section--fullbleed{margin-left:-5vw;margin-right:-5vw;min-height:300px}.thtrm-section--fullbleed-intrinsic{margin-left:-5vw;margin-right:-5vw;margin-top:0}@media screen and (min-width:80em){.thtrm-section--fullbleed-intrinsic{margin-left:-10vw;margin-right:-10vw}}.thtrm-section--privacy-statement li,.thtrm-section--privacy-statement p,.thtrm-section--privacy-statement strong{font-size:.8rem;font-weight:400}.thtrm-section--privacy-statement p,.thtrm-section--privacy-statement ul{margin-bottom:.75rem}.thtrm-section--privacy-statement ul{margin-left:1rem}.thtrm-section--privacy-statement h3,.thtrm-section--privacy-statement h4{margin-bottom:1rem;margin-top:.5rem}.thtrm-stripe--fullwidth{font-weight:700;color:#fff;font-size:1.5rem;height:6rem;text-align:center;display:flex;width:100%;align-items:center;justify-content:center}.thtrm-section__footer,.thtrm-section__header{text-align:center;width:100%;padding:2rem 5vw}.thtrm-section__footer p+a,.thtrm-section__header p+a{display:inline-block;margin-top:2em}.thtrm-section__footer p>a:after,.thtrm-section__header p>a:after{display:none}.thtrm-section__subheading{margin-bottom:1rem}.thtrm-section--offright-white{background-color:var(--thtrm-color-white)}.thtrm-section__item--flushleft,.thtrm-section__item--flushright,.thtrm-section__item--fullwidth,.thtrm-section__item--halfpadded{width:100%}.thtrm-section__item--columns>*{margin-bottom:1rem}.thtrm-section__item--columns{font-size:var(--thtrm-small-fontsize);left:0}.thtrm-section__hero{width:100%;position:relative;margin-top:1rem;padding-top:6.25rem}.thtrm-section__hero .thtrm-section__hero-image{height:6.25rem;width:6.25rem;-o-object-fit:contain;object-fit:contain;position:absolute;left:0;top:0;z-index:var(--thtrm-layer-deco)}@media screen and (min-width:64em){.thtrm-section__hero{padding-left:16rem;margin-top:2rem;padding-top:0}.thtrm-section__hero .thtrm-section__hero-image{height:14rem;width:14rem}}@media screen and (min-width:120em){.thtrm-section__hero{width:75%}}.thtrm-content-box{background-color:var(--thtrm-color-darkblue);color:var(--thtrm-color-white);font-size:var(--thtrm-small-fontsize);padding:2rem;z-index:var(--thtrm-layer-deco)}.thtrm-section-constrained{max-width:800px;margin-left:auto;margin-right:auto;width:100%}@media screen and (min-width:50em){.thtrm-section--fullbleed{margin-left:var(--thtrm-page-neg-margin);margin-right:var(--thtrm-page-neg-margin);height:50vh;min-height:600px}}@media screen and (min-width:43.75em){.thtrm-section,[class^=thtrm-section--]{display:flex;flex-flow:row wrap;position:relative}.thtrm-section .thtrm-section__item,[class^=thtrm-section--] .thtrm-section__item{width:50%}.thtrm-section .thtrm-section__item--halfpadded,[class^=thtrm-section--] .thtrm-section__item--halfpadded{width:calc(50% - 5vw)}.thtrm-section .thtrm-section__item--flushright,[class^=thtrm-section--] .thtrm-section__item--flushright{position:relative;right:var(--thtrm-page-neg-margin);width:calc(50% + 5vw)}.thtrm-section .thtrm-section__item--flushleft,[class^=thtrm-section--] .thtrm-section__item--flushleft{position:relative;left:var(--thtrm-page-neg-margin);width:calc(50% + 5vw)}.thtrm-section .thtrm-section__item--pulldown,[class^=thtrm-section--] .thtrm-section__item--pulldown{position:relative;transform:translateY(50%);z-index:var(--thtrm-layer-deco)}.thtrm-section .thtrm-section__item--flushright-maxed,[class^=thtrm-section--] .thtrm-section__item--flushright-maxed{position:relative;right:var(--thtrm-page-neg-margin);width:calc(50% + 10vw)}.thtrm-section .thtrm-section__item--flushleft-maxed,[class^=thtrm-section--] .thtrm-section__item--flushleft-maxed{position:relative;left:var(--thtrm-page-neg-margin);width:calc(50% + 10vw)}.thtrm-section .thtrm-content-box,[class^=thtrm-section--] .thtrm-content-box{position:absolute;right:0;bottom:0;max-width:70%;transform:translate3d(0,50%,0)}.thtrm-section--undercut-bottom{margin-bottom:-2rem;z-index:var(--thtrm-layer-deco)}.thtrm-section--offright-white{background-color:var(--thtrm-color-white);max-width:70%;position:relative;right:-5%}.thtrm-section--fullbleed{margin-top:6rem}.thtrm-section__item--columns{display:grid;grid-template-columns:50% 50%;font-size:var(--thtrm-small-fontsize)}.thtrm-section__item--columns>*{margin-left:2%;margin-right:2%;-ms-grid-column-span:1}.thtrm-section__item--columns>:nth-child(odd){-ms-grid-column:1}.thtrm-section__item--columns>:nth-child(2n){-ms-grid-column:2}}@media screen and (min-width:64em){.thtrm-section__item--columns{display:grid;grid-template-columns:33% 33% 33%;font-size:var(--thtrm-small-fontsize)}.thtrm-section__item--columns>*{margin-bottom:.75rem}.thtrm-section__item--columns>:nth-child(3n+1){-ms-grid-column:1}.thtrm-section__item--columns>:nth-child(3n+2){-ms-grid-column:2}.thtrm-section__item--columns>:nth-child(3n+3){-ms-grid-column:3}}@media screen and (min-width:80em){.thtrm-section--padded-bottom{margin-bottom:7rem}.thtrm-section--offright-white{max-width:70%}.thtrm-section__footer p{padding-left:4em;padding-right:4em}}@media screen and (min-width:120em){.thtrm-section,[class^=thtrm-section--]{margin-bottom:5rem}.thtrm-section--fullbleed{height:50vh;min-height:700px}.thtrm-section--offright-white{max-width:50%;right:-30%}}.thtrm-stripe{background-color:var(--thtrm-color-lightblue);color:var(--thtrm-color-white);text-align:center;display:flex;flex-flow:column nowrap;align-items:center;justify-content:space-between;padding:1rem 2rem;min-height:140px;margin:auto;position:relative;z-index:var(--thtrm-layer-deco)}.thtrm-stripe .thtrm-stripe__cta,.thtrm-stripe .thtrm-stripe__location,.thtrm-stripe .thtrm-stripe__title{margin:.5rem 0}@media screen and (min-width:50em){.thtrm-stripe{flex-flow:row nowrap;position:absolute;left:var(--thtrm-page-margin);right:var(--thtrm-page-margin);transform:translateY(-50%)}}.thtrm-testimonials{width:90vw;display:block;overflow:hidden}.thtrm-testimonial{position:relative;width:100%;padding-top:1.75rem;font-size:1rem;line-height:1.5;white-space:normal;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.thtrm-testimonial:before{position:absolute;content:"\201C";top:-35px;left:20px;font-size:8rem;color:var(--thtrm-color-text);z-index:9999}.thtrm-testimonial>.thtrm-testimonial__avatar{display:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none}.thtrm-testimonial>.thtrm-testimonial__quote{background-color:var(--thtrm-color-gray);padding:50px 30px 30px}.thtrm-testimonial>.thtrm-testimonial__quote cite{color:var(--thtrm-color-darkblue);font-size:.75em}.thtrm-testimonial--big{position:relative;right:0;margin-left:auto;max-width:100%}.thtrm-testimonial--big>.thtrm-testimonial__quote{background-color:var(--thtrm-color-white);padding:1rem 0 0;font-weight:400;font-style:italic}.thtrm-testimonial--big>.thtrm-testimonial__avatar{max-width:200px}.thtrm-testimonial--big>.thtrm-testimonial__quote cite{color:var(--thtrm-color-darkblue);font-size:.75em;font-style:normal;font-weight:var(--thtrm-base-fontweight);margin-top:.5rem}.thtrm-testimonial--big .thtrm-testimonial__heading{font-weight:var(--thtrm-base-fontweight);font-style:normal;margin-bottom:1rem}.thtrm-testimonials__navigation{margin-top:.5rem;text-align:center;width:100%}.thtrm-testimonials__thumbnail{width:50px;height:50px;-o-object-fit:cover;object-fit:cover;opacity:.5;font-family:"object-fit: cover;"}.is-active .thtrm-testimonials__thumbnail{opacity:1;transition:.25s}@media screen and (min-width:50em){.thtrm-testimonial{position:relative;width:100%;padding-top:50px}.thtrm-testimonial>.thtrm-testimonial:before{top:-65px;left:0;font-size:10rem}.thtrm-testimonials__thumbnail{width:100px;height:100px}.thtrm-testimonial>.thtrm-testimonial__quote{padding:68px 68px 68px 210px;max-width:80%;position:relative;left:10%;top:0;z-index:98;margin-top:40px}.thtrm-testimonial>.thtrm-testimonial__avatar{display:block;position:absolute;left:3%;top:40px;max-width:240px;z-index:99}.thtrm-testimonial--big{position:relative;right:0;margin-left:auto;top:-300px;max-width:55%;margin-bottom:-300px}.thtrm-testimonial--big>.thtrm-testimonial__quote{background-color:var(--thtrm-color-white);padding:2rem 3rem 0;font-weight:400;font-style:italic;font-size:1.25rem}.thtrm-testimonial--big>.thtrm-testimonial__avatar{position:absolute;bottom:0;left:-200px;max-width:200px}.thtrm-testimonial--big>.thtrm-testimonial__quote cite{color:var(--thtrm-color-darkblue);font-size:.75em;font-style:normal;font-weight:var(--thtrm-base-fontweight);margin-top:.5rem}.thtrm-testimonial--big .thtrm-testimonial__heading{font-weight:var(--thtrm-base-fontweight);font-style:normal;margin-bottom:1rem}}@media screen and (min-width:80em){.thtrm-testimonials{width:80vw}}.thtrm-testimonials .frame{width:100%;position:relative;font-size:0;line-height:0;overflow:hidden;white-space:nowrap}.thtrm-testimonials .slides{display:block}.thtrm-testimonials li{cursor:grab;cursor:-webkit-grab}.thtrm-testimonials li,.thtrm-testimonials li:active{position:relative;display:inline-block;width:100%;vertical-align:top}.thtrm-testimonials li:active{cursor:grabbing;cursor:-webkit-grabbing}.thtrm-teaser{display:flex;flex-direction:column}.thtrm-teaser img{display:block}.thtrm-teaser--row{align-items:flex-start;flex-direction:row;justify-content:space-between}.thtrm-teaser--row .thtrm-teaser__thumb{display:none;margin-top:0;width:160px}@media screen and (min-width:64em){.thtrm-teaser--row .thtrm-teaser__thumb{display:block}}.thtrm-teaser__thumb{margin-top:12px}.thtrm-teaser__title{margin-top:4px}.thtrm-teaser__paragraph{margin-top:8px}.thtrm-teaser__link{margin-top:12px}.thtrm-raw-link{color:var(--thtrm-color-text)}.thtrm-raw-link:hover{color:var(--thtrm-color-midblue)}.thtrm-raw-link:after{display:none}.thtrm-listing{display:flex;flex-direction:column;width:100%}.thtrm-listing__item{margin-top:24px;padding-top:24px;border-top:1px solid var(--thtrm-border-color)}.thtrm-page--yellow .thtrm-listing__item{border-top-color:#000}.thtrm-topic{font-size:var(--thtrm-small-fontsize)}.thtrm-title{font-size:var(--thtrm-h4-fontszize)}.thtrm-article{font-weight:300}.thtrm-article h2,.thtrm-article h3,.thtrm-article h4{margin-top:48px;font-weight:500}.thtrm-article h2:first-child,.thtrm-article h3:first-child,.thtrm-article h4:first-child{margin-top:0}.thtrm-article h2 code,.thtrm-article h3 code,.thtrm-article h4 code{margin:0;padding:0;background:transparent!important;color:inherit;font-family:inherit;font-size:inherit;line-height:inherit;text-shadow:inherit}.thtrm-article a:after{display:none}.thtrm-article p{margin-top:24px;font-size:.8rem}.thtrm-article p code{background-color:var(--thtrm-color-gray)!important;color:var(--thtrm-color-midblue)!important;text-shadow:none!important}.thtrm-article p:first-child{margin-top:0}.thtrm-article ol,.thtrm-article ul{margin-top:24px;padding-left:24px;font-size:.8rem}.thtrm-article ol li,.thtrm-article ul li{margin-top:12px}.thtrm-article ol li code,.thtrm-article ul li code{background-color:var(--thtrm-color-gray);color:var(--thtrm-color-midblue)}.thtrm-article ol li:first-child,.thtrm-article ul li:first-child{margin-top:0}.thtrm-article .gatsby-highlight{margin-top:24px;font-size:.65rem}.thtrm-article code{font-size:.65rem}.thtrm-article iframe{margin-top:24px;width:100%;min-height:400px}.thtrm-article-thumb{margin-bottom:32px}.thtrm-article-caption{margin-top:-16px;font-size:.6rem;width:100%;text-align:right}.thtrm-article-caption a:after{display:none}.thtrm-article-header{text-align:center}.thtrm-article-header,.thtrm-article-header__metabar,.thtrm-media{justify-content:center}.thtrm-media{align-items:center;display:grid;grid-template-rows:auto 1fr;text-align:center}@media screen and (min-width:64em){.thtrm-media{align-items:center;grid-template-columns:200px 1fr;grid-template-rows:none;justify-content:flex-start;text-align:left}}.thtrm-media__asset{margin:0 auto;max-width:200px}@media screen and (min-width:64em){.thtrm-media__asset{grid-column:1;max-width:none}}@media screen and (min-width:64em){.thtrm-media__body{grid-column:2}}.thtrm-media--top-start{align-items:flex-start}.thtrm-media-short{display:flex;flex-direction:row}.thtrm-media-short__body{padding-left:8px}.thtrm-avatar{height:25px;width:25px;border-radius:150px}.thtrm-metabar{flex-wrap:wrap;margin-top:-12px}.thtrm-metabar,.thtrm-metabar__item{align-items:center;display:flex;flex-direction:row}.thtrm-metabar__item{margin-top:4px}.thtrm-metabar__item:after{content:"/ ";padding:0 8px}.thtrm-metabar__item:last-child:after{display:none}.u-text--centered{text-align:center}.u-flex{align-items:center;display:flex;flex-direction:row}.u-flex--start{align-items:flex-start}.u-link-plain:after{display:none}.u-flex--nowrap{flex-wrap:nowrap}.u-flex--justify-center{justify-content:center}.u-flex--justify-end{justify-content:flex-end}.u-distance-reset{margin-top:0!important}.u-distance-tiny{margin-top:8px}.u-distance-small{margin-top:16px}.u-distance{margin-top:24px}.u-distance-medium{margin-top:48px}.u-distance-large{margin-top:100px}.u-distance-bottom-reset{margin-bottom:0!important}.u-unflex{display:block}.u-text--bigger{font-size:2em;line-height:1}.u-text--small{font-size:var(--thtrm-small-fontsize)}.u-min-h1{min-height:712px}.u-img-fit-height{height:100%;-o-object-fit:cover;object-fit:cover;font-family:"object-fit: cover;"}.u-mega-padding-bottom{margin-bottom:200px}.u-offscreen-text{position:absolute;left:-5000px}.u-fill-space{height:100%;width:100%}.u-color--red{color:var(--thtrm-amc-red)}.u-color--pink{color:var(--thtrm-rxjs-pink)}.u-color--grey{color:var(--thtrm-color-lighttext)}.u-bg-lightgray{background-color:var(--thtrm-color-ultralightgray)}.u-bg--red{background-color:var(--thtrm-amc-red)}.u-bg--pink{background-color:var(--thtrm-rxjs-pink)}.u-bg--orange{background-color:var(--thtrm-git-orange)}.u-color--orange{color:var(--thtrm-git-orange)}@media screen and (min-width:50em){.u-max-width--half{max-width:50%;margin:0 auto;width:100%}}@media screen and (min-width:50em){.u-max-width--3-4{max-width:75%;margin:0 auto;width:100%}}</style><style data-href="/styles.246d67a4ef7e9adeefa5.css">code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#f8f8f2}.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.15.21"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#384c54"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=50794189bf1d1bd3459211725d37e57e"/><title data-react-helmet="true">A web app with Nickel: From first line to Heroku deployment | Articles by thoughtram</title><meta data-react-helmet="true" name="description" content="Learn how to build and deploy a simple web application with Nickel, the web application server for the Rust language."/><meta data-react-helmet="true" name="google-site-verification" content="o9eGPEgIETEqYGombq7NiQuBIB_qa6gz1yAL7PxKyK0"/><meta data-react-helmet="true" name="theme-color" content="#384c54"/><meta data-react-helmet="true" property="og:title" content="A web app with Nickel: From first line to Heroku deployment"/><meta data-react-helmet="true" property="og:description" content="Learn how to build and deploy a simple web application with Nickel, the web application server for the Rust language."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="thoughtram"/><meta data-react-helmet="true" name="twitter:title" content="A web app with Nickel: From first line to Heroku deployment"/><meta data-react-helmet="true" name="twitter:description" content="Learn how to build and deploy a simple web application with Nickel, the web application server for the Rust language."/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-6a14d6c49d22aa388ff9.js"/><link as="script" rel="preload" href="/styles-e0e38ca7b54561c3f057.js"/><link as="script" rel="preload" href="/commons-9a6c7e4a80f98fe6d0b9.js"/><link as="script" rel="preload" href="/app-db11fdec89ef44788bcc.js"/><link as="script" rel="preload" href="/webpack-runtime-c99afa6b532686815600.js"/><link as="fetch" rel="preload" href="/page-data/rust/2015/07/29/a-web-app-with-nickel-from-first-line-to-heroku-deployment.html/page-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="thtrm-page undefined"><header class="thtrm-banner" role="banner"><a href="https://thoughtram.io" title="Home"><img src="/static/logo-8fe34043fb96d58a991170a33702a469.svg" alt="thoughtram" class="thtrm-logo" title="The thoughtram logo"/></a></header><main class="thtrm-main" role="main"><nav class="thtrm-nav-toc"><a title="Back to Blog" href="/">← Back to Blog</a></nav><div style="margin:auto;text-align:center;min-height:30px" id="codefund"></div><script type="text/javascript" src="https://app.codefund.io/properties/723/funder.js" async=""></script><section class="thtrm-section u-distance-bottom-reset"><div class="thtrm-section__heading thtrm-article-header thtrm-section-constrained u-distance-bottom-reset"><div class="thtrm-metabar thtrm-article-header__metabar"><div class="thtrm-metabar__item thtrm-topic u-color--grey"><div class="thtrm-media-short"><img alt="Author" src="https://avatars0.githubusercontent.com/u/521109?s=460&amp;v=4" class="thtrm-avatar"/><p class="thtrm-media-short__body"><a href="https://twitter.com/cburgdorf" class="u-link-plain">Christoph Burgdorf</a></p></div></div><time dateTime="29 July 2015" class="thtrm-metabar__item thtrm-topic u-color--grey">29 July 2015</time><p class="thtrm-metabar__item thtrm-topic u-color--grey"><a class="u-link-plain" href="/categories/rust">Rust</a></p></div><h1 class="thtrm-section__subheading u-distance-tiny">A web app with Nickel: From first line to Heroku deployment</h1></div></section><section class="thtrm-section thtrm-section-constrained thtrm-article u-distance"><p style="text-align:center;font-style:italic;width:100%;margin-bottom:1em">New to Rust? Check out my <a href="https://youtube.com/c/PascalPrecht" target="_blank">YouTube channel</a> or my <strong>free</strong> <a href="https://egghead.io/courses/write-your-first-program-with-the-rust-language" target="_blank">introduction course</a> on Egghead!</p><div class="thtrm-section__heading u-distance-reset"><p>Occasionally people ask about <a href="http://nickel.rs">Nickel</a> projects that they can dig into to get a feel of some real world Nickel code. In case you never heard of Nickel, it’s a web application server written in Rust. We thought it’d be nice to write a simple web application with Nickel, deploy it to Heroku and blog about it.</p>
<h2>Defining the scope of the application</h2>
<p>What’s better than dog fooding your project? Dog fooding two of your projects at once! In case you missed it, with the help of awesome contributors, we created <a href="https://github.com/thoughtram/clog">Clog</a> which is a small tool to generate nice changelogs from semantic Git histories. Clog parses commit messages that follow the Angular commit message conventions which are quite popular among many projects such as <a href="http://github.com/angular/angular">Angular</a>, <a href="https://github.com/angular-translate/angular-translate">angular-translate</a>, <a href="https://github.com/hoodiehq/hoodie-server">Hoodie</a>, <a href="https://github.com/nickel-org/nickel.rs">Nickel</a>, <a href="https://github.com/kbknapp/clap-rs">Clap.rs</a> and many more. Clog started as a fork of the Node.js based <a href="https://github.com/ajoslin/conventional-changelog">conventional changelog</a> project but has since moved on to follow it’s own ideas.</p>
<p>Let’s build a website that lets you generate a nicely formatted changelog for any public repository on GitHub - right from your browser. Let’s keep that as simple as possible and focus on the important parts.</p>
<ul>
<li>Use Nickel to build a JSON API that can be consumed from a frontend</li>
<li>Make Nickel serve an Angular application as static html so that frontend and backend are nicely decoupled.</li>
<li>Deploy the app to Heroku</li>
</ul>
<h2>Bootstrapping our Nickel application</h2>
<p>This article assumes a basic understanding of Rust. If you’ve never built anything with Rust before, the <a href="https://doc.rust-lang.org/stable/book/getting-started.html">Getting Started</a> section of the official Rust book should answer all basic questions.</p>
<p>The easiest way to bootstrap a Rust project is through Cargo: Rust’s official package manager.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">cargo new clog-website --bin</code></pre></div>
<p>This will create a new directory <code class="language-text">clog-website</code> with a ready to go “Hello World” app. We can compile and run the application with the following command.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">cargo run</code></pre></div>
<p>In order to use Nickel we first need to add it as a dependency to our <code class="language-text">Cargo.toml</code> file. At this point the <code class="language-text">Cargo.toml</code> should look like this.</p>
<div class="gatsby-highlight" data-language="toml"><pre class="language-toml"><code class="language-toml"><span class="token punctuation">[</span><span class="token table class-name">package</span><span class="token punctuation">]</span>
<span class="token key property">name</span> <span class="token punctuation">=</span> <span class="token string">"clog-website"</span>
<span class="token key property">version</span> <span class="token punctuation">=</span> <span class="token string">"0.1.0"</span>
<span class="token key property">authors</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">"Your Name &lt;your@name.com>"</span><span class="token punctuation">]</span>

<span class="token punctuation">[</span><span class="token table class-name">dependencies</span><span class="token punctuation">]</span>
<span class="token key property">nickel</span> <span class="token punctuation">=</span> <span class="token string">"*"</span></code></pre></div>
<p>Now that we added Nickel as a dependency, let’s try to make our server return a simple “Hello World” for any request. Replace the code in the <code class="language-text">main.rs</code> file with the following.</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[macro_use]</span>
<span class="token keyword">extern</span> <span class="token keyword">crate</span> nickel<span class="token punctuation">;</span>

<span class="token keyword">use</span> nickel<span class="token punctuation">::</span>Nickel<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> server <span class="token operator">=</span> Nickel<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    server<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"**"</span><span class="token punctuation">,</span> <span class="token function">middleware!</span><span class="token punctuation">(</span><span class="token string">"Hello from Nickel"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1:6767"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>However, when we try to execute our little app with the <code class="language-text">cargo run</code> command we run into an error.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">$ cargo run
   Compiling clog-website v0.1.0 (file:///Users/cburgdorf/Documents/hacking/clog-website)
src/main.rs:9:12: 9:55 error: no method named `get` found for type `nickel::nickel::Nickel` in the current scope
src/main.rs:9     server.get(&quot;**&quot;, middleware!(&quot;Hello from Nickel&quot;));
                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
src/main.rs:9:12: 9:55 help: items from traits can only be used if the trait is in scope; the following trait is implemented but not in scope, perhaps add a `use` for it:
src/main.rs:9:12: 9:55 help: candidate #1: use `nickel::router::http_router::HttpRouter`</code></pre></div>
<p>The reason for that is quite simple. Even though the HTTP Verb handler registration methods such as <code class="language-text">get</code>, <code class="language-text">put</code>, <code class="language-text">post</code> and <code class="language-text">delete</code> appear to exist directly on the <a href="http://docs.nickel.rs/nickel/struct.Nickel.html"><code class="language-text">Nickel</code> object</a> that is returned by <code class="language-text">Nickel::new()</code>, they are in fact methods from the <a href="http://docs.nickel.rs/nickel/router/http_router/trait.HttpRouter.html#method.get"><code class="language-text">HttpRouter</code> trait</a> which just happens to be <a href="https://github.com/nickel-org/nickel.rs/blob/6fbfbfde2985c5724942835fec95953a3a996b65/src/nickel.rs#L17-L23">implemented</a> for the Nickel facade object.</p>
<p>Traits are an extremely powerful concept of the Rust language but it’s out of the scope of this article to explain them in detail. If you haven’t fully groked them yet, I recommend to head over to the <a href="https://doc.rust-lang.org/stable/book/traits.html">trait chapter</a> of the official Rust book.</p>
<p>Luckily Rust’s compiler is smart enough to give us the right hint here. We need to bring the <code class="language-text">HttpRouter</code> trait into scope. Since Nickel exposes that trait on it’s top level module we can simply change our import to this.</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token keyword">use</span> nickel<span class="token punctuation">::</span><span class="token punctuation">{</span> Nickel<span class="token punctuation">,</span> HttpRouter <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>Once we have brought the trait into scope, the methods become available on the Nickel facade object. You may think of them as extension methods.</p>
<p>Great, after we fixed that issue we can run our server with <code class="language-text">cargo run</code> and point our browser to <code class="language-text">http://127.0.0.1:6767</code> to finally see the text <code class="language-text">Hello from Nickel</code>. That wasn’t too hairy, was it?</p>
<h2>Generating a changelog</h2>
<p>In order to generate our first changelog we need to do three things.</p>
<ul>
<li>Clone the repository that we want to generate the changelog from</li>
<li>Generate the changelog with Clog</li>
<li>Delete the repository to clean up the file system of the server</li>
</ul>
<p>In order to achieve the downloading part, create a file called <code class="language-text">git.rs</code> with the following contents.</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>process<span class="token punctuation">::</span>Command<span class="token punctuation">;</span>
<span class="token keyword">use</span> std<span class="token punctuation">::</span>io<span class="token punctuation">::</span><span class="token punctuation">{</span>Error<span class="token punctuation">,</span> ErrorKind<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">clone</span> <span class="token punctuation">(</span>repo_url<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> into_directory<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Error<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> output <span class="token operator">=</span> <span class="token function">try!</span><span class="token punctuation">(</span>Command<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"git"</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span><span class="token string">"clone"</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>repo_url<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>into_directory<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">match</span> output<span class="token punctuation">.</span>status<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">true</span> <span class="token operator">=></span> <span class="token function">Ok</span><span class="token punctuation">(</span>String<span class="token punctuation">::</span><span class="token function">from_utf8_lossy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>output<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">into_owned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">false</span> <span class="token operator">=></span> <span class="token function">Err</span><span class="token punctuation">(</span>Error<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>ErrorKind<span class="token punctuation">::</span>Other<span class="token punctuation">,</span> <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> String<span class="token punctuation">::</span><span class="token function">from_utf8_lossy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>output<span class="token punctuation">.</span>stderr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>We won’t go through the code line by line. It should be pretty clear to understand just by looking at the method signature. It takes an URI to a Git repository and clones it into whatever path was specified with the second parameter. It returns an <code class="language-text">Result&lt;String, Error&gt;</code> that either carries a <code class="language-text">String</code> with the message that was send to <code class="language-text">stdout</code> or an <code class="language-text">Error</code> that carries a <code class="language-text">String</code> with the message that was send to <code class="language-text">stderr</code>.</p>
<p>Before we are going to use that, let’s move on and write the code that will interact with Clog. We create a file called <code class="language-text">clog_interact.rs</code> with the following contents.</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span><span class="token punctuation">{</span><span class="token keyword">self</span><span class="token punctuation">,</span> File<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> std<span class="token punctuation">::</span>path<span class="token punctuation">::</span>Path<span class="token punctuation">;</span>
<span class="token keyword">use</span> std<span class="token punctuation">::</span>io<span class="token punctuation">::</span><span class="token punctuation">{</span>Read<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> clog<span class="token punctuation">::</span>Clog<span class="token punctuation">;</span>

<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">generate_changelog</span> <span class="token punctuation">(</span>repository<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> repo_url<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> clog <span class="token operator">=</span> Clog<span class="token punctuation">::</span><span class="token function">with_dir</span><span class="token punctuation">(</span>repository<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_or_else</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token punctuation">|</span>e<span class="token punctuation">|</span></span> <span class="token punctuation">{</span>
        fs<span class="token punctuation">::</span><span class="token function">remove_dir_all</span><span class="token punctuation">(</span>repository<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">"Failed to clone repository: {}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> changelog_file_name <span class="token operator">=</span> <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"changelog_{}.md"</span><span class="token punctuation">,</span> repository<span class="token punctuation">)</span><span class="token punctuation">;</span>
    clog<span class="token punctuation">.</span><span class="token function">repository</span><span class="token punctuation">(</span>repo_url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    clog<span class="token punctuation">.</span><span class="token function">write_changelog_to</span><span class="token punctuation">(</span>Path<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>repository<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>changelog_file_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> contents <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    File<span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Path<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>repository<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>changelog_file_name<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token operator">|</span><span class="token keyword">mut</span> f<span class="token operator">|</span> f<span class="token punctuation">.</span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> contents<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    fs<span class="token punctuation">::</span><span class="token function">remove_dir_all</span><span class="token punctuation">(</span>repository<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    contents
<span class="token punctuation">}</span></code></pre></div>
<p>This method takes a <code class="language-text">&amp;str</code> parameter carrying the path to a local git repository and the GitHub url of that repository. Clog needs to know the GitHub url in order to generate links to issues. The method returns a <code class="language-text">String</code> carrying the generated markdown changelog. The method also takes care of deleting the repository as soon as the changelog was generated.</p>
<p>We now have the basic building blocks to generate our first changelog. Let’s move on and do exactly that! We change the <code class="language-text">main.rs</code> file to look like this.</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[macro_use]</span>
<span class="token keyword">extern</span> <span class="token keyword">crate</span> nickel<span class="token punctuation">;</span>
<span class="token keyword">extern</span> <span class="token keyword">crate</span> clog<span class="token punctuation">;</span>

<span class="token keyword">use</span> nickel<span class="token punctuation">::</span><span class="token punctuation">{</span> Nickel<span class="token punctuation">,</span> HttpRouter <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">mod</span> git<span class="token punctuation">;</span>
<span class="token keyword">mod</span> clog_interop<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> server <span class="token operator">=</span> Nickel<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> repo_name <span class="token operator">=</span> <span class="token string">"some-unique-id"</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> repo_uri <span class="token operator">=</span> <span class="token string">"https://github.com/angular/angular"</span><span class="token punctuation">;</span>

    git<span class="token punctuation">::</span><span class="token function">clone</span><span class="token punctuation">(</span>repo_uri<span class="token punctuation">,</span> repo_name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> changelog <span class="token operator">=</span> clog_interop<span class="token punctuation">::</span><span class="token function">generate_changelog</span><span class="token punctuation">(</span>repo_name<span class="token punctuation">,</span> repo_uri<span class="token punctuation">)</span><span class="token punctuation">;</span>

    server<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"**"</span><span class="token punctuation">,</span> <span class="token function">middleware!</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>changelog <span class="token keyword">as</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1:6767"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Let’s shed some light on the code. In order to use Clog we first need to add it to our <code class="language-text">Cargo.toml</code> file as we did before with Nickel. Then add an <code class="language-text">extern crate clog;</code> statement. We also need to add <code class="language-text">mod git;</code> and <code class="language-text">mod clog_interop;</code> in order to have the compiler include those modules. Otherwise it would be just two Rust files that happen to be placed in our project directory.</p>
<p>The rest should be pretty straight forward. We hardcoded the <code class="language-text">repo_uri</code> to fetch the <a href="github.com/angular/angular">Angular</a> repository and clone it into a local folder called <code class="language-text">some-unique-id</code>. We probably have some work here down the road to get that production ready.</p>
<p>The most interesting part is the <code class="language-text">&amp;changelog as &amp;str</code> for the <code class="language-text">middleware!</code> macro to return on every request.</p>
<p>This is a common source of confusion for newcomers but Ryman from the Nickel team did a great job to explain it <a href="https://github.com/nickel-org/nickel.rs/issues/241#issuecomment-122476624">here</a>.</p>
<p>The gist is that the handler gets called again and again for every request hence you can’t <em>move</em> the <code class="language-text">String</code> since it could only be moved once.</p>
<p>If we start our server again with <code class="language-text">cargo run</code> and open up the website in the browser we should see something like this.</p>
<p><img src="/assets/raw_clog_output.png" alt="Raw Clog Output"></p>
<p>Hooray! That’s a markdown formatted changelog of the Angular project.</p>
<h2>Working with JSON data</h2>
<p>We now have our server to clone a repository, generate a markdown changelog and return it to the browser as is. That’s all nice so far. In order to create something slightly nicer and more flexible we need to build a proper JSON API that can be consumed from a frontend.</p>
<p>Let’s sketch out what the JSON request and response objects may look like.</p>
<p><strong>Request Object</strong></p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"respository"</span><span class="token operator">:</span> <span class="token string">"https://github.com/angular/angular"</span>
<span class="token punctuation">}</span></code></pre></div>
<p>We don’t need anything apart from the <code class="language-text">repository</code> itself so far. However, we may add things like <code class="language-text">version_name</code> or <code class="language-text">subtitle</code> later on to expose other Clog features to the frontend.</p>
<p><strong>Response Object</strong></p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"changelog"</span><span class="token operator">:</span> <span class="token string">"the formatted markdown string"</span><span class="token punctuation">,</span>
    <span class="token property">"error"</span><span class="token operator">:</span> <span class="token string">"foo"</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Let’s keep the response simple as well. There is nothing much we need apart from the changelog itself and an optional error message in case something didn’t play out well.</p>
<p>In order to accept and return such JSON objects we first need to create new structs. Let’s call them <code class="language-text">ClogConfig</code> and <code class="language-text">ClogResult</code> and create the files <code class="language-text">clog_config.rs</code> and <code class="language-text">clog_result.rs</code> respectively.</p>
<p><strong>clog_config.rs</strong></p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(RustcDecodable, RustcEncodable)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> ClogConfig <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> repository<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></div>
<p><strong>clog_result.rs</strong></p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(RustcDecodable, RustcEncodable)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> ClogResult <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> changelog<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">pub</span> error<span class="token punctuation">:</span> String
<span class="token punctuation">}</span></code></pre></div>
<p>In order to avoid manual JSON parsing and formatting code we can have Rust automatically implement the <code class="language-text">RustcDecodable</code> and <code class="language-text">RustcEncodable</code> traits for us.</p>
<p>With those two structs in place let’s write a <code class="language-text">POST</code> handler function that can accept and return those JSON structures.</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust">server<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"/generate"</span><span class="token punctuation">,</span> <span class="token macro-rules function">middleware!</span> <span class="token punctuation">{</span> <span class="token operator">|</span>request<span class="token punctuation">,</span> response<span class="token operator">|</span>

    <span class="token keyword">let</span> clog_config <span class="token operator">=</span> request<span class="token punctuation">.</span>json_as<span class="token punctuation">::</span><span class="token operator">&lt;</span>ClogConfig<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token function">Err</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=</span> git<span class="token punctuation">::</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>clog_config<span class="token punctuation">.</span>repository<span class="token punctuation">,</span> <span class="token operator">&amp;</span>repo_name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ClogResult <span class="token punctuation">{</span>
            changelog<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">.</span><span class="token function">to_owned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            error<span class="token punctuation">:</span> err<span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_owned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> changelog <span class="token operator">=</span> clog_interop<span class="token punctuation">::</span><span class="token function">generate_changelog</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>repo_name<span class="token punctuation">,</span> <span class="token operator">&amp;</span>clog_config<span class="token punctuation">.</span>repository<span class="token punctuation">)</span><span class="token punctuation">;</span>

        ClogResult <span class="token punctuation">{</span>
            changelog<span class="token punctuation">:</span> changelog<span class="token punctuation">,</span>
            error<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">.</span><span class="token function">to_owned</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    json<span class="token punctuation">::</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Let’s take a closer look at the code. First, we use <code class="language-text">server.post</code> to register a handler that answers <code class="language-text">POST</code> requests to the <code class="language-text">/generate</code> endpoint. The <code class="language-text">middleware</code> macro that we previoulsy used with a simple string is now being used in it’s block syntax form and also gives us access to the <code class="language-text">request</code> and <code class="language-text">response</code> objects that we’ll need to cover all aspects of the handler.</p>
<p>Nickel supports parsing JSON bodies out of the box with it’s <code class="language-text">json_as</code> method. The catch is that - just as before with the <code class="language-text">HttpRouter</code> - we need to bring a special trait into scope to use that functionality. But let’s not get distracted by that for now, we’ll take a look at all the needed imports in a moment.</p>
<p>After we’ve parsed the JSON into our <code class="language-text">clog_config</code> variable which now holds an instance of a <code class="language-text">ClogConfig</code>, we can move on and try to clone the given repository. Now that we don’t hardcode the repository anymore we need to plan for typos or other reasons why cloning of a repository may fail. If cloning fails, we simply set <code class="language-text">changelog</code> to an empty string and <code class="language-text">error</code> to whatever error message was returned.</p>
<p>Otherwise we generate the changelog as before and set <code class="language-text">changelog</code> and <code class="language-text">error</code> accordingly. Notice that in Rust even if/else constructs work expression-based so that we can write the code in a way that is more concise and puts the <code class="language-text">let result =</code> right before the <code class="language-text">if</code>.</p>
<p>Last but not least we need to use <code class="language-text">json::encode</code> to transform our <code class="language-text">ClogResult</code> into it’s JSON representation before we return it to the caller.</p>
<p>That was a bunch of new code and it actually leaves out an important part: we had to adjust our imports and even the <code class="language-text">Cargo.toml</code> to adjust for new dependencies.</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[macro_use]</span>
<span class="token keyword">extern</span> <span class="token keyword">crate</span> nickel<span class="token punctuation">;</span>
<span class="token keyword">extern</span> <span class="token keyword">crate</span> clog<span class="token punctuation">;</span>
<span class="token keyword">extern</span> <span class="token keyword">crate</span> rustc_serialize<span class="token punctuation">;</span>

<span class="token keyword">use</span> nickel<span class="token punctuation">::</span><span class="token punctuation">{</span> Nickel<span class="token punctuation">,</span> JsonBody<span class="token punctuation">,</span> HttpRouter <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> clog_config<span class="token punctuation">::</span>ClogConfig<span class="token punctuation">;</span>
<span class="token keyword">use</span> clog_result<span class="token punctuation">::</span>ClogResult<span class="token punctuation">;</span>
<span class="token keyword">use</span> rustc_serialize<span class="token punctuation">::</span>json<span class="token punctuation">;</span>
<span class="token keyword">use</span> std<span class="token punctuation">::</span>error<span class="token punctuation">::</span>Error<span class="token punctuation">;</span>

<span class="token keyword">mod</span> git<span class="token punctuation">;</span>
<span class="token keyword">mod</span> clog_interop<span class="token punctuation">;</span>
<span class="token keyword">mod</span> clog_config<span class="token punctuation">;</span>
<span class="token keyword">mod</span> clog_result<span class="token punctuation">;</span> </code></pre></div>
<p>The biggest suprise here may be that JSON support is currently not baked into the standard library but instead needs to be pulled in via the <code class="language-text">rustc-serialize</code> crate. Another catch here is that in the <code class="language-text">Cargo.toml</code> one has to add the crate as <code class="language-text">rustc-serialize = &quot;*&quot;</code> (hyphenated) whereas in Rust code underscores are being used.</p>
<p>Great! We are almost there. We can already use <code class="language-text">curl</code> to try out our API.</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust">curl <span class="token lifetime-annotation symbol">'http://127.0.0.1:6767/generate</span>' <span class="token operator">-</span>H <span class="token lifetime-annotation symbol">'Cache-Control:</span> no<span class="token operator">-</span>cache' <span class="token operator">-</span>H <span class="token lifetime-annotation symbol">'Content-Type:</span> application<span class="token operator">/</span>json<span class="token punctuation">;</span>charset<span class="token operator">=</span>UTF<span class="token operator">-</span><span class="token number">8</span>' <span class="token operator">-</span><span class="token operator">-</span>data<span class="token operator">-</span>binary $<span class="token lifetime-annotation symbol">'{\n</span>  <span class="token string">"repository"</span><span class="token punctuation">:</span> <span class="token string">"https://github.com/thoughtram/clog"</span>\n<span class="token punctuation">}</span>' <span class="token operator">-</span><span class="token operator">-</span>compressed</code></pre></div>
<p>There’s still one big flaw though. We are still cloning into a directory called <code class="language-text">some-unique-id</code>. For every request. This will break apart as soon as we have two simultanous requests to our API. Let’s change the code to actually use real unique names for the directories that we clone into. And again, there’s a crate for that. It’s name is <code class="language-text">uuid</code>.</p>
<p>With that crate in place, the fix is as easy as setting <code class="language-text">repo_name</code> from <em>inside</em> of our handler to a unique string. </p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">let repo_name = Uuid::new_v4().to_string();</code></pre></div>
<p>We’ll leave out the changes to the imports this time. If you have trouble figuring them out, feel free to jump to the final solution.</p>
<p>With this change in place our API is pretty much ready to use. We can improve ergonomics a little further with a parser for the repository name so that one doesn’t have to type out the entire URL of the repo. This will be in the <a href="https://github.com/thoughtram/demo-clog-website/blob/78121ab93f541700d01406be40d092e8925d739d/src/main.rs">final solution</a> but I’m not going to cover it here, it’s a very simple step after all.</p>
<h2>Serving a frontend</h2>
<p>Now that we have our API in place, we just need a simple frontend to serve as a basic use case. If we would aim for a proper scalable solution, we’d most likely not serve the frontend from the same server that serves the API. For the purpose of this blog post and to show off Nickels features, we will just keep the entire project together.</p>
<p>We won’t cover the frontend part in the same depth as we did for the backend. You can simply jump to the <a href="https://github.com/thoughtram/demo-clog-website">repository</a> on GitHub that contains the entire code that was written for this post.</p>
<p>Let’s just assume that we are building a simple web app with a text input for the user to enter the URL to a repository on GitHub and a button to request the changelog from the API that we built.</p>
<p>In order to serve the frontend we will just create a directory called <code class="language-text">assets</code> with subdirectories for <code class="language-text">css</code>, <code class="language-text">js</code> and <code class="language-text">templates</code>. We will place an <code class="language-text">index.html</code> in the templates folder and have that one include JavaScript and CSS files from the <code class="language-text">js</code> and <code class="language-text">css</code> directories respectively.</p>
<p>In order to serve the frontend we have to tell Nickel to just statically server those files.</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust">server<span class="token punctuation">.</span><span class="token function">utilize</span><span class="token punctuation">(</span>StaticFilesHandler<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"assets"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">utilize</span><span class="token punctuation">(</span>StaticFilesHandler<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"assets/templates"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>We will create two individual mounts for <code class="language-text">assets</code> and <code class="language-text">assets/templates</code> so that we have the <code class="language-text">index.html</code> exposed on the root level but the JavaScript and CSS exposed through it’s subfolders.</p>
<p><img src="../assets/images/clog_final_site.png" alt="Rendered Clog Site"></p>
<p>Voilà! We have a real working website.</p>
<h2>Deploying our application to Heroku</h2>
<p>Now that we have our app running just fine on our development machine wouldn’t it be nice to actually ship it for the world to see? Let’s do exactly that and host it on Heroku. Hosting a Nickel app on Heroku is quite easy these days. If you’ve never worked with Heroku before, you first need to register at their website and download the <a href="https://toolbelt.heroku.com/">Heroku CLI tool</a> that we will use for the next steps.</p>
<p>Once you have the Heroku CLI installed and logged in, you can simply create the app endpoint from your existing repository through the following command.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">heroku create demo-clog-website --buildpack https://github.com/emk/heroku-buildpack-rust.gi</code></pre></div>
<p>Notice that the first parameter of the <code class="language-text">heroku create</code> command will be the name that Heroku will use as a subdomain to serve your site. So in this case it’s <code class="language-text">http://demo-clog-website.herokuapp.com</code>.</p>
<p>This will also add a new Git remote called <code class="language-text">heroku</code> to your repository. Deploying the site is as simple as running <code class="language-text">git push heroku master</code>.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">$ git push heroku master
Counting objects: 28, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (24/24), done.
Writing objects: 100% (28/28), 5.73 KiB | 0 bytes/s, done.
Total 28 (delta 5), reused 0 (delta 0)
remote: Compressing source files... done.
remote: Building source:
remote: 
remote: -----&gt; Fetching custom git buildpack... done
remote: 
remote:  !     Push rejected, no Cedar-supported app detected
remote: HINT: This occurs when Heroku cannot detect the buildpack
remote:       to use for this application automatically.
remote: See https://devcenter.heroku.com/articles/buildpacks
remote: 
remote: Verifying deploy....
remote: 
remote: !   Push rejected to demo-clog-website.
remote: 
To https://git.heroku.com/demo-clog-website.git
 ! [remote rejected] master -&gt; master (pre-receive hook declined)
error: failed to push some refs to &#39;https://git.heroku.com/demo-clog-website.git&#39;</code></pre></div>
<p>Awww snap! We seem to be missing something as Heroku rejected to build the app. Heroku is capable of hosting apps with all kind of different tech stacks. The way that works is through special buildpacks that configure the server. When we created our app we set the buildpack to an unofficial (yet, usuable!) buildpack for Rust. But we are still missing two important files to give Heroku the right hints how to treat our program.</p>
<p><strong>RustConfig</strong></p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">VERSION=&quot;1.1.0&quot;</code></pre></div>
<p>The <code class="language-text">RustConfig</code> file tells our buildpack which version of the Rust compiler we want to build our app against.</p>
<p><strong>Procfile</strong></p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">web: ./target/release/clog-website</code></pre></div>
<p>The <code class="language-text">Procfile</code> tells Heroku which command to invoke to start the process. Since <code class="language-text">Cargo</code> puts the executable at <code class="language-text">target/release/our-app-name</code> we have to set this up accordingly.</p>
<p>After we created and committed both files to our repository we deploy our site again with <code class="language-text">git push heroku master</code>. The deployment should run just fine so let’s check the live site.</p>
<p><img src="../assets/images/heroku_application_error.png" alt="Heroku Application Error"></p>
<p>The live site just yields a generic Heroku error page, so let’s dig into the output of the <code class="language-text">heroku logs</code> command.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">heroku[web.1]: Starting process with command `./target/release/clog-website`
app[web.1]: Listening on http://127.0.0.1:6767
app[web.1]: Ctrl-C to shutdown server
heroku[web.1]: Error R10 (Boot timeout) -&gt; Web process failed to bind to $PORT within 60 seconds of launch
heroku[web.1]: Stopping process with SIGKILL
heroku[web.1]: State changed from starting to crashed
heroku[web.1]: State changed from crashed to starting
heroku[web.1]: Process exited with status 137</code></pre></div>
<p>From the logs we can clearly see that the server started successfuly but was shut down after a 60 seconds timeout because it failed to bind to <code class="language-text">$PORT</code>.</p>
<p>Heroku expects us to bind to a random port number that they assign to the <code class="language-text">PORT</code> environment variable. However our server code is currently hardcoded to use port <code class="language-text">6767</code>.</p>
<p>We can fix that quite easily by reading from the <code class="language-text">PORT</code> enviroment variable and defaulting to <code class="language-text">6767</code> if it doesn’t exist.</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">get_server_port</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> u16 <span class="token punctuation">{</span>
    env<span class="token punctuation">::</span><span class="token function">var</span><span class="token punctuation">(</span><span class="token string">"PORT"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_or</span><span class="token punctuation">(</span><span class="token string">"6767"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> <span class="token function">get_server_port</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>After we fixed that issue our live site runs just fine!</p>
<p><img src="../assets/images/final_hosted_clog_site.png" alt="Running Live Site"></p>
<p>You may just head over to <a href="http://demo-clog-website.herokuapp.com">demo-clog-website.herokuapp.com</a> and give it a try. It also contains the mentioned URL parser improvement so that one can enter repositories in the form of <code class="language-text">user/repo</code>. You can find the entire code of this demo project <a href="https://github.com/thoughtram/demo-clog-website">here on Github</a>.</p>
<p>Now, wouldn’t that be a nice start for your first Nickel project?</p></div></section><section class="thtrm-section--centered thtrm-section-constrained u-flex--justify-center" style="box-shadow:0px 2px 9px 2px rgba(0,0,0, 0.1);padding:2em;margin-top:-2em"><h1 class="thtrm-section__heading--small">Liked this Rust article?</h1><form id="signup-form" method="post" class="thtrm-form u-distance-small" action="https://gmail.us3.list-manage.com/subscribe/post?u=06cf39a53e3ac1a4db816a8f1&amp;id=08cf21d77b" novalidate="" target="_blank"><p class="thtrm-section__paragraph thtrm-section__paragraph--small" style="line-height:1.4em;font-size:0.7em;margin-top:-1em">I started learning Rust out of curiosity with zero experience in systems programming. I know the pain. <span style="font-weight:600">Learning Rust doesn&#x27;t have to be hard</span>. If you liked the article, sign up here and I&#x27;ll inform you about new Rust content. ✌🏼</p><div class="thtrm-form__row thtrm-form__column-group u-distance"><input type="text" nane="FNAME" id="mce-FNAME" class="thtrm-form__input--text" placeholder="Your firstname"/><input type="email" name="EMAIL" id="mce-EMAIL" class="thtrm-form__input--text" placeholder="Your email"/></div><div class="thtrm-form__row"><button type="submit" class="thtrm-button">Help me learn Rust!</button></div></form></section><section class="thtrm-section"><div class="thtrm-section__heading thtrm-article-header thtrm-section-constrained u-distance-reset"><div class="thtrm-metabar thtrm-article-header__metabar"><div class="thtrm-metabar__item thtrm-topic u-color--grey"><div class="thtrm-media-short">Written by  <img alt="Author" src="https://avatars0.githubusercontent.com/u/521109?s=460&amp;v=4" class="thtrm-avatar"/><p class="thtrm-media-short__body"><a href="https://twitter.com/cburgdorf" class="u-link-plain">Christoph Burgdorf</a></p></div></div></div></div></section></main><footer class="thtrm-footer" role="contentinfo"><div class="thtrm-copyright"><p>© <!-- -->2024<!-- --> The thoughtram Blog Maintainers</p></div></footer><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" hidden=""><symbol viewBox="0 0 24 24" id="icon--chevron-right"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path><path d="M0 0h24v24H0z" fill="none"></path></symbol><symbol viewBox="0 0 24 24" id="icon--chevron-down"><path d="M7.41 7.84L12 12.42l4.59-4.58L18 9.25l-6 6-6-6z"></path><path d="M0-.75h24v24H0z" fill="none"></path></symbol><symbol viewBox="0 0 24 24" id="icon--menu"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path><path d="M0 0h24v24H0z" fill="none"></path></symbol></svg></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-51360648-2', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/rust/2015/07/29/a-web-app-with-nickel-from-first-line-to-heroku-deployment.html";window.webpackCompilationHash="0c5d630095500f933ccd";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-db11fdec89ef44788bcc.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-6a14d6c49d22aa388ff9.js"],"component---src-templates-category-js":["/component---src-templates-category-js-4376524bed80ab31f5c7.js"],"component---src-pages-404-js":["/component---src-pages-404-js-6a74e57e5569370f5224.js"],"component---src-pages-all-js":["/component---src-pages-all-js-7aa251af6b402c5bb6a7.js"],"component---src-pages-confirmation-thank-you-js":["/component---src-pages-confirmation-thank-you-js-e20b16d362e2acd832ef.js"],"component---src-pages-finish-newsletter-subscription-js":["/component---src-pages-finish-newsletter-subscription-js-9bc9dd352c7e25398f2b.js"],"component---src-pages-index-js":["/component---src-pages-index-js-34313bc70d6e2470e416.js"]};/*]]>*/</script><script src="/webpack-runtime-c99afa6b532686815600.js" async=""></script><script src="/app-db11fdec89ef44788bcc.js" async=""></script><script src="/commons-9a6c7e4a80f98fe6d0b9.js" async=""></script><script src="/styles-e0e38ca7b54561c3f057.js" async=""></script><script src="/component---src-templates-blog-post-js-6a14d6c49d22aa388ff9.js" async=""></script></body></html>