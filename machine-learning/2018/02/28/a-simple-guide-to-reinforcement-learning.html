<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/commons.743a077edf8bbf03e9ea.css">/*! normalize.css v7.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}[hidden],template{display:none}:root{--thtrm-color-darkblue:#456474;--thtrm-color-midblue:#4c91a7;--thtrm-color-blue:#69caff;--thtrm-color-lighterblue:#dbe8ec;--thtrm-color-teal:#42899b;--thtrm-color-lightblue:#72c7df;--thtrm-color-text:#000;--thtrm-color-lighttext:#7d7d7d;--thtrm-color-gray:#eee;--thtrm-color-lightgray:#f8f8f9;--thtrm-color-ultralightgray:#fbfbfb;--thtrm-color-white:#fff;--thtrm-rustforjs-yellow:#ffd45e;--thtrm-amc-red:#dd0031;--thtrm-git-orange:#de4c36;--thtrm-rxjs-pink:#b7178c;--thtrm-border-color:var(--thtrm-color-gray);--thtrm-base-font:Roboto;--thtrm-base-font-stack:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";--thtrm-base-fontweight:500;--thtrm-base-fontsize:19px;--thtrm-small-fontsize:calc(0.85*var(--thtrm-base-fontsize));--thtrm-nav-fontsize:calc(1*var(--thtrm-base-fontsize));--thtrm-h1-fontszize:calc(1.75*var(--thtrm-base-fontsize));--thtrm-h2-fontszize:calc(1.5*var(--thtrm-base-fontsize));--thtrm-h3-fontszize:calc(1.3*var(--thtrm-base-fontsize));--thtrm-h4-fontszize:calc(1.1*var(--thtrm-base-fontsize));--thtrm-page-margin:5vw;--thtrm-page-neg-margin:-5vw;--thtrm-layer-submarine:-1;--thtrm-layer-deco:9;--thtrm-layer-navigation:99;--thtrm-layer-surface:99999999999}@font-face{font-family:Roboto;font-style:normal;font-weight:300;src:local("Roboto"),local("Roboto")}@font-face{font-family:Roboto;font-weight:500;src:local("Roboto Medium"),local("Roboto Medium")}@font-face{font-family:Roboto;font-style:italic;font-weight:500;src:local("Roboto Medium Italic"),local("Roboto-MediumItalic")}*,:after,:before{box-sizing:border-box;margin:0;padding:0}html{font-family:var(--thtrm-base-font),var(--thtrm-base-font-stack);font-size:var(--thtrm-base-fontsize);font-weight:var(--thtrm-base-fontweight);line-height:1.45;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body{position:relative}h1,h2,h3,h4{font-weight:var(--thtrm-bold-fontweight);line-height:1.2;letter-spacing:0;margin:0}h1{font-size:var(--thtrm-h1-fontszize)}a{color:var(--thtrm-color-midblue);text-decoration:none}.thtrm-page--yellow a{color:#000}a:after{color:currentColor;content:"\203A";font-weight:400;font-size:1.15em;margin-left:.25em}a[title=Home]:after{display:none}img{width:100%;height:auto}@media screen and (min-width:80em){:root{--thtrm-base-fontsize:25px;--thtrm-small-fontsize:calc(0.75*var(--thtrm-base-fontsize));--thtrm-nav-fontsize:calc(1*var(--thtrm-base-fontsize));--thtrm-h1-fontszize:calc(2.25*var(--thtrm-base-fontsize));--thtrm-h2-fontszize:calc(2*var(--thtrm-base-fontsize));--thtrm-page-margin:10vw;--thtrm-page-neg-margin:-10vw}}@media screen and (min-width:120em){:root{--thtrm-base-fontsize:27px}}.thtrm-page{padding-left:5vw;padding-right:5vw;overflow-x:hidden}.thtrm-page.thtrm-page--yellow{background-color:var(--thtrm-rustforjs-yellow)}.thtrm-banner{display:flex;align-items:center;justify-content:space-between;height:90px}@media screen and (min-width:80em){.thtrm-page{padding-left:10vw;padding-right:10vw}.thtrm-banner{height:160px}}@media screen and (min-width:120em){.thtrm-page{padding-left:10vw;padding-right:10vw}.thtrm-banner{height:260px}}@supports (display:grid){.thtrm-page{display:grid;grid-template-columns:[pad-left] 5vw [center] 90vw [pad-left] 5vw;grid-template-rows:[banner] 90px [main] auto [aside] auto [footer] auto;padding-left:0;padding-right:0}@media screen and (min-width:80em){.thtrm-page{grid-template-columns:[pad-left] 10vw [center] 80vw [pad-left] 10vw;grid-template-rows:[banner] 160px [main] auto [aside] auto [footer] auto}}@media screen and (min-width:120em){.thtrm-page{grid-template-columns:[pad-left] 10vw [center] 80vw [pad-left] 10vw;grid-template-rows:[banner] 260px [main] auto [aside] auto [footer] auto}}.thtrm-banner{height:auto;grid-row-start:1;grid-row-end:1}.thtrm-banner,.thtrm-main{grid-column-start:2;grid-column-end:2}.thtrm-main{grid-row-start:2;grid-row-end:2}.thtrm-aside{grid-row-start:3;grid-row-end:3}.thtrm-aside,.thtrm-footer{grid-column-start:2;grid-column-end:2}.thtrm-footer{grid-row-start:4;grid-row-end:4}}.thtrm-banner{position:relative}.thtrm-footer{border-top:5px solid var(--thtrm-color-text);font-size:var(--thtrm-small-fontsize);padding:2rem 0;margin-top:2rem}.thtrm-footer .thtrm-sitemap{margin-bottom:2rem}.thtrm-footer .thtrm-sitemap__heading{font-size:var(--thtrm-base-fontsize);margin-top:1rem;margin-bottom:.5rem}.thtrm-footer .thtrm-copyright{display:flex;align-items:center;justify-content:space-between}.thtrm-footer .thtrm-sitemap nav ul{list-style:none}.thtrm-footer .thtrm-sitemap nav li a{text-decoration:none}.thtrm-footer .thtrm-sitemap nav li a:after{color:currentColor;content:"\203A";font-weight:400;font-size:1.15em;margin-left:.25em}@media screen and (min-width:31.5em){.thtrm-footer .thtrm-sitemap{display:grid;grid-template-columns:33.33333333333% 33.33333333333% 33.33333333333%;margin-bottom:2rem}.thtrm-footer .thtrm-sitemap__item{-ms-grid-column-span:1}.thtrm-footer .thtrm-sitemap__item:first-of-type{-ms-grid-column:1}.thtrm-footer .thtrm-sitemap__item:nth-of-type(2){-ms-grid-column:2}.thtrm-footer .thtrm-sitemap__item:nth-of-type(3){-ms-grid-column:3}.thtrm-footer .thtrm-sitemap__heading{margin-top:0;margin-bottom:1rem}}.thtrm-box{background-color:var(--thtrm-color-midblue);color:var(--thtrm-color-white);font-size:var(--thtrm-small-fontsize);padding:1.5rem;width:100%}.thtrm-box--light{background-color:var(--thtrm-color-lightblue)}.thtrm-box--red{background-color:var(--thtrm-amc-red)}.thtrm-box--red,.thtrm-box--white{box-shadow:0 2px 24px 0 rgba(0,0,0,.04)}.thtrm-box--white{background-color:var(--thtrm-color-white);color:var(--thtrm-color-text)}.thtrm-box--dark{background-color:var(--thtrm-color-darkblue)}.thtrm-box--mid{background-color:var(--thtrm-color-teal)}.thtrm-box>.thtrm-box__heading{margin-bottom:1rem}.thtrm-box--offset-left,.thtrm-box--offset-right{margin-bottom:.5rem}.thtrm-box>.thtrm-box__more-link{color:var(--thtrm-color-white);display:block;font-size:var(--thtrm-base-fontsize);text-decoration:none;margin-top:1rem}@media screen and (min-width:43.75em){.thtrm-box{padding:2rem}.thtrm-box:not([class*=thtrm-box--offset]){width:auto}.thtrm-box--offset-left,.thtrm-box--offset-right{margin-bottom:1rem;position:absolute;top:2.5rem;width:80%;right:-70%;z-index:var(--thtrm-layer-deco)}.thtrm-box--offset-right{right:-70%}.thtrm-box--offset-left{left:-70%}}.thtrm-button,[class*=thtrm-button],[class^=thtrm-button]{border:none;background-color:var(--thtrm-color-darkblue);color:var(--thtrm-color-white);display:inline-block;font-weight:var(--thtrm-base-fontweight);font-size:inherit;padding:.5rem 1rem;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.thtrm-page--yellow .thtrm-button,.thtrm-page--yellow [class*=thtrm-button],.thtrm-page--yellow [class^=thtrm-button]{background-color:#000}.thtrm-button--bordered{border:4px solid;background-color:transparent}.thtrm-button--ghost{color:inherit;padding:.25rem}.thtrm-button--ghost,.thtrm-page--yellow .thtrm-button--ghost{background-color:transparent}.thtrm-card{background-color:var(--thtrm-color-midblue);color:var(--thtrm-color-white);font-size:var(--thtrm-small-fontsize);padding:1rem;width:100%}.thtrm-card--red{background-color:var(--thtrm-amc-red)}.thtrm-card--black,.thtrm-card--red{box-shadow:0 2px 24px 0 rgba(0,0,0,.04)}.thtrm-card--black{background-color:var(--thtrm-git-orange)}.thtrm-card--pink{background-color:var(--thtrm-rxjs-pink)}.thtrm-card--pink,.thtrm-card--white{box-shadow:0 2px 24px 0 rgba(0,0,0,.04)}.thtrm-card--white{background-color:var(--thtrm-color-white);color:var(--thtrm-color-text)}.thtrm-card>.thtrm-card__heading{margin-bottom:1rem}.thtrm-card__topic{font-size:.625rem;margin-bottom:.5rem;color:var(--thtrm-color-white);text-transform:uppercase;letter-spacing:.02em}.thtrm-card__topic.thtrm-card__topic--red{color:var(--thtrm-amc-red)}.thtrm-card__topic.thtrm-card__topic--pink{color:var(--thtrm-rxjs-pink)}.thtrm-card__topic.thtrm-card__topic--grey{color:var(--thtrm-color-lighttext)}.thtrm-card__topic.thtrm-card__topic--black{color:var(--thtrm-git-orange)}.thtrm-card__list{list-style:none}.thtrm-card__list li{position:relative;padding-left:1rem;margin-top:.5em;line-height:1.2}.thtrm-card__list li:before{content:"\2192   ";margin-left:-1rem;position:absolute}.thtrm-card__paragraph{margin:.5rem 0}.thtrm-card__link{color:inherit}@media screen and (min-width:43.75em){.thtrm-card{padding:1.5rem}}.thtrm-form .thtrm-form__label{display:none}.thtrm-form .thtrm-form__input--text{background-color:var(--thtrm-color-gray);border:none;font-size:inherit;padding:.5rem 1rem;min-width:40%}.thtrm-form__info-text{font-size:.4rem;font-weight:400;max-width:500px;color:#aaa;margin:.4em auto auto}.thtrm-form__info-text a{text-decoration:underline;color:#aaa}.thtrm-form__info-text a:after{display:none}.thtrm-form__row{margin-top:16px}.thtrm-form__column-group{display:grid;grid-column-gap:24px;grid-template-columns:1fr 1fr;grid-template-rows:auto auto}.thtrm-form__column-group label{grid-row:1}.thtrm-form__column-group input{grid-row:2}.thtrm-icon,[class^=thtrm-icon--]{color:inherit;display:inline-block;vertical-align:middle;transition:all .25s linear;height:24px;width:24px}svg.thtrm-icon,svg[class^=thtrm-icon]{fill:currentColor}svg.thtrm-icon path:not([fill=none]),svg.thtrm-icon use,svg[class^=thtrm-icon] path:not([fill=none]),svg[class^=thtrm-icon] use{fill:inherit}.thtrm-image-grid{display:flex;flex-flow:column wrap;align-items:center;justify-content:space-around;z-index:var(--thtrm-layer-submarine);margin-top:-.25rem}.thtrm-image-grid img{text-align:center;-o-object-fit:contain;object-fit:contain;font-family:"object-fit: contain;";width:50%;max-width:200px;max-height:200px}@media screen and (min-width:20em){.thtrm-image-grid{flex-flow:row wrap}}@media screen and (min-width:43.75em){.thtrm-image-grid img{width:25%;max-width:18%;max-height:250px;-o-object-fit:contain;object-fit:contain;font-family:"object-fit: contain;"}}.thtrm-layout{display:grid;grid-gap:1rem;padding:1rem;width:100%}.thtrm-layout.thtrm-layout-fourths,.thtrm-layout.thtrm-layout-halfs,.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr}@media screen and (min-width:43.75em){.thtrm-layout.thtrm-layout-fourths,.thtrm-layout.thtrm-layout-halfs,.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr 1fr}}@media screen and (min-width:50em){.thtrm-layout.thtrm-layout-fourths,.thtrm-layout.thtrm-layout-halfs,.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr 1fr}}@media screen and (min-width:64em){.thtrm-layout.thtrm-layout-halfs,.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr 1fr}.thtrm-layout.thtrm-layout-fourths{grid-template-columns:1fr 1fr 1fr}}@media screen and (min-width:80em){.thtrm-layout{grid-gap:1.5rem;padding:1.5rem}.thtrm-layout.thtrm-layout-halfs{grid-template-columns:1fr 1fr}.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr 1fr 1fr}.thtrm-layout.thtrm-layout-fourths{grid-template-columns:1fr 1fr 1fr 1fr}}@media screen and (min-width:120em){.thtrm-layout{display:grid;grid-gap:1.5rem}.thtrm-layout.thtrm-layout-halfs{grid-template-columns:1fr 1fr}.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr 1fr 1fr}.thtrm-layout.thtrm-layout-fourths{grid-template-columns:1fr 1fr 1fr 1fr 1fr}}.thtrm-logo{max-height:45px;width:160px;margin-top:-1.65rem}@media screen and (min-width:80em){.thtrm-logo{max-height:80px;width:200px;margin-top:-1rem}}@media screen and (min-width:120em){.thtrm-logo{max-height:100px;width:380px}}.thtrm-nav{display:flex;align-items:center;justify-content:space-between;font-size:var(--thtrm-nav-fontsize)}.thtrm-nav .thtrm-nav__list{background-color:var(--thtrm-color-lightgray);box-shadow:0 1px 2px rgba(50,50,50,.1);list-style:none;text-align:left;position:absolute;right:0;top:70%;width:auto;z-index:99;opacity:0;visibility:hidden;transition:.25s;transform:translate3d(0,-10%,0);padding:1rem .5rem}.thtrm-nav .thtrm-nav__list:before{content:"";width:10px;height:10px;border-right:6px solid transparent;border-left:6px solid transparent;border-bottom:6px solid var(--thtrm-color-lightgray);position:absolute;top:-10px;right:10px}.thtrm-nav .thtrm-nav__list li{padding:0 1rem;margin-top:.5rem}.thtrm-nav .thtrm-nav__list a{color:var(--thtrm-color-text);font-weight:var(--thtrm-base-fontweight);text-decoration:none;transition:.25s}.thtrm-nav .thtrm-nav__list a.active{border-bottom:2px solid var(--thtrm-color-text);padding-bottom:.3em}.thtrm-nav .thtrm-nav__list a:hover{color:var(--thtrm-color-blue)}.thtrm-nav .thtrm-nav__list a:after{content:""}.no-js .thtrm-nav .thtrm-nav__button:focus+.thtrm-nav__list,.no-js .thtrm-nav .thtrm-nav__button:hover+.thtrm-nav__list,.no-js .thtrm-nav__list:hover,.thtrm-nav__list.is-visible{opacity:1;pointer-events:all;visibility:visible;transform:translateZ(0)}.thtrm-nav-toc{border-top:3px solid #000;font-size:.75rem}.thtrm-nav-toc li{display:inline-block}.thtrm-nav-toc li:first-child a{padding-left:0}.thtrm-nav-toc li:last-child a{padding-right:0}.thtrm-nav-toc a{color:var(--thtrm-color-text);display:block;padding:.75rem 1rem}.thtrm-nav-toc a.is-active{color:var(--thtrm-color-midblue)}.thtrm-nav-toc a:after{content:""}@media screen and (min-width:50em){.thtrm-nav .thtrm-nav__list li:last-of-type{padding-right:0}.thtrm-nav .thtrm-nav__button,.thtrm-nav .thtrm-nav__list:before{display:none}.thtrm-nav .thtrm-nav__list{background-color:transparent;box-shadow:none;display:flex;flex-flow:row wrap;align-items:center;justify-content:flex-end;opacity:1;pointer-events:all;visibility:visible;transform:translateZ(0);position:static}}[class*=thtrm-ratio--]{position:relative}[class*=thtrm-ratio--]:before{content:"";display:block;width:100%}[class*=thtrm-ratio--]>*{position:absolute;bottom:0;left:0;right:0;top:0}[class*=thtrm-ratio--]>img{height:100%;-o-object-fit:cover;object-fit:cover}.thtrm-ratio--landscape:before{padding-top:75%}.thtrm-ratio--square:before{padding-top:100%}.thtrm-ratio--stripe:before{padding-top:50%}.thtrm-section,[class^=thtrm-section--]{position:relative;margin-bottom:3rem}.thtrm-section .thtrm-section__item,[class^=thtrm-section--] .thtrm-section__item{width:100%}.thtrm-section .thtrm-section__heading,[class^=thtrm-section--] .thtrm-section__heading{width:100%;margin-top:1.5rem;margin-bottom:.75rem}.thtrm-section .thtrm-section__paragraph,[class^=thtrm-section--] .thtrm-section__paragraph{margin-bottom:1rem}.thtrm-section .thtrm-section__paragraph a:after,[class^=thtrm-section--] .thtrm-section__paragraph a:after{display:none}.thtrm-section .thtrm-section__paragraph--small,[class^=thtrm-section--] .thtrm-section__paragraph--small{font-size:.8rem;font-weight:400}.thtrm-section .thtrm-section__link,[class^=thtrm-section--] .thtrm-section__link{display:inline-block;margin-bottom:1rem}.thtrm-section .thtrm-section__link--black,[class^=thtrm-section--] .thtrm-section__link--black{color:#000}.thtrm-section .thtrm-section__link--black .thtrm-section__link,[class^=thtrm-section--] .thtrm-section__link--black .thtrm-section__link{color:var(--thtrm-color-midblue)}.thtrm-section .thtrm-section__link--black .thtrm-section__link:after,[class^=thtrm-section--] .thtrm-section__link--black .thtrm-section__link:after{color:currentColor}.thtrm-section .thtrm-section__heading--unpadded-top,[class^=thtrm-section--] .thtrm-section__heading--unpadded-top{width:100%;margin-top:0;margin-bottom:.75rem}.thtrm-section .thtrm-section__heading--small,[class^=thtrm-section--] .thtrm-section__heading--small{width:100%;margin-bottom:1rem;font-size:1.25rem;line-height:1.3}.thtrm-section--centered{text-align:center}.thtrm-section--unpadded-bottom{margin-bottom:0}.thtrm-section--fullbleed{margin-left:-5vw;margin-right:-5vw;min-height:300px}.thtrm-section--fullbleed-intrinsic{margin-left:-5vw;margin-right:-5vw;margin-top:0}@media screen and (min-width:80em){.thtrm-section--fullbleed-intrinsic{margin-left:-10vw;margin-right:-10vw}}.thtrm-section--privacy-statement li,.thtrm-section--privacy-statement p,.thtrm-section--privacy-statement strong{font-size:.8rem;font-weight:400}.thtrm-section--privacy-statement p,.thtrm-section--privacy-statement ul{margin-bottom:.75rem}.thtrm-section--privacy-statement ul{margin-left:1rem}.thtrm-section--privacy-statement h3,.thtrm-section--privacy-statement h4{margin-bottom:1rem;margin-top:.5rem}.thtrm-stripe--fullwidth{font-weight:700;color:#fff;font-size:1.5rem;height:6rem;text-align:center;display:flex;width:100%;align-items:center;justify-content:center}.thtrm-section__footer,.thtrm-section__header{text-align:center;width:100%;padding:2rem 5vw}.thtrm-section__footer p+a,.thtrm-section__header p+a{display:inline-block;margin-top:2em}.thtrm-section__footer p>a:after,.thtrm-section__header p>a:after{display:none}.thtrm-section__subheading{margin-bottom:1rem}.thtrm-section--offright-white{background-color:var(--thtrm-color-white)}.thtrm-section__item--flushleft,.thtrm-section__item--flushright,.thtrm-section__item--fullwidth,.thtrm-section__item--halfpadded{width:100%}.thtrm-section__item--columns>*{margin-bottom:1rem}.thtrm-section__item--columns{font-size:var(--thtrm-small-fontsize);left:0}.thtrm-section__hero{width:100%;position:relative;margin-top:1rem;padding-top:6.25rem}.thtrm-section__hero .thtrm-section__hero-image{height:6.25rem;width:6.25rem;-o-object-fit:contain;object-fit:contain;position:absolute;left:0;top:0;z-index:var(--thtrm-layer-deco)}@media screen and (min-width:64em){.thtrm-section__hero{padding-left:16rem;margin-top:2rem;padding-top:0}.thtrm-section__hero .thtrm-section__hero-image{height:14rem;width:14rem}}@media screen and (min-width:120em){.thtrm-section__hero{width:75%}}.thtrm-content-box{background-color:var(--thtrm-color-darkblue);color:var(--thtrm-color-white);font-size:var(--thtrm-small-fontsize);padding:2rem;z-index:var(--thtrm-layer-deco)}.thtrm-section-constrained{max-width:800px;margin-left:auto;margin-right:auto;width:100%}@media screen and (min-width:50em){.thtrm-section--fullbleed{margin-left:var(--thtrm-page-neg-margin);margin-right:var(--thtrm-page-neg-margin);height:50vh;min-height:600px}}@media screen and (min-width:43.75em){.thtrm-section,[class^=thtrm-section--]{display:flex;flex-flow:row wrap;position:relative}.thtrm-section .thtrm-section__item,[class^=thtrm-section--] .thtrm-section__item{width:50%}.thtrm-section .thtrm-section__item--halfpadded,[class^=thtrm-section--] .thtrm-section__item--halfpadded{width:calc(50% - 5vw)}.thtrm-section .thtrm-section__item--flushright,[class^=thtrm-section--] .thtrm-section__item--flushright{position:relative;right:var(--thtrm-page-neg-margin);width:calc(50% + 5vw)}.thtrm-section .thtrm-section__item--flushleft,[class^=thtrm-section--] .thtrm-section__item--flushleft{position:relative;left:var(--thtrm-page-neg-margin);width:calc(50% + 5vw)}.thtrm-section .thtrm-section__item--pulldown,[class^=thtrm-section--] .thtrm-section__item--pulldown{position:relative;transform:translateY(50%);z-index:var(--thtrm-layer-deco)}.thtrm-section .thtrm-section__item--flushright-maxed,[class^=thtrm-section--] .thtrm-section__item--flushright-maxed{position:relative;right:var(--thtrm-page-neg-margin);width:calc(50% + 10vw)}.thtrm-section .thtrm-section__item--flushleft-maxed,[class^=thtrm-section--] .thtrm-section__item--flushleft-maxed{position:relative;left:var(--thtrm-page-neg-margin);width:calc(50% + 10vw)}.thtrm-section .thtrm-content-box,[class^=thtrm-section--] .thtrm-content-box{position:absolute;right:0;bottom:0;max-width:70%;transform:translate3d(0,50%,0)}.thtrm-section--undercut-bottom{margin-bottom:-2rem;z-index:var(--thtrm-layer-deco)}.thtrm-section--offright-white{background-color:var(--thtrm-color-white);max-width:70%;position:relative;right:-5%}.thtrm-section--fullbleed{margin-top:6rem}.thtrm-section__item--columns{display:grid;grid-template-columns:50% 50%;font-size:var(--thtrm-small-fontsize)}.thtrm-section__item--columns>*{margin-left:2%;margin-right:2%;-ms-grid-column-span:1}.thtrm-section__item--columns>:nth-child(odd){-ms-grid-column:1}.thtrm-section__item--columns>:nth-child(2n){-ms-grid-column:2}}@media screen and (min-width:64em){.thtrm-section__item--columns{display:grid;grid-template-columns:33% 33% 33%;font-size:var(--thtrm-small-fontsize)}.thtrm-section__item--columns>*{margin-bottom:.75rem}.thtrm-section__item--columns>:nth-child(3n+1){-ms-grid-column:1}.thtrm-section__item--columns>:nth-child(3n+2){-ms-grid-column:2}.thtrm-section__item--columns>:nth-child(3n+3){-ms-grid-column:3}}@media screen and (min-width:80em){.thtrm-section--padded-bottom{margin-bottom:7rem}.thtrm-section--offright-white{max-width:70%}.thtrm-section__footer p{padding-left:4em;padding-right:4em}}@media screen and (min-width:120em){.thtrm-section,[class^=thtrm-section--]{margin-bottom:5rem}.thtrm-section--fullbleed{height:50vh;min-height:700px}.thtrm-section--offright-white{max-width:50%;right:-30%}}.thtrm-stripe{background-color:var(--thtrm-color-lightblue);color:var(--thtrm-color-white);text-align:center;display:flex;flex-flow:column nowrap;align-items:center;justify-content:space-between;padding:1rem 2rem;min-height:140px;margin:auto;position:relative;z-index:var(--thtrm-layer-deco)}.thtrm-stripe .thtrm-stripe__cta,.thtrm-stripe .thtrm-stripe__location,.thtrm-stripe .thtrm-stripe__title{margin:.5rem 0}@media screen and (min-width:50em){.thtrm-stripe{flex-flow:row nowrap;position:absolute;left:var(--thtrm-page-margin);right:var(--thtrm-page-margin);transform:translateY(-50%)}}.thtrm-testimonials{width:90vw;display:block;overflow:hidden}.thtrm-testimonial{position:relative;width:100%;padding-top:1.75rem;font-size:1rem;line-height:1.5;white-space:normal;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.thtrm-testimonial:before{position:absolute;content:"\201C";top:-35px;left:20px;font-size:8rem;color:var(--thtrm-color-text);z-index:9999}.thtrm-testimonial>.thtrm-testimonial__avatar{display:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none}.thtrm-testimonial>.thtrm-testimonial__quote{background-color:var(--thtrm-color-gray);padding:50px 30px 30px}.thtrm-testimonial>.thtrm-testimonial__quote cite{color:var(--thtrm-color-darkblue);font-size:.75em}.thtrm-testimonial--big{position:relative;right:0;margin-left:auto;max-width:100%}.thtrm-testimonial--big>.thtrm-testimonial__quote{background-color:var(--thtrm-color-white);padding:1rem 0 0;font-weight:400;font-style:italic}.thtrm-testimonial--big>.thtrm-testimonial__avatar{max-width:200px}.thtrm-testimonial--big>.thtrm-testimonial__quote cite{color:var(--thtrm-color-darkblue);font-size:.75em;font-style:normal;font-weight:var(--thtrm-base-fontweight);margin-top:.5rem}.thtrm-testimonial--big .thtrm-testimonial__heading{font-weight:var(--thtrm-base-fontweight);font-style:normal;margin-bottom:1rem}.thtrm-testimonials__navigation{margin-top:.5rem;text-align:center;width:100%}.thtrm-testimonials__thumbnail{width:50px;height:50px;-o-object-fit:cover;object-fit:cover;opacity:.5;font-family:"object-fit: cover;"}.is-active .thtrm-testimonials__thumbnail{opacity:1;transition:.25s}@media screen and (min-width:50em){.thtrm-testimonial{position:relative;width:100%;padding-top:50px}.thtrm-testimonial>.thtrm-testimonial:before{top:-65px;left:0;font-size:10rem}.thtrm-testimonials__thumbnail{width:100px;height:100px}.thtrm-testimonial>.thtrm-testimonial__quote{padding:68px 68px 68px 210px;max-width:80%;position:relative;left:10%;top:0;z-index:98;margin-top:40px}.thtrm-testimonial>.thtrm-testimonial__avatar{display:block;position:absolute;left:3%;top:40px;max-width:240px;z-index:99}.thtrm-testimonial--big{position:relative;right:0;margin-left:auto;top:-300px;max-width:55%;margin-bottom:-300px}.thtrm-testimonial--big>.thtrm-testimonial__quote{background-color:var(--thtrm-color-white);padding:2rem 3rem 0;font-weight:400;font-style:italic;font-size:1.25rem}.thtrm-testimonial--big>.thtrm-testimonial__avatar{position:absolute;bottom:0;left:-200px;max-width:200px}.thtrm-testimonial--big>.thtrm-testimonial__quote cite{color:var(--thtrm-color-darkblue);font-size:.75em;font-style:normal;font-weight:var(--thtrm-base-fontweight);margin-top:.5rem}.thtrm-testimonial--big .thtrm-testimonial__heading{font-weight:var(--thtrm-base-fontweight);font-style:normal;margin-bottom:1rem}}@media screen and (min-width:80em){.thtrm-testimonials{width:80vw}}.thtrm-testimonials .frame{width:100%;position:relative;font-size:0;line-height:0;overflow:hidden;white-space:nowrap}.thtrm-testimonials .slides{display:block}.thtrm-testimonials li{cursor:grab;cursor:-webkit-grab}.thtrm-testimonials li,.thtrm-testimonials li:active{position:relative;display:inline-block;width:100%;vertical-align:top}.thtrm-testimonials li:active{cursor:grabbing;cursor:-webkit-grabbing}.thtrm-teaser{display:flex;flex-direction:column}.thtrm-teaser img{display:block}.thtrm-teaser--row{align-items:flex-start;flex-direction:row;justify-content:space-between}.thtrm-teaser--row .thtrm-teaser__thumb{display:none;margin-top:0;width:160px}@media screen and (min-width:64em){.thtrm-teaser--row .thtrm-teaser__thumb{display:block}}.thtrm-teaser__thumb{margin-top:12px}.thtrm-teaser__title{margin-top:4px}.thtrm-teaser__paragraph{margin-top:8px}.thtrm-teaser__link{margin-top:12px}.thtrm-raw-link{color:var(--thtrm-color-text)}.thtrm-raw-link:hover{color:var(--thtrm-color-midblue)}.thtrm-raw-link:after{display:none}.thtrm-listing{display:flex;flex-direction:column;width:100%}.thtrm-listing__item{margin-top:24px;padding-top:24px;border-top:1px solid var(--thtrm-border-color)}.thtrm-page--yellow .thtrm-listing__item{border-top-color:#000}.thtrm-topic{font-size:var(--thtrm-small-fontsize)}.thtrm-title{font-size:var(--thtrm-h4-fontszize)}.thtrm-article{font-weight:300}.thtrm-article h2,.thtrm-article h3,.thtrm-article h4{margin-top:48px;font-weight:500}.thtrm-article h2:first-child,.thtrm-article h3:first-child,.thtrm-article h4:first-child{margin-top:0}.thtrm-article h2 code,.thtrm-article h3 code,.thtrm-article h4 code{margin:0;padding:0;background:transparent!important;color:inherit;font-family:inherit;font-size:inherit;line-height:inherit;text-shadow:inherit}.thtrm-article a:after{display:none}.thtrm-article p{margin-top:24px;font-size:.8rem}.thtrm-article p code{background-color:var(--thtrm-color-gray)!important;color:var(--thtrm-color-midblue)!important;text-shadow:none!important}.thtrm-article p:first-child{margin-top:0}.thtrm-article ol,.thtrm-article ul{margin-top:24px;padding-left:24px;font-size:.8rem}.thtrm-article ol li,.thtrm-article ul li{margin-top:12px}.thtrm-article ol li code,.thtrm-article ul li code{background-color:var(--thtrm-color-gray);color:var(--thtrm-color-midblue)}.thtrm-article ol li:first-child,.thtrm-article ul li:first-child{margin-top:0}.thtrm-article .gatsby-highlight{margin-top:24px;font-size:.65rem}.thtrm-article code{font-size:.65rem}.thtrm-article iframe{margin-top:24px;width:100%;min-height:400px}.thtrm-article-thumb{margin-bottom:32px}.thtrm-article-caption{margin-top:-16px;font-size:.6rem;width:100%;text-align:right}.thtrm-article-caption a:after{display:none}.thtrm-article-header{text-align:center}.thtrm-article-header,.thtrm-article-header__metabar,.thtrm-media{justify-content:center}.thtrm-media{align-items:center;display:grid;grid-template-rows:auto 1fr;text-align:center}@media screen and (min-width:64em){.thtrm-media{align-items:center;grid-template-columns:200px 1fr;grid-template-rows:none;justify-content:flex-start;text-align:left}}.thtrm-media__asset{margin:0 auto;max-width:200px}@media screen and (min-width:64em){.thtrm-media__asset{grid-column:1;max-width:none}}@media screen and (min-width:64em){.thtrm-media__body{grid-column:2}}.thtrm-media--top-start{align-items:flex-start}.thtrm-media-short{display:flex;flex-direction:row}.thtrm-media-short__body{padding-left:8px}.thtrm-avatar{height:25px;width:25px;border-radius:150px}.thtrm-metabar{flex-wrap:wrap;margin-top:-12px}.thtrm-metabar,.thtrm-metabar__item{align-items:center;display:flex;flex-direction:row}.thtrm-metabar__item{margin-top:4px}.thtrm-metabar__item:after{content:"/ ";padding:0 8px}.thtrm-metabar__item:last-child:after{display:none}.u-text--centered{text-align:center}.u-flex{align-items:center;display:flex;flex-direction:row}.u-flex--start{align-items:flex-start}.u-link-plain:after{display:none}.u-flex--nowrap{flex-wrap:nowrap}.u-flex--justify-center{justify-content:center}.u-flex--justify-end{justify-content:flex-end}.u-distance-reset{margin-top:0!important}.u-distance-tiny{margin-top:8px}.u-distance-small{margin-top:16px}.u-distance{margin-top:24px}.u-distance-medium{margin-top:48px}.u-distance-large{margin-top:100px}.u-distance-bottom-reset{margin-bottom:0!important}.u-unflex{display:block}.u-text--bigger{font-size:2em;line-height:1}.u-text--small{font-size:var(--thtrm-small-fontsize)}.u-min-h1{min-height:712px}.u-img-fit-height{height:100%;-o-object-fit:cover;object-fit:cover;font-family:"object-fit: cover;"}.u-mega-padding-bottom{margin-bottom:200px}.u-offscreen-text{position:absolute;left:-5000px}.u-fill-space{height:100%;width:100%}.u-color--red{color:var(--thtrm-amc-red)}.u-color--pink{color:var(--thtrm-rxjs-pink)}.u-color--grey{color:var(--thtrm-color-lighttext)}.u-bg-lightgray{background-color:var(--thtrm-color-ultralightgray)}.u-bg--red{background-color:var(--thtrm-amc-red)}.u-bg--pink{background-color:var(--thtrm-rxjs-pink)}.u-bg--orange{background-color:var(--thtrm-git-orange)}.u-color--orange{color:var(--thtrm-git-orange)}@media screen and (min-width:50em){.u-max-width--half{max-width:50%;margin:0 auto;width:100%}}@media screen and (min-width:50em){.u-max-width--3-4{max-width:75%;margin:0 auto;width:100%}}</style><style data-href="/styles.246d67a4ef7e9adeefa5.css">code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#f8f8f2}.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.15.21"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#384c54"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=50794189bf1d1bd3459211725d37e57e"/><title data-react-helmet="true">A simple guide to Reinforcement Learning | Articles by thoughtram</title><meta data-react-helmet="true" name="description" content="This is part one in a series of articles on Reinforcement Learning that aim to explore this exciting Machine Learning subfield from a beginners perspective."/><meta data-react-helmet="true" name="google-site-verification" content="o9eGPEgIETEqYGombq7NiQuBIB_qa6gz1yAL7PxKyK0"/><meta data-react-helmet="true" name="theme-color" content="#384c54"/><meta data-react-helmet="true" property="og:title" content="A simple guide to Reinforcement Learning"/><meta data-react-helmet="true" property="og:description" content="This is part one in a series of articles on Reinforcement Learning that aim to explore this exciting Machine Learning subfield from a beginners perspective."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="thoughtram"/><meta data-react-helmet="true" name="twitter:title" content="A simple guide to Reinforcement Learning"/><meta data-react-helmet="true" name="twitter:description" content="This is part one in a series of articles on Reinforcement Learning that aim to explore this exciting Machine Learning subfield from a beginners perspective."/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-6a14d6c49d22aa388ff9.js"/><link as="script" rel="preload" href="/styles-e0e38ca7b54561c3f057.js"/><link as="script" rel="preload" href="/commons-9a6c7e4a80f98fe6d0b9.js"/><link as="script" rel="preload" href="/app-db11fdec89ef44788bcc.js"/><link as="script" rel="preload" href="/webpack-runtime-c99afa6b532686815600.js"/><link as="fetch" rel="preload" href="/page-data/machine-learning/2018/02/28/a-simple-guide-to-reinforcement-learning.html/page-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="thtrm-page undefined"><header class="thtrm-banner" role="banner"><a href="https://thoughtram.io" title="Home"><img src="/static/logo-8fe34043fb96d58a991170a33702a469.svg" alt="thoughtram" class="thtrm-logo" title="The thoughtram logo"/></a></header><main class="thtrm-main" role="main"><nav class="thtrm-nav-toc"><a title="Back to Blog" href="/">← Back to Blog</a></nav><div style="margin:auto;text-align:center;min-height:30px" id="codefund"></div><script type="text/javascript" src="https://app.codefund.io/properties/723/funder.js" async=""></script><section class="thtrm-section u-distance-bottom-reset"><div class="thtrm-section__heading thtrm-article-header thtrm-section-constrained u-distance-bottom-reset"><div class="thtrm-metabar thtrm-article-header__metabar"><div class="thtrm-metabar__item thtrm-topic u-color--grey"><div class="thtrm-media-short"><img alt="Author" src="https://avatars0.githubusercontent.com/u/521109?s=460&amp;v=4" class="thtrm-avatar"/><p class="thtrm-media-short__body"><a href="https://twitter.com/cburgdorf" class="u-link-plain">Christoph Burgdorf</a></p></div></div><time dateTime="28 February 2018" class="thtrm-metabar__item thtrm-topic u-color--grey">28 February 2018</time><p class="thtrm-metabar__item thtrm-topic u-color--grey"><a class="u-link-plain" href="/categories/machine-learning">Machine-learning</a></p></div><h1 class="thtrm-section__subheading u-distance-tiny">A simple guide to Reinforcement Learning</h1></div><div class="thtrm-ratio--stripe thtrm-article-thumb u-fill-space u-img-fit-height gatsby-image-wrapper" style="position:relative;overflow:hidden"><div style="width:100%;padding-bottom:66.66666666666667%"></div><img src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAv/aAAwDAQACEAMQAAAB6ZapzJH/xAAZEAACAwEAAAAAAAAAAAAAAAAAAQISIUH/2gAIAQEAAQUCqiqHARyb3//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABgQAAIDAAAAAAAAAAAAAAAAAAAQAREh/9oACAEBAAY/AlsFv//EABwQAAIDAAMBAAAAAAAAAAAAAAABESExQVFhgf/aAAgBAQABPyHGESrLJHZPglIducIfk//aAAwDAQACAAMAAAAQ0+//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAwEBAQEAAAAAAAAAAAABABEhMUFRcf/aAAgBAQABPxBYIfWuQuEPhmgxbrhOzpcQwb+w6XTxntRyKv8AU//Z" alt="" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/91642bb563f4fc748d420f0ce45fb561/10bdc/a-simple-guide-to-reinforcement-learning.jpg 158w,
/static/91642bb563f4fc748d420f0ce45fb561/f4ab0/a-simple-guide-to-reinforcement-learning.jpg 315w,
/static/91642bb563f4fc748d420f0ce45fb561/30037/a-simple-guide-to-reinforcement-learning.jpg 630w,
/static/91642bb563f4fc748d420f0ce45fb561/9810d/a-simple-guide-to-reinforcement-learning.jpg 945w,
/static/91642bb563f4fc748d420f0ce45fb561/81ef8/a-simple-guide-to-reinforcement-learning.jpg 1200w" sizes="(max-width: 630px) 100vw, 630px" /><img loading="lazy" sizes="(max-width: 630px) 100vw, 630px" srcset="/static/91642bb563f4fc748d420f0ce45fb561/10bdc/a-simple-guide-to-reinforcement-learning.jpg 158w,
/static/91642bb563f4fc748d420f0ce45fb561/f4ab0/a-simple-guide-to-reinforcement-learning.jpg 315w,
/static/91642bb563f4fc748d420f0ce45fb561/30037/a-simple-guide-to-reinforcement-learning.jpg 630w,
/static/91642bb563f4fc748d420f0ce45fb561/9810d/a-simple-guide-to-reinforcement-learning.jpg 945w,
/static/91642bb563f4fc748d420f0ce45fb561/81ef8/a-simple-guide-to-reinforcement-learning.jpg 1200w" src="/static/91642bb563f4fc748d420f0ce45fb561/30037/a-simple-guide-to-reinforcement-learning.jpg" alt="" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></section><section class="thtrm-section thtrm-section-constrained thtrm-article u-distance"><div class="thtrm-section__heading u-distance-reset"><p>This is the first post in a series of articles on <strong>Reinforcement Learning</strong> which is a subfield of <strong>Machine Learning</strong> on that we have <a href="/machine-learning/2016/09/23/beginning-ml-with-keras-and-tensorflow.html">blogged</a> <a href="/machine-learning/2016/11/02/understanding-XOR-with-keras-and-tensorlow.html">about</a> <a href="/announcements/machine-learning/2017/12/20/machine-learning-jump-start-online-course.html">before</a>.</p>
<p>Machine Learning is all about having a piece of software learn to solve tasks that it was not explicitly programmed for. Instead, it learns by observing data with the goal to find patterns that it can generalize into certain rules. In other words, instead of having to explicitly define rules using traditional programming constructs such as conditions, loops or function calls, we’ll let a machine figure out those rules in an automatic iterative process.</p>
<p>Most forms of Machine learning still relies on human input though. In particular, humans are needed to select and provide lots of data for the machine to learn from. In contrast, Reinforcement Learning takes the idea another step forward. Instead of providing datasets, we let the machine take actions in the environment that we want it to master and give it feedback on its actions in the form of rewards or punishment. In other words, the machine has no clue about the task it is trying to solve. It basically starts acting randomly at first, but develops a policy to solve the task over time. Doesn’t that sound exciting?</p>
<h3>A word of warning</h3>
<p>This post aims to provide an easy entry for beginners who are new to Reinforcement Learning or even Machine Learning in general. We may oversimplify or sacrifice performance in certain areas to achieve this goal. We’ll also choose a simpler vocabulary over a more scientific one whenever possible.</p>
<p>In this article we want to learn the basics of Reinforcement Learning using a simple <strong>Q-Table</strong> approach. Don’t worry if that doesn’t ring a bell yet. We’ll learn what all of this means as we go.</p>
<p>We’ll be taking things further in follow-up articles in which we’ll do <strong>Deep Reinforcement Learning</strong> using a <strong>neural net</strong> instead of the Q-Table. Step by step we’ll learn about the <strong>explore-exploit dilemma</strong>, <strong>replay memory</strong> and many other exciting things. But let’s start simple!</p>
<h2>Defining a simple game</h2>
<p>As our main goal is to learn Reinforcement Learning, let’s keep the actual task that we want our machine to learn as simple as possible. In fact let’s just make up a simple math game ourselves! We’ll call it “Catch 5” and these are the rules:</p>
<ol>
<li>Every game starts by revealing a random number between 1 and 12 with the exception of the number 5 that will never be the starting point.</li>
<li>From that given starting point, it is our goal to get to number 5 by simple addition/subtraction. However, we can only choose from the following six actions: <strong>Add 3</strong>, <strong>Add 2</strong>, <strong>Add 1</strong>, <strong>Subtract 1</strong>, <strong>Subtract 2</strong> and <strong>Subtract 3</strong></li>
<li>We can only play a maximum of three turns. If we don’t get to 5 within three turns, we have lost the game. Since the starting number is between 1 and 12, it is always possible to win the game if we don’t screw up the basic math :)</li>
</ol>
<p>Our game may turn out like this and we win in two turns.</p>
<blockquote>
<p><strong>Game</strong>: Starting number is <strong>9</strong>. Catch 5!</p>
</blockquote>
<blockquote>
<p><strong>Player</strong>: playing <strong>-3</strong></p>
</blockquote>
<blockquote>
<p><strong>Game</strong>: You played <strong>-3</strong>, now at <strong>6</strong>. Catch 5!</p>
</blockquote>
<blockquote>
<p><strong>Player</strong>: playing <strong>-1</strong></p>
</blockquote>
<blockquote>
<p><strong>Game</strong>: Caught 5! You won in <strong>2</strong> turns.</p>
</blockquote>
<p>However, keep in mind that our machine has no idea about the rules of the game at first and basically just “sees” six buttons without any description on how to play. It doesn’t even know it’s playing a game, so it may act like the following and lose.</p>
<blockquote>
<p><strong>Game</strong>: Starting number is <strong>9</strong>. Catch 5!</p>
</blockquote>
<blockquote>
<p><strong>Player</strong>: playing  <strong>+3</strong></p>
</blockquote>
<blockquote>
<p><strong>Game</strong>: You played <strong>+3</strong>, now at <strong>12</strong>. Catch 5!</p>
</blockquote>
<blockquote>
<p><strong>Player</strong>: playing <strong>-1</strong></p>
</blockquote>
<blockquote>
<p><strong>Game</strong>: You played <strong>-1</strong>, now at <strong>11</strong>. Catch 5!</p>
</blockquote>
<blockquote>
<p><strong>Player</strong>: playing <strong>-3</strong></p>
</blockquote>
<blockquote>
<p><strong>Game</strong>: You played <strong>-3</strong> with your last move. Now at <strong>8</strong>. <strong>You lost</strong>!</p>
</blockquote>
<p>We didn’t manage to get to number 5 within three turns, which means we have lost the game. But how is our machine going to find out how to win the game if we don’t explicitly teach it how to play?</p>
<h2>A Q-Table to the rescue</h2>
<p>As we can see our game isn’t that complex and we may wonder what’s the point of such a silly toy task. It turns out that a simple task like this makes it very easy for us to explore the topic and enables us to visualize the states and their possible actions in simple graphics.</p>
<p>Notice that the <strong>5</strong> is a special state here as it is the final winning state from which no further action can be done.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 405px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/c2ab1511f1b3ea143865b30690ccdb40/723df/catch_5_game_states.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 85.67901234567901%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAFIElEQVQ4yyWUW3ASdxTGF2c6OmJI1D50fGnf7GOfenmxYzt2Ou04TqfTjradaWO9Jd6qlhgICYTlkmW5LpDsArvZcIdlWQgEIiAQIFwDCZqbTWdM2urYWp3acaa21m4X/b+d38P3P/Od7xxgxxEPcM6U6+7Tzr6scVcFem+ja8g+33NcPbP3LFLYfQaK71WSFQHkbnSJsGJPr3pmTz9SfM7HXDWB3rfA8cJuju8+gdR5wA7hfzx7bPEyRCRJOHQjADPrDBKqE1pnRmdPrsvUtigBBdvUWGg1ilAVAnZltfbkmlyFRUktfTOgZdZpjpM6d04Bxv/oAl4nWZ4pUBkC8TTTby097UdrrISsNXXuvNFIL2mkWJLptxT+OWMpsWKiXNe65/QmelE3giZiZ8eLz04hc+wQMd/QewtjA76tbmCfmuVZ6IZERaRpIV67fREtPVR6F7I6z5zFHLlhktsSCSFe/u2SrfhE4amWYXfBxnH9KJZgBoj65iVs/j7oqmQNvqJGytwTANsvPOIZqUa/ejKjJ2bXxM7clshK1+RqMjdqia1+qiVTX3rTTz6kCuwhR/jGJ5B77qghtCRU4UndZGpD7MptDZoD80rIXRTJ6Dt8YOfVZzws2rqiciScUnczM+JplzT+WlDnTMFfedjtAPc+R98/fdR2YPgwemB/p7bPLA3I0WmfzLOYlnrbRdhXDsDO6ypp5EEXsA9ieeZQTQziGeY0kmNPIgV22LXQMnkysDbCdp0KHtv3NXmQ7Y+/x/Z6Dgs7gtZoXTaCzSZOm3Lst4YsO0xWGkZvXimm7gqA14wszxCoDqvIbEjiajZFztYtyN+IT9AV+DMH+1JH4Kjj3ZFjjnfQI9hbb3RqI1UdBR2pyLC71RQ7m2tqTyU+EW4oJcFNAQD0bvIQutmnsCf1RHJ10JXdGpgI10fl9hSoDy9/MGqNfuxK/PU2lWffxKilg1J76iOEuXkZRKf1k9duDXryPwmtVBkEiesSRewhH9jv4qYcqg5wgl4R2WgJifoPKk8txuVKb4209ZxXMRFZ+1GIV+6pPeUs7Mqjlkh7TDYR9YmnFlpCvLrOdTjNxUw5GPhFAOy68mgbNt0SqcnrzDm0yp7H26zU1WhZ/HkdllhTK/BU+Ix5jj1hzLEjU7U64svDtsSaRm6/xuWwxJ4yF1jpVKVpDRYV0sj9buAVFcvTB6rfK/AMofC3QwpqNa4N1HGjf16lpRbloC2Jg/52WB5YSWj9VdzgLyu1wZZSbksSyuBNWkmtTmu85UmEqg5L6Z93Adv67vPMdPO8wp6wcD/L8fSmfDzcGOM8hMzRFRGITSPj0yvKiZkN5ThdHZM70mpzdFkColEES6yDROa2zBqqariGZKPR3/nAq9bnHg51NuWCJXunz5h+PDJZKmlcc+Nmpg3LsXj44nj+7vmJ4uNhvFCEXAWrmVnSjaLxyGXb/N0+Y+rPEaJQ1LgLugHP7W5gj/jvbSizMAi55qjjUOxpLzz7IleenAGNr6iVeCp0Ap759ySXuSG8WOPMN2AzqxDouMacNqaffQMlnnOTr6CShH8VAPyrbGdTzmmn0hY9s2LXxzZIS3jBbPQVQE5QpCESZm14GeeukNNM1xGjrySfiC1LICJhMURW7YbYBmEKVqzmYFmsmnmwCzgEP+DuYbZL5Cj3OCJNPh4q71S5qoLvxkvd/YZM9xBR6cHCC3yUqvHH3C/42Q7HKz2O6CJ/MlzdqXbXOlzwhSzK+x/CCCXGrOQg1AAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="catch 5 game states"
        title="catch 5 game states"
        src="/static/c2ab1511f1b3ea143865b30690ccdb40/723df/catch_5_game_states.png"
        srcset="/static/c2ab1511f1b3ea143865b30690ccdb40/9ec3c/catch_5_game_states.png 200w,
/static/c2ab1511f1b3ea143865b30690ccdb40/c7805/catch_5_game_states.png 400w,
/static/c2ab1511f1b3ea143865b30690ccdb40/723df/catch_5_game_states.png 405w"
        sizes="(max-width: 405px) 100vw, 405px"
        loading="lazy"
      />
  </a>
    </span></p>
<p><em>Let’s ignore the fact that our defined rules would allow to also reach numbers above 12 or below 1. Even if we allow these states to happen, they don’t change the principles of what we are about to learn.</em></p>
<p>Our main takeway for now should be, that we can think of our game as a defined space of states where we can take six possible actions from every single state.</p>
<p>The thing that we want our machine to learn is <strong>a mapping</strong> from every <strong>possible state</strong> to its <strong>best possible action</strong>. Let’s assume the best strategy to win this game would be to always move with the biggest possible step towards the number 5. We could visualize the entire state space and their best actions as seen in the following animation.</p>
<p><img src="/9a806b145b1b87ee22950bb562df02af/catch_5_state_flow.gif"></p>
<p>For instance, starting at <strong>12</strong>, the best move we could do is to play <strong>-3</strong> which takes us to <strong>9</strong>, from where we play <strong>-3</strong> again, which takes us to <strong>6</strong>, from where we play <strong>-1</strong> and win the game in three turns.</p>
<p>Obviously, our strategy isn’t the only one to win the game. Given a starting point of <strong>9</strong> for instance, we could play <strong>-3</strong> followed by <strong>-1</strong> or we could play <strong>-2</strong> followed by <strong>-2</strong> or even <strong>-1</strong> followed by <strong>-3</strong>. Each of these pairs of actions would make us win the game in two turns. That is perfectly fine, in fact, we don’t know yet what kind of policy our machine will develop to figure out how to win this game.</p>
<p>The most important learning up to this point should be that our machine can develop a mapping of states to rated actions. Such a mapping is called a <strong>Q-Table</strong>.</p>
<p>For instance, looking at state <strong>9</strong> we can easily imagine that the machine develops a strong sympathy towards playing <strong>-3</strong> indicated in red with the other possible actions having a less strong indication of being the best action.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 495px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/f26ed8aaa04a93258a87d0e43703e8a5/fa082/catch5_heatmap.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 65.05050505050505%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAADsUlEQVQ4y12Tf0yTRxzGn3vf/oAC0rggAxfoaglrJBMHBtAVBNxoS9/ytlCQZYCKuMKUKYiAlkKHwYHQSlrpFgNUSlsopUUkEpdFM5fs1x8zMTFxCxl/6OZiFhP/2pYs64522ZJd8uTuvsl98n2euwOQBlR7XobOI6NzFgyhLLQ+yERNIIvRzmTDsJitLLLKbiJdfpPslK+STPkaMuQRut/AzuwfkZEdQYZiVqBIRmykHgJq5ltgWBiAMdhL1K4hUmD+GNx1C8sH+lB/o3d/8YWhpxBd/QWJzqdIdG3pBSSTSxD7V5DgfYbkT74QpBfGeCy2U6C/CbzPwio0IXKgb4JVGgI4ODLK1i6fg2mlr6T4gu0xEqZ+IsmuJyTJ9TMkrjsQz14jopCNiNaeI8n9pWBHHIgdHAX6Yh2SikuXSJltjLzePAO1e5TaHQXvH5Nw3rE95Zcn8lXDV2SVDvvp3MPOJ2CmPUS8MgdR+FdIpr9l0/bFgcozgG6uAXpfFxput9HsTkE7+wH4YD+FOWBcugyN24kqpxv1q2M4fMteeMB6cROizs+F27vvs9LOb4Qv9QQkrypjPKI0E3A+DQU1MyXnzjAq6ynBa/xHqHL300wnaOfjjLL2FqusW2crJ9wwrdrzS4f6ogSHLInCzs4EUfcziUg7L30lKwZkZEaCmgUN9N4jAoXGyb7RZhEoqiZRPXOWwuxbQJJ/bJnZ9dY9RjU4g8bb4wWqgfNhoNUsZi/2CZneP8XgIinp2XHLed0EOq8eev9xcPNHGdVQFwo6+8F5z4IP2FEbHiXFXXPMnpYIa/CNw7Ts2Ftm6/+egdGSlNzlSZC03E9KNXmku2RxYP4Atex9G/xCI965w8EQNEE91RjLkg84YQg4wC86oL9hhz5kh3rVtbt1xBJ9AO13/lTTw0hK7canUtPytCLeIZNzlFBYKeHna9hcziou6nhPuLvuPIxhE611gAua0951drRfqT9x0tlwvHWi6cRkqLTpt+fghq1s/+KS6Fg0Cs3drzPiGZLcNgoMVNAbNbF5DVbh/i4zm6Mdpw+7jjUFddCu6Uq6B/joX9DTg1qq6ugf0N9bJ0dsPWRwbETYE40y+s/uZv5jee/gluUCaqsczV8VEfVUJfadNtKvWMEYA2XQhA/mtQ+XP3qYUra5se3NjR9SVZsbyarfXySW+OfE2gWfWP14c1tZeF2ejn+HspuQ3PcZJimHxYfReE3lI5C3M9LCkwS4ShX9nx6R/wCxWmz1N6nSPOU+oLo1AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Catch 5 game states"
        title="Catch 5 game states"
        src="/static/f26ed8aaa04a93258a87d0e43703e8a5/fa082/catch5_heatmap.png"
        srcset="/static/f26ed8aaa04a93258a87d0e43703e8a5/9ec3c/catch5_heatmap.png 200w,
/static/f26ed8aaa04a93258a87d0e43703e8a5/c7805/catch5_heatmap.png 400w,
/static/f26ed8aaa04a93258a87d0e43703e8a5/fa082/catch5_heatmap.png 495w"
        sizes="(max-width: 495px) 100vw, 495px"
        loading="lazy"
      />
  </a>
    </span></p>
<p>The complete <strong>Q-Table</strong> contains all possible states and their rated possible actions. Once the machine has developed such a mapping, it can simply lookup the current state in the table and perform the action with the highest rating. It repeats this process for each turn until it wins the game.</p>
<p>Obviously, this approach does only work if the entire state space is small enough to be represented as such a simple table. But let’s not get ahead of ourselves.</p>
<p>Ok, so we know we want our machine to develop such a <strong>Q-Table</strong>. But how does that work?</p>
<h2>Creating the environment, the game</h2>
<p>As we’ve spoiled in the beginning, Reinforcement Learning is about machines acting in an environment and receiving positive or negative rewards to eventually learn a policy to solve a task.</p>
<p>Let’s begin by creating the environment - the game - that our machine will be playing.</p>
<p>The game is already implemented in the demo above. Notice that the interactive demo is written in TypeScript and runs on <a href="https://stackblitz.com">stackblitz.com</a>. For the rest of the article and the follow-up articles, we’ll be using Python since it has a great ecosystem for Machine Learning. For demos we’ll be using <a href="https://machinelabs.ai">machinelabs.ai</a> which is the perfect platform for these kind of tasks.</p>
<p>Rest assured, the code is equally simple no matter whether we’ll be using TypeScript or Python!</p>
<div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Game</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">reset</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>current_number <span class="token operator">=</span> random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_number <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      self<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>turns <span class="token operator">=</span> <span class="token number">0</span>

  <span class="token keyword">def</span> <span class="token function">has_lost</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> self<span class="token punctuation">.</span>turns <span class="token operator">>=</span> <span class="token number">3</span> <span class="token keyword">and</span> self<span class="token punctuation">.</span>current_number <span class="token operator">!=</span> <span class="token number">5</span>

  <span class="token keyword">def</span> <span class="token function">has_won</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> self<span class="token punctuation">.</span>turns <span class="token operator">&lt;=</span> <span class="token number">3</span> <span class="token keyword">and</span> self<span class="token punctuation">.</span>current_number <span class="token operator">==</span> <span class="token number">5</span>

  <span class="token keyword">def</span> <span class="token function">is_active</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>has_lost<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>has_won<span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">play</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> action<span class="token punctuation">:</span> Action<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>turns <span class="token operator">>=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Max number of turns reached. Call reset.'</span><span class="token punctuation">)</span>

    self<span class="token punctuation">.</span>turns <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    self<span class="token punctuation">.</span>current_number <span class="token operator">+=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>

    <span class="token keyword">return</span> self<span class="token punctuation">.</span>has_won<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<p>There are really only two basic requirements that we have for the API of the game:</p>
<ul>
<li><strong>A <code class="language-text">play</code> method</strong> that takes an action and applies it to the current state. This is the most important API as it will control the game and move us from one state to another.</li>
<li><strong><code class="language-text">has_won()</code>/<code class="language-text">has_lost()</code> methods</strong> to figure out if we have won or lost the game. These APIs are important to gather feedback to learn from.</li>
</ul>
<p>We’ve also added some other APIs for convenience but the listed APIs are really the only crucial ones for our mission.</p>
<h2>Building the agent</h2>
<p>There are multiple actors in Reinforcement Learning. We’ve already build a simple game, which serves as the environment, that we want our machine to act in. </p>
<p>In order to play the game we need an <em>agent</em> that will perform actions in the game with the intention to figure out how to win the game over time.</p>
<p>We’ll start with something really simple and implement two methods, namely <code class="language-text">play</code> and <code class="language-text">play_and_train</code>. The <code class="language-text">play</code> method basically lets the agent play the game for a given number of times in a mode where we can follow the visual output.</p>
<div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token comment"># creating random actions</span>
<span class="token keyword">def</span> <span class="token function">get_action</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>

<span class="token comment"># mapping actions (0, 1, 2, 3, 4, 5) to answers (3, 2, 1, -1 , -2, -3)</span>
<span class="token keyword">def</span> <span class="token function">action_to_answer</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> actionMap<span class="token punctuation">[</span>action<span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">play</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_times<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> nb_game <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> num_times <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

      self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Starting game #{nb_game}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>nb_game<span class="token operator">=</span>nb_game<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>is_active<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Current number is {current_number}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>current_number<span class="token operator">=</span>self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>current_number<span class="token punctuation">)</span><span class="token punctuation">)</span>
        action <span class="token operator">=</span> self<span class="token punctuation">.</span>get_action<span class="token punctuation">(</span><span class="token punctuation">)</span>
        human_readable_answer <span class="token operator">=</span> self<span class="token punctuation">.</span>action_to_answer<span class="token punctuation">(</span>action<span class="token punctuation">)</span>
        
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Playing {answer}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>answer<span class="token operator">=</span>human_readable_answer<span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>play<span class="token punctuation">(</span>human_readable_answer<span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>has_won<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
          <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'You won!'</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>has_lost<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
          <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'You lost'</span><span class="token punctuation">)</span>

      <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'##############################################'</span><span class="token punctuation">)</span></code></pre></div>
<p>As you can see, there’s no rocket sience behind it. A simple loop for the number of times we want our agent to play and an inner loop for the game itself to make turns as long as the game isn’t either won or lost.</p>
<p>Also notice that we are mapping the human readable answers (<code class="language-text">+3, +2..-2, -3</code>) to zero based values (<code class="language-text">0, 1..4, 5</code>) so that we can easily address them as indexes in an array to make our life much easier.</p>
<p>Since our agent is just making random moves, we should’t expect super powers either. Here’s some output from it playing randomly. It even won game #4 by accident. Hooray! For this simple game though we’d really want our agent to win 100% of the games!</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">Starting game #1
Current number is 7
Playing 1
Current number is 8
Playing 2
Current number is 10
Playing 3
You lost
##############################################
Starting game #2
Current number is 10
Playing 1
Current number is 11
Playing 1
Current number is 12
Playing -2
You lost
##############################################
Starting game #3
Current number is 1
Playing 3
Current number is 4
Playing -2
Current number is 2
Playing -2
You lost
##############################################
Starting game #4
Current number is 7
Playing -2
You won!
##############################################</code></pre></div>
<p>We’ll keep the <code class="language-text">play</code> method to have an API that we can call that gives us visual feedback when the agent plays the game.</p>
<p>As we mentioned we’ll also implement a <code class="language-text">play_and_train</code> method which will play in a <em>headless</em> mode, meaning we won’t be able to follow along the moves. Instead, we’ll get live metrics to follow along how the actual training is working out. For instance, we’d like to count the number of won or lost games.</p>
<p>Let’s take a look how <code class="language-text">play_and_train</code> is implemented.</p>
<div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token keyword">def</span> <span class="token function">play_and_train</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
  stats <span class="token operator">=</span> TrainStats<span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>nb_epoch <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span>
    stats<span class="token punctuation">.</span>epoch <span class="token operator">=</span> epoch

    <span class="token keyword">while</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>is_active<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

      state <span class="token operator">=</span> self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>current_number

      action <span class="token operator">=</span> self<span class="token punctuation">.</span>get_action<span class="token punctuation">(</span><span class="token punctuation">)</span>
      human_readable_answer <span class="token operator">=</span> self<span class="token punctuation">.</span>action_to_answer<span class="token punctuation">(</span>action<span class="token punctuation">)</span>

      self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>play<span class="token punctuation">(</span>human_readable_answer<span class="token punctuation">)</span>

      reward <span class="token operator">=</span> self<span class="token punctuation">.</span>get_reward<span class="token punctuation">(</span><span class="token punctuation">)</span>
      next_state <span class="token operator">=</span> self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>current_number
      final <span class="token operator">=</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>is_active<span class="token punctuation">(</span><span class="token punctuation">)</span>
      self<span class="token punctuation">.</span>train<span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">,</span> reward<span class="token punctuation">,</span> next_state<span class="token punctuation">,</span> final<span class="token punctuation">)</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>has_won<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        stats<span class="token punctuation">.</span>nb_wins <span class="token operator">+=</span> <span class="token number">1</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>has_lost<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        stats<span class="token punctuation">.</span>nb_losses <span class="token operator">+=</span> <span class="token number">1</span>

    stats<span class="token punctuation">.</span>p_wins <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">/</span> epoch <span class="token operator">*</span> stats<span class="token punctuation">.</span>nb_wins
    stats<span class="token punctuation">.</span>p_loss <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">/</span> epoch <span class="token operator">*</span> stats<span class="token punctuation">.</span>nb_losses

    <span class="token keyword">if</span> <span class="token punctuation">(</span>epoch <span class="token operator">%</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>print_every_n_epoch <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      self<span class="token punctuation">.</span>print_epoch_stats<span class="token punctuation">(</span>stats<span class="token punctuation">)</span></code></pre></div>
<p>It’s really not that much different. Instead of printing out each and every move, we’ll collect <code class="language-text">stats</code> to print out at a given frequency. Also notice that we slightly changed the wording: From now on, we’ll be calling the number of times that our agent plays the game <strong>epochs</strong> which is the general term for a complete training cycle.</p>
<h3>Collecting the precious bits</h3>
<p>The eagle-eyed reader may have spotted that there are in fact some subtle changes that are quite important. We collect five important variables that we are passing to a new <code class="language-text">train</code> method on our agent.</p>
<p>Let’s take a closer look at what these things are:</p>
<ol>
<li>The <code class="language-text">state</code> is just the current number of the game <strong>before</strong> we take our action. For instance, this may be the number <code class="language-text">9</code>.</li>
<li>The <code class="language-text">action</code> is simply the move that our agent performed on the <code class="language-text">state</code>. For instance, playing <code class="language-text">-2</code> is an action in our game. Notice however that we internally represent these actions with the numbers <code class="language-text">0</code> to <code class="language-text">5</code> and just map them to their human readable values (3..-3) when we invoke <code class="language-text">play</code> on the game.</li>
<li>The <code class="language-text">next_state</code> is the current number of the game <strong>after</strong> we took our action. If the <code class="language-text">state</code> was <code class="language-text">9</code> and the action was <code class="language-text">-2</code> the <code class="language-text">next_state</code> will be <code class="language-text">7</code>.</li>
<li>The <code class="language-text">final</code> variable is <code class="language-text">True</code> when the game is either won or lost and <code class="language-text">False</code> when the game is still active.</li>
<li>The most important variable that we haven’t yet talked about is the <code class="language-text">reward</code>. At the end of the day, this is what enables our agent to learn at all. We’ll get the reward by calling <code class="language-text">self.get_reward()</code> and we’ll take a look at the implementation in the next section.</li>
</ol>
<h3>The reward function</h3>
<p>As mentioned, the reward function is one of the most important things to design in a Reinforcement Learning system. It will heavily influence the policy that our agent will learn.</p>
<p>It’s out of the scope of this article to discuss this in detail. Fortunately designing the rewards should be pretty straight forward and easy to follow for our simple task.</p>
<p>Remember that this is the function we call <em>after</em> our agent performed an action.</p>
<div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token keyword">def</span> <span class="token function">get_reward</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">if</span> self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>has_won<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token number">1</span>
  <span class="token keyword">elif</span> self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>has_lost<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">0.1</span></code></pre></div>
<p>As we can see, we return a positive reward of <code class="language-text">1</code> when our agent won the game, a negative reward of <code class="language-text">-1</code> when it lost the game and a negative reward of <code class="language-text">-0.1</code> for every action that didn’t <em>directly</em> lead to winning or losing the game. In other words, every action is penalized with a slightly negative reward of <code class="language-text">-0.1</code>. This makes sense if we keep in mind that it is our goal to win the game in a maximum of three turns. So even if we consider that we have to make at least one turn per game, turns can be considered costly overall which is essentially what we price in here.</p>
<h3>Updating the Q-Table</h3>
<p>Ok, so let’s see how we can build up this <strong>Q-Table</strong> that we talked about before. Remember we are calling <code class="language-text">self.train(state, action, reward, next_state, final)</code> and by now we should have a clear understanding what each parameter represents.</p>
<p>Before we move on, let’s create a new instance member on our agent called <code class="language-text">qtable</code>. We’ll initialize it as an empty hash map. Remember that we said the Q-Table basically maps states to rated actions. Naturally these things can well be represented as hash maps.</p>
<div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py">self<span class="token punctuation">.</span>qtable <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre></div>
<p>We will also create a new method <code class="language-text">ensure_qtable_entry</code> which takes care of creating entries in our qtable in case they don’t exist yet.</p>
<div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token keyword">def</span> <span class="token function">ensure_qtable_entry</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">if</span> state <span class="token keyword">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>qtable<span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>qtable<span class="token punctuation">[</span>state<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span></code></pre></div>
<p>Notice that the key is the <code class="language-text">state</code> itself and the value is a numpy array with six entries initialized to <code class="language-text">0</code>, each representing one of our six possible actions. If the term <em>numpy array</em> is new to you, just think of an array with a <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html">super powerful API</a>.</p>
<p>With that in place, let’s unveil what happens inside  the <code class="language-text">train</code> method.</p>
<div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">,</span> action<span class="token punctuation">,</span> reward<span class="token punctuation">,</span> next_state<span class="token punctuation">,</span> final<span class="token punctuation">)</span><span class="token punctuation">:</span>

  self<span class="token punctuation">.</span>ensure_qtable_entry<span class="token punctuation">(</span>state<span class="token punctuation">)</span>
  self<span class="token punctuation">.</span>ensure_qtable_entry<span class="token punctuation">(</span>next_state<span class="token punctuation">)</span>

  <span class="token keyword">if</span> final<span class="token punctuation">:</span>
    q_value <span class="token operator">=</span> reward
  <span class="token keyword">else</span><span class="token punctuation">:</span>
    next_state_actions <span class="token operator">=</span> self<span class="token punctuation">.</span>qtable<span class="token punctuation">[</span>next_state<span class="token punctuation">]</span>
    next_state_max <span class="token operator">=</span> np<span class="token punctuation">.</span>amax<span class="token punctuation">(</span>next_state_actions<span class="token punctuation">)</span>

    q_value <span class="token operator">=</span> reward <span class="token operator">+</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>discount_factor <span class="token operator">*</span> next_state_max

  self<span class="token punctuation">.</span>qtable<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">[</span>action<span class="token punctuation">]</span> <span class="token operator">=</span> q_value</code></pre></div>
<p>The first two lines are just to ensure we have entries in the <code class="language-text">qtable</code> for the values at <code class="language-text">state</code> and <code class="language-text">next_state</code> as we are about to work with them.</p>
<p>The real hot sauce is in the very last line of the method. Here we can clearly see that we are mutating the rating of the action that we took on the state. This makes perfect sense because, again, we want to build up a map of rated actions for each state so that the agent can lookup the best possible action for each state when it plays the game. We call this value the <code class="language-text">q_value</code>.</p>
<p>This brings us to the question, how do we calculate the <code class="language-text">q_value</code>? This is in fact a difficult question to answer because if we think back about our rewards we remember that only the final winning or losing state gives pretty clear rewards of <code class="language-text">+1</code> or <code class="language-text">-1</code>. All the other moves that don’t immediately cause the game to be won or lost, such as playing <code class="language-text">-3</code> on a <code class="language-text">9</code>, just yield us a negative reward of <code class="language-text">-0.1</code>.</p>
<p>We somehow have to find a way to consider that when we calculate the <code class="language-text">q_value</code>. Remember that we want <code class="language-text">-3</code> to become an action with a high q-value for state <code class="language-text">9</code>. On the other hand we don’t want <code class="language-text">-3</code> to get a strong q-value for state <code class="language-text">6</code> as clearly playing <code class="language-text">-1</code> would be better and make us win the game from here.</p>
<p>In other words, what we need is a formular that not only takes the <strong>immediate reward</strong> into account but also the rewards that are <em>yet to follow</em> if we choose the given action from here. We call that the <strong>discounted future reward</strong>.</p>
<p>The formular for that is hiding in this innocently looking <code class="language-text">if</code> / <code class="language-text">else</code> block.</p>
<div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token keyword">if</span> final<span class="token punctuation">:</span>
  q_value <span class="token operator">=</span> reward
<span class="token keyword">else</span><span class="token punctuation">:</span>
  next_state_actions <span class="token operator">=</span> self<span class="token punctuation">.</span>qtable<span class="token punctuation">[</span>next_state<span class="token punctuation">]</span>
  next_state_max <span class="token operator">=</span> np<span class="token punctuation">.</span>amax<span class="token punctuation">(</span>next_state_actions<span class="token punctuation">)</span>

  q_value <span class="token operator">=</span> reward <span class="token operator">+</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>discount_factor <span class="token operator">*</span> next_state_max</code></pre></div>
<p>It says that if we reached a final state (won or lost) the <code class="language-text">q_value</code> should simply be the <code class="language-text">reward</code>. This makes a lot of sense because there is no future reward to expect from subsequent actions simply because there are no further actions possible from here.</p>
<p>If, however, we aren’t in a final state we do the following:</p>
<ol>
<li>We get the the highest q-value for the <code class="language-text">next_state</code>. Remember the <code class="language-text">next_state</code> is the state that we shifted to as we applied the <code class="language-text">action</code> to the <code class="language-text">state</code>. In other words, if the state was <code class="language-text">9</code> and the action was <code class="language-text">-3</code> the <code class="language-text">next_state</code> is <code class="language-text">6</code>. We don’t care which action of the <code class="language-text">next_state</code> has the highest q-value, we simply want get the value to use it in our formular.</li>
<li>We calculate the new <code class="language-text">q_value</code> for the <code class="language-text">action</code> of the <code class="language-text">state</code> as the <code class="language-text">reward</code> plus the highest q-value of the <code class="language-text">next_state</code> multiplied by some mysterious <code class="language-text">discount_factor</code>. Let’s ignore the <code class="language-text">discount_factor</code> for a moment and just think of it as being set to <code class="language-text">1</code>. Replacing our variables with concrete numbers this may boild down to <code class="language-text">q_value = -0.1 + 1 * 1</code>.</li>
</ol>
<p>By now, you may be wondering: “But how does that achieve the learning? There’s no guarantee that the q-value for the <code class="language-text">next_state</code> makes any sense?!”</p>
<p>You’re kinda right, the q-values won’t be perfect from the beginning. In fact, they may start out completely wrong. What this formular achieves though is that the values <strong>approximate</strong> and get more and more accurate with every iteration.</p>
<p>Getting back to the <code class="language-text">discount_factor</code>, this thing is less scary than we may think. The <code class="language-text">discount_factor</code> should be set between <code class="language-text">0</code> and <code class="language-text">1</code> and will influence how much we care about future rewards. A <code class="language-text">discount_factor</code> of <code class="language-text">0</code> means that we eleminate the righthand side of our formular entirely and don’t price in any future rewards. On the other hand, a <code class="language-text">discount_factor</code> of <code class="language-text">1</code> means that we strongly care about future rewards. A value of <code class="language-text">0.9</code> is usually a good start but since our task is completely deterministic we can also set it to <code class="language-text">1</code>. </p>
<p>The nice thing about using such a terrible simple toy task is that we can make this process perfectly visible. We can simply print out the Q-Table at different stages of the learning.</p>
<div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>qtable<span class="token punctuation">)</span></code></pre></div>
<p>This is what the Q-Table looks like after our agent played the game 10 times.</p>
<div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token punctuation">{</span>
    <span class="token comment"># actions go from +3, +2, + 1, -1, -2, -3</span>
    <span class="token number">0</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">2</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">3</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">4</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.673289</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">5</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># it is in favor of playing -2 from here. Stupid machine!</span>
    <span class="token number">6</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.7811</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">7</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">9</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">10</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">11</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">12</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">13</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">14</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Each line represents a state with the right-hand side being the array of q-values for each action starting at <code class="language-text">3</code> and ending at <code class="language-text">-3</code>. Notice how the machine “thinks” playing a <code class="language-text">-2</code> on a six would be the best move. We need to give it some more training cycles!</p>
<p>And after 100 games the Q-Table looks like this. By now, the agent has figured out how to play <strong>perfectly</strong>. Also notice that the entire Q-Table grow a bit as it figured out how to get to exotic states such as <code class="language-text">20</code> or <code class="language-text">-7</code>.</p>
<div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token punctuation">{</span>
    <span class="token comment"># actions go from +3, +2, + 1, -1, -2, -3</span>
    <span class="token number">0</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">0.7811</span><span class="token punctuation">,</span> <span class="token number">0.7811</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.09</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">0.7811</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">2</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.7811</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">3</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">4</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">0.7811</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">5</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># it figured out to play -1 from here</span>
    <span class="token number">6</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">7</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.7811</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">8</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.7811</span><span class="token punctuation">,</span> <span class="token number">0.7811</span><span class="token punctuation">,</span> <span class="token number">0.7811</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">9</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.673289</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">10</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.673289</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">11</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.199</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.56655611</span><span class="token punctuation">,</span> <span class="token number">0.7811</span><span class="token punctuation">,</span> <span class="token number">0.7811</span><span class="token punctuation">,</span> <span class="token number">0.89</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">12</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.09</span><span class="token punctuation">,</span> <span class="token number">0.673289</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.7811</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">13</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.09</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.09</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0.7811</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">14</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.09</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.09</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">15</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">16</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">17</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">18</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">19</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">20</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.7811</span><span class="token punctuation">,</span> <span class="token number">0.7811</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.09</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.09</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.89</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.09</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Notice that the Q-Table righfully favors playing <code class="language-text">-1</code> on a <code class="language-text">6</code> now. All the other moves seem to make sense as well.</p>
<h2>Playing with the trained agent</h2>
<p>It’s really cool and handy that we are able to validate the learning simply by looking at the Q-Table. But of course we don’t want to stop here. We want to truly measure wether our agent wins every single game.</p>
<p>Notice that our agent explored the game <em>entirely</em> by making random moves so far. This is only possible because the entire state space of our task is very small. For real world tasks this strategy wouldn’t take us very far and we have to refine the approach, but that’s a story for another post.</p>
<p>Still, to measure the performance of our agent, we have to be able to control wether it chooses actions randomly or based on Q-Table lookups.</p>
<p>A simple condition would do the trick but we can do a litle better and introduce a <code class="language-text">randomness_rate</code> to make fine grained adjustments so that, for instance, 70 % percent of the actions are choosen randomly and 30 % based on Q-Table lookups. This will already pave the way for other optimizations that we’ll be applying in a future post.</p>
<p>We just have to apply a tiny refactoring to our <code class="language-text">get_action</code> method to pass in the <code class="language-text">state</code> and then return an action randomly or based on a Q-Table lookup depending on the <code class="language-text">randomness_rate</code>.</p>
<div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token keyword">def</span> <span class="token function">get_action</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>should_go_random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">and</span> state <span class="token keyword">in</span> self<span class="token punctuation">.</span>qtable<span class="token punctuation">:</span>
    <span class="token keyword">return</span> self<span class="token punctuation">.</span>predict_action<span class="token punctuation">(</span>state<span class="token punctuation">)</span>

  <span class="token keyword">return</span> self<span class="token punctuation">.</span>get_random_action<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">should_go_random</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> self<span class="token punctuation">.</span>randomness_rate

<span class="token keyword">def</span> <span class="token function">get_random_action</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">predict_action</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>self<span class="token punctuation">.</span>qtable<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></div>
<p>A <code class="language-text">randomness_rate</code> of <code class="language-text">0</code> means that all actions should be based on Q-Table lookups (unless the Q-Table is lacking the entry) whereas a value of <code class="language-text">1</code> means that all actions should be choosen randomly. We can choose any value in between 0 and 1 such as <code class="language-text">0.3</code> so that 30 % of the actions are picked randomly.</p>
<p>With that in place we can first perform 100 epochs of training and then have the trained agent play 1000 games.</p>
<div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py">config <span class="token operator">=</span> AgentConfig<span class="token punctuation">(</span><span class="token punctuation">)</span>
config<span class="token punctuation">.</span>nb_epoch <span class="token operator">=</span> <span class="token number">100</span>
agent <span class="token operator">=</span> Agent<span class="token punctuation">(</span>config<span class="token punctuation">)</span>
agent<span class="token punctuation">.</span>play_and_train<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#play 1000 games on the trained agent</span>
config<span class="token punctuation">.</span>nb_epoch <span class="token operator">=</span> <span class="token number">1000</span>
agent<span class="token punctuation">.</span>randomness_rate <span class="token operator">=</span> <span class="token number">0</span>
agent<span class="token punctuation">.</span>play_and_train<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<p>We can see that it really wins every single game out of 1000.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">Epoch: 1000 Wins: 1000 (100.00%) Losses: 0 (0.00%)</code></pre></div>
<p>We can also see that it’s not always going for the straight path that we would expect it to take.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">Starting game #2

Current number is 10
Playing -1
Current number is 9
Playing -1
Current number is 8
Playing -3
You won!
##############################################</code></pre></div>
<p>However this is just becaue it was trained on 100 randomly played games. We could increase the number of games the agent performs for the training or fine tune our training strategy to fix that!</p>
<p>Play with the code, fork it and try solving other challenges!</p>
<h2>Wrapping up</h2>
<p>Phew! This was quite a long post. Congrats if you made it this far. We hope you had fun exploring the exciting field of Reinforement Learning. As mentioned in the beginning, this is part one in a series of articles on Reinforcement Learning. Stay tuned!</p></div></section><section class="thtrm-section"><div class="thtrm-section__heading thtrm-article-header thtrm-section-constrained u-distance-reset"><div class="thtrm-metabar thtrm-article-header__metabar"><div class="thtrm-metabar__item thtrm-topic u-color--grey"><div class="thtrm-media-short">Written by  <img alt="Author" src="https://avatars0.githubusercontent.com/u/521109?s=460&amp;v=4" class="thtrm-avatar"/><p class="thtrm-media-short__body"><a href="https://twitter.com/cburgdorf" class="u-link-plain">Christoph Burgdorf</a></p></div></div></div></div></section></main><footer class="thtrm-footer" role="contentinfo"><div class="thtrm-copyright"><p>© <!-- -->2024<!-- --> The thoughtram Blog Maintainers</p></div></footer><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" hidden=""><symbol viewBox="0 0 24 24" id="icon--chevron-right"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path><path d="M0 0h24v24H0z" fill="none"></path></symbol><symbol viewBox="0 0 24 24" id="icon--chevron-down"><path d="M7.41 7.84L12 12.42l4.59-4.58L18 9.25l-6 6-6-6z"></path><path d="M0-.75h24v24H0z" fill="none"></path></symbol><symbol viewBox="0 0 24 24" id="icon--menu"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path><path d="M0 0h24v24H0z" fill="none"></path></symbol></svg></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-51360648-2', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/machine-learning/2018/02/28/a-simple-guide-to-reinforcement-learning.html";window.webpackCompilationHash="0c5d630095500f933ccd";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-db11fdec89ef44788bcc.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-6a14d6c49d22aa388ff9.js"],"component---src-templates-category-js":["/component---src-templates-category-js-4376524bed80ab31f5c7.js"],"component---src-pages-404-js":["/component---src-pages-404-js-6a74e57e5569370f5224.js"],"component---src-pages-all-js":["/component---src-pages-all-js-7aa251af6b402c5bb6a7.js"],"component---src-pages-confirmation-thank-you-js":["/component---src-pages-confirmation-thank-you-js-e20b16d362e2acd832ef.js"],"component---src-pages-finish-newsletter-subscription-js":["/component---src-pages-finish-newsletter-subscription-js-9bc9dd352c7e25398f2b.js"],"component---src-pages-index-js":["/component---src-pages-index-js-34313bc70d6e2470e416.js"]};/*]]>*/</script><script src="/webpack-runtime-c99afa6b532686815600.js" async=""></script><script src="/app-db11fdec89ef44788bcc.js" async=""></script><script src="/commons-9a6c7e4a80f98fe6d0b9.js" async=""></script><script src="/styles-e0e38ca7b54561c3f057.js" async=""></script><script src="/component---src-templates-blog-post-js-6a14d6c49d22aa388ff9.js" async=""></script></body></html>