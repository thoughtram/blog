{"componentChunkName":"component---src-templates-blog-post-js","path":"/machine-learning/2016/09/23/beginning-ml-with-keras-and-tensorflow.html","webpackCompilationHash":"0c5d630095500f933ccd","result":{"data":{"site":{"siteMetadata":{"title":"Articles by thoughtram","authors":[{"id":"pascal_precht","name":"Pascal Precht","twitter":"PascalPrecht","img":"https://avatars2.githubusercontent.com/u/445106?s=460&v=4"},{"id":"christoph_burgdorf","name":"Christoph Burgdorf","twitter":"cburgdorf","img":"https://avatars0.githubusercontent.com/u/521109?s=460&v=4"},{"id":"dominic_elm","name":"Dominic Elm","twitter":"d3lm","img":"https://avatars0.githubusercontent.com/u/12571019?s=400&v=4"},{"id":"thomas_burleson","name":"Thomas Burleson","twitter":"thomasburleson","img":"https://avatars3.githubusercontent.com/u/210413?s=400&v=4"},{"id":"elvira_eulitz","name":"Elvira Eulitz","twitter":"ElviraEulitz","img":"https://avatars3.githubusercontent.com/u/29247040?s=400&v=4"},{"id":"maxim_koretskyi","name":"Maxim Koretskyi","twitter":"maxim_koretskyi","img":"https://avatars3.githubusercontent.com/u/6124091?s=400&v=4"}]}},"markdownRemark":{"id":"056bb7a6-b0ac-5240-9aeb-ad03661c0d22","excerpt":"This isn’t our typical kind of blog post. In fact this one is very special. It’s the beginning of our journey with a new shiny toy. Every now and then there…","html":"<p>This isn’t our typical kind of blog post. In fact this one is very special. It’s the beginning of our journey with a new shiny toy.</p>\n<p>Every now and then there comes a field of technology that strikes us as being especially exciting. With all the latest accomplishments in the field of artificial intelligence it’s really hard not to get excited about AI.</p>\n<p>Companies such as Google, NVIDIA or <a href=\"http://comma.ai/\">Comma.ai</a> are using neural networks to train cars that know how to drive themselves. Apps such as <a href=\"http://prisma-ai.com/\">PRISMA</a> are using AI to create artwork from photography that is inspired by real artists.</p>\n<p>We are happy to jump on this exciting journey and we are even happier to share our findings with you.</p>\n<h2>What’s all the buzz about AI and Machine Learning</h2>\n<p>If you like to learn about the difference between AI, Machine Learning and Deep Learning we recommend <a href=\"https://blogs.nvidia.com/blog/2016/07/29/whats-difference-artificial-intelligence-machine-learning-deep-learning-ai/\">this article</a> by NVIDIA. For the rest of this article we will use these terms interchangeably.</p>\n<p>So what exactly is exciting about AI? With traditional software engineering techniques we always define functions to solve problems. It doesn’t matter much if we are talking about <a href=\"https://en.wikipedia.org/wiki/Object-oriented_programming\">OOP</a>, <a href=\"https://en.wikipedia.org/wiki/Functional_programming\">FP</a>, <a href=\"https://en.wikipedia.org/wiki/Aspect-oriented_programming\">AOP</a> or anything else. At the end of the day <strong>we are writing code</strong> to solve problems.</p>\n<p>We are facing times where we tackle problems that seem to be too hard to solve with traditional programming techniques. For instance, self-driving cars are pretty much around the corner. Ever thought about what it takes to drive a car?</p>\n<p>With a fair amount of practice a human can drive a car. We aren’t particular good at it but we can manage to drive thousands of miles without ever getting into an accident.</p>\n<p>But can you imagine what it takes to write a software that drives a car? How do we make it slam on the breaks for a crossing kid but not bother about a plastic bag? How do we make it stay in lane if there are no lane markers or no sealed roads at all? How does it find its way through complicated temporary construction sites? What about hand signals from police officers or other drivers?</p>\n<p>Writing code to deal with such issues is really difficult. That’s why companies such as <a href=\"http://comma.ai/\">Comma.ai</a> and NVIDIA <a href=\"https://devblogs.nvidia.com/parallelforall/deep-learning-self-driving-cars/\">demonstrate</a> an alternative strategy to solve these problems. They use video recordings of real humans driving a car to actually teach a machine how to drive.</p>\n<p>That’s the point of Machine Learning. Feed the machine with enough data and it will <em>generate</em> the complex function for you. How does that work? Pretty much the same way as raising a child. Provide information and give feedback about how they are doing.</p>\n<p>The applications of AI seem infinite. <a href=\"https://www.instagram.com/prisma/\">PRISMA</a> is another astonishing demonstration of what AI can do that would be really difficult with traditional programming techniques. The PRISMA app takes photos and turns them into breath-taking pieces of art. Art in the style of Van Gogh, Monet or other exeptional painters.</p>\n<h2>Let’s get started</h2>\n<p>Getting started with Machine Learning can be quite intimidating at first. There’s a whole bunch of vocabulary: <a href=\"https://en.wikipedia.org/wiki/Artificial_neural_network\">neural networks</a>, <a href=\"https://en.wikipedia.org/wiki/Perceptron\">perceptrons</a>, neurons, activation functions and of course a lot of maths. There are plenty of <a href=\"http://neuralnetworksanddeeplearning.com/chap1.html\">great articles</a> about these kind of things so there’s no need for us to scare you with yet another intimidating article.</p>\n<p>We aren’t particular good at math. I’m sure we’re actually pretty bad at math. We are coders and tinkerers so that’s what we’re gonna do! Let’s build a neural network to solve a task!</p>\n<p>In a nutshell, a neural network is a system that is inspired by how we think the human brain works.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACSElEQVQ4y2NgwAGe/f/PCKKremf6LNpz+ldyUbUSiJ9e3sjEgA8wszCD6f7N/YwV0yrg4h7BUSCNgt7hcSZL95/L0DezkgHyWRiIAZN3TEYXYgNiARZWNhFkQRZWVkGoHGEQUxzD9+P/D5A3uYBYWERcUhRIsxa19IctO3jhf0RaniZIHZ+AoCAjI8Sl9fU+jPv2FYGDRkkJYXc5EJuvu7XuZlFf0RSQy2RVZEWBrpEEscNScmRnbz7kaWztwA8yj4WFlRdICzk5qcPDMjvbgRHZcfIghYvPLPaPK4uzBlnGxsGmwMDIKA1y7aLdp5jz6julYYoZGRnZ2diYhYFMkSlTIiUXL06SRTKLA8Pr3HzcqkBKS1pBSQBIs+fVd8WuPXHjf1B8mh5Ig7CYOJ+pqQIfkC23alXawVu3mvYB2YpASzKBdAHQSgYJkDmzDszyCs8NtwC5mJWNVYkR4kLOiSu2spV3TlEPiE1hhLqQk4ODBRS+YvPnx6tu3JilDQ5bPg4eUBCB2GVAbLn10dZrpZNLJ4EiREZZRhwYhiBNQj4R8dJT1+yyN7FxBIUdLzMLCzgMw8NNsKdHHn4eVhDtn+wvElUQxQqOZUYGfkFhUSlQSqnomhay+ujVP8BY1gK7RFBIAOhKcCw3NPgyAV0Idrm0tADC0P///6Pbww5yPisbmxByYAP5AlA53AAYo2C6ZFIJY3x5PFzc3tMf5CVh96BI44W7TyXrmlqCwpSVgVzwH5qX6ybN81x5+PKrlJJacF4GJiG8eRkAInSI7cZZ3EgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1024px Neural network svg\"\n        title=\"1024px Neural network svg\"\n        src=\"/static/edd5e1d8933b6e82959598588fa875a0/8ff1e/1024px-Neural_network.svg.png\"\n        srcset=\"/static/edd5e1d8933b6e82959598588fa875a0/9ec3c/1024px-Neural_network.svg.png 200w,\n/static/edd5e1d8933b6e82959598588fa875a0/c7805/1024px-Neural_network.svg.png 400w,\n/static/edd5e1d8933b6e82959598588fa875a0/8ff1e/1024px-Neural_network.svg.png 800w,\n/static/edd5e1d8933b6e82959598588fa875a0/3b243/1024px-Neural_network.svg.png 1024w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>It has connected neurons where information flows through. The information is then transformed by functions which apply so called weights. The idea is that the neural network finds the right weights for each neuron to eventually learn how to calculate the expected output.</p>\n<h2>TensorFlow, Keras and Python</h2>\n<p>There are a couple of JavaScript libraries that one can use to tinker with neural networks right in the browser. That’s pretty neat and in fact we also took our first baby steps with <a href=\"https://github.com/harthur-org/brain.js\">brain.js</a> and <a href=\"https://github.com/cazala/synaptic\">synaptic</a>. The demos are super cool!</p>\n<p>That said, you’re probably not gonna build a self driving car with one of these. Machine learning is a computational intensive task which means highly optimized frameworks written in system languages are better suited for the time being.</p>\n<p>As of now, <a href=\"https://www.tensorflow.org\">TensorFlow</a> seems to be most popular machine learning library. It’s written in C++ and can leverage GPUs very well. This is what you build a self-driving car with. Fortunately there are Python bindings so that we don’t have to deal with C++ directly. But even better, there’s a library called <a href=\"https://keras.io/\">Keras</a>, also written in Python, which creates a higher level API and uses TensorFlow as it’s backend. Let that sink in, we are going to use TensorFlow but with a much simpler API!</p>\n<p>None of us has much experience with Python but honestly that’s not a big issue. Python is quite simple and fun to learn. And after all the code we’re writing isn’t rocket sience. Remember, machine learning is all about having the machine doing the rocket sience for us!</p>\n<h2>Setting up your machine to become an AI engineer</h2>\n<div class=\"thtrm-alert\">\nYou may want to skip the hassle. Signup for a private beta account at <a href=\"http://get.machinelabs.ai\" target=\"_blank\">MachineLabs</a> to start writing machine learning code in the cloud within seconds. Zero setup.\n</div>\n<p>Now that we know which library to use, how do we actually set up our machine to get going? As with everything in life there are multiple options.</p>\n<p>The most obvious option would be to install TensorFlow and Keras directly on your machine. However, this may lead us down a path of upgrading dependencies such as Python or Numpy which in turn may be hard to upgrade if other software depends on them.</p>\n<p>We found using <a href=\"https://www.docker.com/\">docker</a> to be the simplest solution for us. Just grab a preconfigured image, spin off a container and start using Keras without any hassle. You haven’t used docker yet you say? Welcome to the club. We are like ten minutes ahead of you. We even created and published our very own <a href=\"https://hub.docker.com/r/thoughtram/keras/\">thoughtram/keras</a> docker image for you to give you an easy start.</p>\n<p>No excuses. Go and <a href=\"https://docs.docker.com/engine/installation/\">install docker</a> and then once that’s done, here is all you need to get going.</p>\n<p><strong>1. Create a directory on your machine where you want to put your code.</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">mkdir ~/ml-fun</code></pre></div>\n<p><strong>2. Create a docker container from our existing image</strong></p>\n<p>When we create a container from an image we can map a local directory (e.g <code class=\"language-text\">/Users/cburgdorf/ml-fun</code> to a directory inside our container (e.g <code class=\"language-text\">/ml-fun</code>). That way we can simply use our favourite editor from our host system to work on the code.</p>\n<p>We use the <code class=\"language-text\">--name</code> parameter to assign a name to our container that we can easily remember (e.g. <code class=\"language-text\">keras-playground</code>).</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">docker create -it -v ~/ml-fun:/projects/ml-fun\n              --name keras-playground thoughtram/keras</code></pre></div>\n<p><strong>3. The last thing left to do is to <em>start</em> the container</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">docker start keras-playground</code></pre></div>\n<h2>Let’s build our first neural network.</h2>\n<p>Whew. That was easy, wasn’t it? Let’s keep it simple and just build our very first neural network. No math required!</p>\n<p>Many people say that hand-writing recognition would be the <em>hello world</em> of machine learning but for now, let’s go even simpler than that. Let’s teach a neural network to understand the XOR gate. XOR represents the inequality function, i.e., the output is true if the inputs are not alike otherwise the output is false.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[0, 0] = 0\n[0, 1] = 1\n[1, 0] = 1\n[1, 1] = 0</code></pre></div>\n<p>Our job is to build a neural network that will predict the correct output for any of the four different inputs. Obviously, that isn’t a real world use case to throw a neural network at. This task is actually much simpler to solve with traditional programming techniques. Simply put all four states into a HashMap and map them to the desired result.</p>\n<p>That said, it’s pretty much the simplest thing we can put together in just a couple of lines to demonstrate how a neural network works.</p>\n<p>Let’s go and create a new file <code class=\"language-text\">keras_xor.py</code> in the directory that we mapped from our host machine into the container. We’ll put in the following code.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">from</span> keras<span class=\"token punctuation\">.</span>models <span class=\"token keyword\">import</span> Sequential\n<span class=\"token keyword\">from</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>core <span class=\"token keyword\">import</span> Activation<span class=\"token punctuation\">,</span> Dense\n\n<span class=\"token comment\"># the four different states of the XOR gate</span>\ntraining_data <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"float32\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># the four expected results in the same order</span>\ntarget_data <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"float32\"</span><span class=\"token punctuation\">)</span>\n\nmodel <span class=\"token operator\">=</span> Sequential<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> input_dim<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'sigmoid'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span>loss<span class=\"token operator\">=</span><span class=\"token string\">'mean_squared_error'</span><span class=\"token punctuation\">,</span>\n              optimizer<span class=\"token operator\">=</span><span class=\"token string\">'adam'</span><span class=\"token punctuation\">,</span>\n              metrics<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'binary_accuracy'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>training_data<span class=\"token punctuation\">,</span> target_data<span class=\"token punctuation\">,</span> nb_epoch<span class=\"token operator\">=</span><span class=\"token number\">500</span><span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span> model<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>training_data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>We don’t have to understand the code entirely just yet. The most important part is that we set up <em>training data</em> and <em>target data</em> according to how the XOR gate is supposed to work.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token comment\"># the four samples, each with two inputs</span>\ntraining_data <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"float32\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># the four expected results, each with one output</span>\ntarget_data <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"float32\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>To run our code we have to use <code class=\"language-text\">docker exec</code>, pass the name of the container and the command which we want to run <em>inside</em> the container.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">docker <span class=\"token keyword\">exec</span> <span class=\"token operator\">-</span>it keras<span class=\"token operator\">-</span>playground python <span class=\"token operator\">/</span>projects<span class=\"token operator\">/</span>ml<span class=\"token operator\">-</span>fun<span class=\"token operator\">/</span>keras_xor<span class=\"token punctuation\">.</span>py</code></pre></div>\n<p>Alternatively we could execute a <code class=\"language-text\">bash</code> session in the container and then invoke the script from there. Doesn’t matter much.</p>\n<p>Our output for this command should look somewhat like this.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nEpoch <span class=\"token number\">14</span><span class=\"token operator\">/</span><span class=\"token number\">500</span>\n0s <span class=\"token operator\">-</span> loss<span class=\"token punctuation\">:</span> <span class=\"token number\">0.2376</span> <span class=\"token operator\">-</span> binary_accuracy<span class=\"token punctuation\">:</span> <span class=\"token number\">0.5000</span>\nEpoch <span class=\"token number\">15</span><span class=\"token operator\">/</span><span class=\"token number\">500</span>\n0s <span class=\"token operator\">-</span> loss<span class=\"token punctuation\">:</span> <span class=\"token number\">0.2373</span> <span class=\"token operator\">-</span> binary_accuracy<span class=\"token punctuation\">:</span> <span class=\"token number\">0.7500</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nEpoch <span class=\"token number\">23</span><span class=\"token operator\">/</span><span class=\"token number\">500</span>\n0s <span class=\"token operator\">-</span> loss<span class=\"token punctuation\">:</span> <span class=\"token number\">0.2347</span> <span class=\"token operator\">-</span> binary_accuracy<span class=\"token punctuation\">:</span> <span class=\"token number\">0.7500</span>\nEpoch <span class=\"token number\">24</span><span class=\"token operator\">/</span><span class=\"token number\">500</span>\n0s <span class=\"token operator\">-</span> loss<span class=\"token punctuation\">:</span> <span class=\"token number\">0.2344</span> <span class=\"token operator\">-</span> binary_accuracy<span class=\"token punctuation\">:</span> <span class=\"token number\">1.0000</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> <span class=\"token number\">0</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">]</span>\n <span class=\"token punctuation\">[</span> <span class=\"token number\">1</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">]</span>\n <span class=\"token punctuation\">[</span> <span class=\"token number\">1</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">]</span>\n <span class=\"token punctuation\">[</span> <span class=\"token number\">0</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>The last four lines are the prediction for our input which was</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">training_data <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"float32\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>If you paid attention you’ll notice that <code class=\"language-text\">0, 1, 1, 0</code> is actually the correct result for our input according to how the XOR gate is defined.</p>\n<p>But what do all these lines above the prediction actually mean? Training a neural network happens in iterations so called <em>epochs</em>. After each epoch the neural network calculates how bad it performs, the so called <em>loss</em>. By adjusting the <em>weights</em> of the neurons the neural network tries to reduce the loss to effectively get better after each epoch.</p>\n<p>Because we’ve set <code class=\"language-text\">verbose=2</code> when we called <code class=\"language-text\">model.fit(...)</code> we log some info about how our neural network is doing after each epoch. Notice that there’s also a value called <code class=\"language-text\">binary_accuracy</code> in these logs. The accuracy tells us how good the predictions of our neural network are after each epoch. In that sense it’s like the opposite of the loss with the main difference being that the accuracy is a percentage based number where 0.75 means 75 % and 1.00 means 100 %. However, while the loss is actually used as a feedback mechanism to the network itself to learn, the accuracy is really just a metric for us to observe.</p>\n<p>From the accuracy that is logged after each epoch we can see that the predictions weren’t correct right from the beginning. That’s because our neural network starts off pretty dumb and keeps learning with each epoch.</p>\n<p>If you want to see what the prediction is like after the first epoch just change the value of <code class=\"language-text\">ng_epoch</code> to <code class=\"language-text\">1</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>training_data<span class=\"token punctuation\">,</span> target_data<span class=\"token punctuation\">,</span> nb_epoch<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Run again and you’ll see the predictions are really bad in the beginning.</p>\n<h2>Where do we go from here?</h2>\n<p>Our main intention for sharing our very own early ML experience is to make it easier for other newcomers to get started.</p>\n<p>This is really just the beginning. We’ve started to work on a little AI based game so expect more articles to follow soon.</p>","frontmatter":{"author":"christoph_burgdorf","title":"Beginning Machine Learning with Keras and TensorFlow","imageUrl":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEAf/EABUBAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAGBp2msFD//xAAZEAADAQEBAAAAAAAAAAAAAAAAAQISAxH/2gAIAQEAAQUClHSTJpjZVv3/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAABBQAAAAAAAAAAAAAAAAAAASAhMUH/2gAIAQEABj8ClCzGf//EABwQAAIDAAMBAAAAAAAAAAAAAAERACFBMVFhkf/aAAgBAQABPyF+HsZwC1bD2+jBcHQKhKJZUzBP/9oADAMBAAIAAwAAABAjz//EABYRAQEBAAAAAAAAAAAAAAAAAAARAf/aAAgBAwEBPxCrj//EABYRAQEBAAAAAAAAAAAAAAAAAAARAf/aAAgBAgEBPxCJr//EAB0QAQACAQUBAAAAAAAAAAAAAAEAEUEhMVFhcYH/2gAIAQEAAT8QoA4NciPTbeT55IK2LPpGiYAaX2xipHl7iLqKXtP/2Q==","aspectRatio":1.502,"src":"/static/6310f51baf8bea9b01dfdb9a87f7854a/30037/intro_in_ml.jpg","srcSet":"/static/6310f51baf8bea9b01dfdb9a87f7854a/10bdc/intro_in_ml.jpg 158w,\n/static/6310f51baf8bea9b01dfdb9a87f7854a/f4ab0/intro_in_ml.jpg 315w,\n/static/6310f51baf8bea9b01dfdb9a87f7854a/30037/intro_in_ml.jpg 630w,\n/static/6310f51baf8bea9b01dfdb9a87f7854a/9810d/intro_in_ml.jpg 945w,\n/static/6310f51baf8bea9b01dfdb9a87f7854a/ff2e4/intro_in_ml.jpg 1260w,\n/static/6310f51baf8bea9b01dfdb9a87f7854a/7e849/intro_in_ml.jpg 1502w","sizes":"(max-width: 630px) 100vw, 630px"}}},"date":"23 September 2016","summary":"With all the latest accomplishments in the field of artificial intelligence it's really hard not to get excited about AI. In this article we'll build our very first neural network.","categories":["machine-learning"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/machine-learning/2016/09/23/beginning-ml-with-keras-and-tensorflow.html","previous":{"fields":{"slug":"/angular/2016/09/16/angular-2-animation-important-concepts.html"},"frontmatter":{"date":"2016/09/16","title":"Angular Animations - Foundation Concepts","categories":["angular"]}},"next":{"fields":{"slug":"/angular/2016/10/10/resolving-route-data-in-angular-2.html"},"frontmatter":{"date":"2016/10/10","title":"Resolving route data in Angular","categories":["angular"]}}}}}