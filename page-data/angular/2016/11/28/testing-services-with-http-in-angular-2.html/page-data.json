{"componentChunkName":"component---src-templates-blog-post-js","path":"/angular/2016/11/28/testing-services-with-http-in-angular-2.html","webpackCompilationHash":"0c5d630095500f933ccd","result":{"data":{"site":{"siteMetadata":{"title":"Articles by thoughtram","authors":[{"id":"pascal_precht","name":"Pascal Precht","twitter":"PascalPrecht","img":"https://avatars2.githubusercontent.com/u/445106?s=460&v=4"},{"id":"christoph_burgdorf","name":"Christoph Burgdorf","twitter":"cburgdorf","img":"https://avatars0.githubusercontent.com/u/521109?s=460&v=4"},{"id":"dominic_elm","name":"Dominic Elm","twitter":"d3lm","img":"https://avatars0.githubusercontent.com/u/12571019?s=400&v=4"},{"id":"thomas_burleson","name":"Thomas Burleson","twitter":"thomasburleson","img":"https://avatars3.githubusercontent.com/u/210413?s=400&v=4"},{"id":"elvira_eulitz","name":"Elvira Eulitz","twitter":"ElviraEulitz","img":"https://avatars3.githubusercontent.com/u/29247040?s=400&v=4"},{"id":"maxim_koretskyi","name":"Maxim Koretskyi","twitter":"maxim_koretskyi","img":"https://avatars3.githubusercontent.com/u/6124091?s=400&v=4"}]}},"markdownRemark":{"id":"9aea06d1-2f9a-506f-a096-402d458c4681","excerpt":"Testing is important. That’s why Angular comes with a testing story out-of-the-box. Due to its dependency injection system, it’s fairly easy to mock…","html":"<p>Testing is important. That’s why Angular comes with a testing story out-of-the-box. Due to its dependency injection system, it’s fairly easy to mock dependencies, swap out Angular modules, or even create so called “shallow” tests, which enable us to test Angular components, without actually depending on their views (DOM). In this article we’re going to take a look at how to unit test a service that performs http calls, since there’s a little bit more knowledge required to make this work.</p>\n<h2>The Service we want to test</h2>\n<p>Let’s start off by taking a look at the service want to test. Sure, sometimes we actually want to do test-driven development, where we <strong>first</strong> create the test and <strong>then</strong> implement the actual service. However, from a learning point of view, it’s probably easier to grasp testing concepts when we first explore the APIs we want to test.</p>\n<p>At thoughtram, we’re currently recording screencasts and video tutorials, to provide additional content to our blog readers. In order to make all these videos more explorable, we’re also building a little application that lets users browse and watch them. The video data is hosted on Vimeo, so we’ve created a service that fetches the data from their API.</p>\n<p>Here’s what our <code class=\"language-text\">VideoService</code> roughly looks like:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Injectable<span class=\"token punctuation\">,</span> Inject <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/core'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">VIMEO_API_URL</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../config'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token string\">'rxjs/add/operator/map'</span><span class=\"token punctuation\">;</span>\n\n@<span class=\"token function\">Injectable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">VideoService</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token keyword\">private</span> http<span class=\"token punctuation\">:</span> Http<span class=\"token punctuation\">,</span> @<span class=\"token function\">Inject</span><span class=\"token punctuation\">(</span><span class=\"token constant\">VIMEO_API_URL</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">private</span> apiUrl</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">getVideos</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>http<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>apiUrl<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/videos</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span> <span class=\"token operator\">=></span> res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">getVideos()</code> returns an <code class=\"language-text\">Observable&lt;Array&lt;Video&gt;&gt;</code>. This is just an excerpt of the actual service we use in production. In reality, we cache the responses so we don’t peform an http request every single time we call this method. </p>\n<blockquote>\n<p><strong>Special Tip</strong>: If the <code class=\"language-text\">@Inject()</code> decorator is new to you, make sure to checkout this <a href=\"/angular/2015/09/17/resolve-service-dependencies-in-angular-2.html\">article</a></p>\n</blockquote>\n<p>To use this service in our application, we first need to create a provider for it on our application module, later we will use it in our tests:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">@<span class=\"token function\">NgModule</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  imports<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>HttpModule<span class=\"token punctuation\">]</span>\n  providers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>VideoService<span class=\"token punctuation\">]</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AppModule</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>Since the API returns an Observable, we need to subscribe to it to actually perform the http request. That’s why the call side of the method looks something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">VideoDashboard</span> <span class=\"token punctuation\">{</span>\n  \n  <span class=\"token keyword\">private</span> videos <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token keyword\">private</span> videoService<span class=\"token punctuation\">:</span> VideoService</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">ngOnInit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>videoService<span class=\"token punctuation\">.</span><span class=\"token function\">getVideos</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">videos</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>videos <span class=\"token operator\">=</span> videos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Notice how we’re passing a callback function to access the video data that is emitted by the Observable. We need to keep that in mind when testing these methods, because we can’t call them synchronously. To get an introduction to Observables in conjunction with Angular, make sure to read <a href=\"/angular/2016/01/06/taking-advantage-of-observables-in-angular2.html\">this article</a>.</p>\n<p>Alright, now that we know what the service we want to test looks like, let’s take a look at writing the tests.</p>\n<h2>Configuring a testing module</h2>\n<p>Before we can start writing test specs for our service APIs, we need to configure a testing module. This is needed because in our tests, we want to make sure that we aren’t performing actual http requests and use a <code class=\"language-text\">MockBackend</code> instead. Our goal is to isolate the test scenario as much as we can without touching any other <strong>real</strong> dependencies. Since NgModules configure injectors, a testing module allows us to do exactly that.</p>\n<p>When testing services or components that don’t have any dependencies, we can just go ahead an instantiate them manually, using their constructors like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should do something'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> service <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">VimeoService</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>service<span class=\"token punctuation\">.</span>foo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">'bar'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<blockquote>\n<p><strong>Special Tip</strong>: When testing components and services that don’t have any dependencies, we don’t necessarily need to create a testing module.</p>\n</blockquote>\n<p>To configure a testing module, we use Angular’s <code class=\"language-text\">TestBed</code>. <code class=\"language-text\">TestBed</code> is Angular’s primary API to configure and initialize environments for unit testing and provides methods for creating components and services in unit tests. We can create a module that overrides the actual dependencies with testing dependencies, using <code class=\"language-text\">TestBed.configureTestingModule()</code>. </p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> TestBed <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/core/testing'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'VideoService'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n    TestBed<span class=\"token punctuation\">.</span><span class=\"token function\">configureTestingModule</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This will create an NgModule for every test spec, as we’re running this code as part of a <code class=\"language-text\">beforeEach()</code> block. This is a <a href=\"https://jasmine.github.io/\">Jasmine</a> API. If you aren’t familiar with Jasmine, we highly recommend reading their documentation.</p>\n<p>Okay, but what does a configuration for such a testing module look like? Well, it’s an NgModule, so it has pretty much the same API. Let’s start with adding an <code class=\"language-text\">import</code> for <code class=\"language-text\">HttpModule</code> and a provider for <code class=\"language-text\">VideoService</code> like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> HttpModule <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/http'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> VideoService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./video.service'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">VIMEO_API_URL</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../config'</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span>\nTestBed<span class=\"token punctuation\">.</span><span class=\"token function\">configureTestingModule</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  imports<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>HttpModule<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span> provide<span class=\"token punctuation\">:</span> <span class=\"token constant\">VIMEO_API_URL</span><span class=\"token punctuation\">,</span> useValue<span class=\"token punctuation\">:</span> <span class=\"token string\">'http://example.com'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    VideoService\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<p>This configures an injector for our tests that knows how to create our <code class=\"language-text\">VideoService</code>, as well as the <code class=\"language-text\">Http</code> service. However, what we actually want is an <code class=\"language-text\">Http</code> service that doesn’t really perform http requests. How do we do that? It turns out that the <code class=\"language-text\">Http</code> service uses a <code class=\"language-text\">ConnectionBackend</code> to perform requests. If we find a way to swap that one out with a different backend, we get what we want.</p>\n<p>To give a better picture, here’s what the constructor of Angular’s <code class=\"language-text\">Http</code> service looks like:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">@<span class=\"token function\">Injectable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Http</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token parameter\"><span class=\"token keyword\">protected</span> _backend<span class=\"token punctuation\">:</span> ConnectionBackend<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">protected</span> _defaultOptions<span class=\"token punctuation\">:</span> RequestOptions</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>By adding an <code class=\"language-text\">HttpModule</code> to our testing module, providers for <code class=\"language-text\">Http</code>, <code class=\"language-text\">ConnectionBackend</code> and <code class=\"language-text\">RequestOptions</code> are already configured. However, using an NgModule’s <code class=\"language-text\">providers</code> property, we can <strong>override</strong> providers that have been introduced by other imported NgModules! This is where Angular’s dependency injection really shines!</p>\n<h3>Overriding the Http Backend</h3>\n<p>In practice, this means we need to create a new provider for <code class=\"language-text\">Http</code>, which instantiates the class with a different <code class=\"language-text\">ConnectionBackend</code>. Angular’s http module comes with a testing class <code class=\"language-text\">MockBackend</code>. <strong>That</strong> one not only ensures that no real http requests are performed, it also provides APIs to subscribe to opened connections and send mock responses.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> HttpModule<span class=\"token punctuation\">,</span> Http<span class=\"token punctuation\">,</span> BaseRequestOptions<span class=\"token punctuation\">,</span> XHRBackend <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/http'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> MockBackend <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/http/testing'</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span>\nTestBed<span class=\"token punctuation\">.</span><span class=\"token function\">configureTestingModule</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n  providers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">{</span> provide<span class=\"token punctuation\">:</span> XHRBackend<span class=\"token punctuation\">,</span> useClass<span class=\"token punctuation\">:</span> MockBackend <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<p>Wow, that was easy! We simply tell our injector to inject an instance of <code class=\"language-text\">MockBackend</code> whenever someone asks for an <code class=\"language-text\">XHRBackend</code>, which is what Angular’s Http module does behind the scenes.</p>\n<p>Awesome! We’ve created a testing module that uses an <code class=\"language-text\">Http</code> service with a <code class=\"language-text\">MockBackend</code>. Now let’s take a look at how to actually test our service.</p>\n<h2>Testing the service</h2>\n<p>When writing unit tests with Jasmine, every test spec is written as an <code class=\"language-text\">it()</code> block, where an assertion is made and then checked if that assertion is true or not. We won’t go into too much detail here, since there’s a lot of documentation for Jasmine out there. We want to test if our <code class=\"language-text\">VideoService</code> returns an <code class=\"language-text\">Observable&lt;Array&lt;Video&gt;&gt;</code>, so let’s start with the following <code class=\"language-text\">it()</code> statement:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'VideoService'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n  <span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'getVideos()'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should return an Observable&lt;Array&lt;Video>>'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// test goes here</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>We’ve also added another nested <code class=\"language-text\">describe()</code> block so we can group all tests that are related to that particular method we test. Okay, next we need to get an instance of our <code class=\"language-text\">VideoService</code>. Since we’ve created a testing module that comes with all providers for our services, we can use dependency injection to inject instances accordingly.</p>\n<h3>Injecting Services</h3>\n<p>Angular’s testing module comes with a helper function <code class=\"language-text\">inject()</code>, which injects service dependencies. This turns out to be super handy as we don’t have to take care of getting access to the injector ourselves. <code class=\"language-text\">inject()</code> takes a list of provider tokens and a function with the test code, and it <strong>returns</strong> a function in which the test code is executed. That’s why we can pass it straight to our spec and remove the anonymous function we’ve introduced in the first place:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> TestBed<span class=\"token punctuation\">,</span> inject <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/core/testing'</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span>\n<span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should return an Observable&lt;Array&lt;Video>>'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">inject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token comment\">/* provider tokens */</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token comment\">/* dependencies */</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// test goes here</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Cool, now we have all the tools we need to inject our services and write a test. Let’s go ahead an do exactly that. Once we have our service injected, we can call <code class=\"language-text\">getVideos()</code> and subscribe to the Observable it returns, to then test if the emitted value is the one we expect.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should return an Observable&lt;Array&lt;Video>>'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">inject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>VideoService<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">videoService</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n    videoService<span class=\"token punctuation\">.</span><span class=\"token function\">getVideos</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">videos</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>videos<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>videos<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Video 0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>videos<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Video 1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>videos<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Video 2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>videos<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Video 3'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>This test is not finished yet.</strong> Right now we’re having a test that expects some certain data that is going to be emitted by <code class=\"language-text\">getVideos()</code>, however, remember we’ve swapped out the <code class=\"language-text\">Http</code> backend so there’s no actual http request performed? Right, if there’s no request performed, this Observable won’t emit anything. We need a way to fake a response that is emitted when we subscribe to our Observable.</p>\n<h3>Mocking http responses</h3>\n<p>As mentioned earlier, <code class=\"language-text\">MockBackend</code> provides APIs to not only subscribe to http connections, it also enables us to send mock responses. What we want is, when the underlying <code class=\"language-text\">Http</code> service creates a connection (performs a request), send a fake http response with the data we’re asserting in our <code class=\"language-text\">getVideos()</code> subscription.</p>\n<p>We can subscribe to all opened http connections via <code class=\"language-text\">MockBackend.connections</code>, and get access to a <code class=\"language-text\">MockConnection</code> like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should return an Observable&lt;Array&lt;Video>>'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">inject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>VideoService<span class=\"token punctuation\">,</span> XHRBackend<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">videoService<span class=\"token punctuation\">,</span> mockBackend</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    mockBackend<span class=\"token punctuation\">.</span>connections<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">connection</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// This is called every time someone subscribes to</span>\n      <span class=\"token comment\">// an http call.</span>\n      <span class=\"token comment\">//</span>\n      <span class=\"token comment\">// Here we want to fake the http response.</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The next thing we need to do, is to make the connection send a response. We use <code class=\"language-text\">MockConnection.mockRespond()</code> for that, which takes an instance of Angular’s <code class=\"language-text\">Response</code> class. In order to define what the response looks like, we need to create <code class=\"language-text\">ResponseOptions</code> and define the response body we want to send (which is a string):</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">...</span>\n<span class=\"token keyword\">const</span> mockResponse <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  data<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span> id<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Video 0'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> id<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Video 1'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> id<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Video 2'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> id<span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Video 3'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nmockBackend<span class=\"token punctuation\">.</span>connections<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">connection</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  connection<span class=\"token punctuation\">.</span><span class=\"token function\">mockRespond</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Response</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ResponseOptions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    body<span class=\"token punctuation\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>mockResponse<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<p>Cool! With this code we now get a fake response inside that particular test spec. Even though it looks like we’re done, <strong>there’s one more thing we need to do</strong>.</p>\n<h3>Making the test asynchronous</h3>\n<p><s>Because the code we want to test is asynchronous, we need to inform Jasmine when the asynchronous operation is done, so it can run our assertions.</s></p>\n<p><a href=\"http://stackoverflow.com/questions/41273244/angular-testing-http-with-mockbackend-is-async-really-required\">Johannes Hoppe pointed out</a> that <code class=\"language-text\">MockConnection.mockRespond()</code> actually emits <strong>synchronously</strong>, not asynchronously, which means that the rest of this section is not needed for our particular test (Thank you Johannes!). However, it’s still a useful gem if we <strong>are</strong> writing tests that need asynchronous operations, read on!</p>\n<p>When testing asynchronous code, assertions might be executed later in another tick. That’s why we can explicitly tell Jasmine that we’re writing an asynchronous test. We just need to also tell Jasmine, when the actual code is “done”.</p>\n<p>Jasmine usually provides access to a function <code class=\"language-text\">done()</code> that we can ask for inside our test spec and then call it when we think our code is done. This looks something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should do something async'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">done</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">done</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Angular makes this a little bit more convenient. It comes with another helper function <code class=\"language-text\">async()</code> which takes a test spec and then runs <code class=\"language-text\">done()</code> behind the scenes for us. This is pretty cool, because we can write our test code as if it was synchronous!</p>\n<p>How does that work? Well… Angular takes advantage of a feature called Zones. It creates a “testZone”, which automatically figures out when it needs to call <code class=\"language-text\">done()</code>. If you havent heard about Zones before, we wrote about them <a href=\"/angular/2016/01/22/understanding-zones.html\">here</a> and <a href=\"/angular/2016/02/01/zones-in-angular-2.html\">here</a>.</p>\n<blockquote>\n<p><strong>Special Tip</strong>: Angular’s <code class=\"language-text\">async()</code> function executes test specs in a test zone!</p>\n</blockquote>\n<h2>The complete code</h2>\n<p>Putting it all together, here’s what the test spec for the <code class=\"language-text\">getVideos()</code> method looks like:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> TestBed<span class=\"token punctuation\">,</span> async<span class=\"token punctuation\">,</span> inject <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/core/testing'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  HttpModule<span class=\"token punctuation\">,</span>\n  Http<span class=\"token punctuation\">,</span>\n  Response<span class=\"token punctuation\">,</span>\n  ResponseOptions<span class=\"token punctuation\">,</span>\n  XHRBackend\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/http'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> MockBackend <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/http/testing'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> VideoService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./video.service'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">VIMEO_API_URL</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../config'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'VideoService'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n    TestBed<span class=\"token punctuation\">.</span><span class=\"token function\">configureTestingModule</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      imports<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>HttpModule<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      providers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span> provide<span class=\"token punctuation\">:</span> <span class=\"token constant\">VIMEO_API_URL</span><span class=\"token punctuation\">,</span> useValue<span class=\"token punctuation\">:</span> <span class=\"token string\">'http://example.com'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        VideoService<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span> provide<span class=\"token punctuation\">:</span> XHRBackend<span class=\"token punctuation\">,</span> useClass<span class=\"token punctuation\">:</span> MockBackend <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'getVideos()'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should return an Observable&lt;Array&lt;Video>>'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function\">inject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>VideoService<span class=\"token punctuation\">,</span> XHRBackend<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">videoService<span class=\"token punctuation\">,</span> mockBackend</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token keyword\">const</span> mockResponse <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n          data<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span> id<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Video 0'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span> id<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Video 1'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span> id<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Video 2'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span> id<span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Video 3'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        mockBackend<span class=\"token punctuation\">.</span>connections<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">connection</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          connection<span class=\"token punctuation\">.</span><span class=\"token function\">mockRespond</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Response</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ResponseOptions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            body<span class=\"token punctuation\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>mockResponse<span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        videoService<span class=\"token punctuation\">.</span><span class=\"token function\">getVideos</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">videos</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>videos<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>videos<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Video 0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>videos<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Video 1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>videos<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Video 2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>videos<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Video 3'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This pattern works for pretty much every test that involves http operations. Hopefully this gave you a better understanding of what <code class=\"language-text\">TestBed</code>, <code class=\"language-text\">MockBackend</code> and <code class=\"language-text\">async</code> are all about.</p>","frontmatter":{"author":"pascal_precht","title":"Testing Services with Http in Angular","imageUrl":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQBAgMF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAv/aAAwDAQACEAMQAAAB57aEhVMRD//EABoQAAMBAAMAAAAAAAAAAAAAAAABAhEDITH/2gAIAQEAAQUC40U8K9l9VTNP/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQMBAT8Bqv/EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/AYf/xAAWEAADAAAAAAAAAAAAAAAAAAAAIDH/2gAIAQEABj8CIv8A/8QAGRABAQEBAQEAAAAAAAAAAAAAAQARITGR/9oACAEBAAE/ISO5ywZosLlIo9fsrb//2gAMAwEAAgADAAAAEMT/AP/EABYRAQEBAAAAAAAAAAAAAAAAAAEAEf/aAAgBAwEBPxAwSL//xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQIBAT8QdMDf/8QAGxABAQEAAgMAAAAAAAAAAAAAAREAITFBUXH/2gAIAQEAAT8QRFS75mMkh4rGfUzcSOQHZ6syYZ+So5mf/9k=","aspectRatio":1.4992503748125936,"src":"/static/dc8523eace7fc4ec7b3dc8c3833ba693/30037/testing-services-with-http-in-angular-2.jpg","srcSet":"/static/dc8523eace7fc4ec7b3dc8c3833ba693/10bdc/testing-services-with-http-in-angular-2.jpg 158w,\n/static/dc8523eace7fc4ec7b3dc8c3833ba693/f4ab0/testing-services-with-http-in-angular-2.jpg 315w,\n/static/dc8523eace7fc4ec7b3dc8c3833ba693/30037/testing-services-with-http-in-angular-2.jpg 630w,\n/static/dc8523eace7fc4ec7b3dc8c3833ba693/9810d/testing-services-with-http-in-angular-2.jpg 945w,\n/static/dc8523eace7fc4ec7b3dc8c3833ba693/ff2e4/testing-services-with-http-in-angular-2.jpg 1260w,\n/static/dc8523eace7fc4ec7b3dc8c3833ba693/883ab/testing-services-with-http-in-angular-2.jpg 2000w","sizes":"(max-width: 630px) 100vw, 630px"}}},"date":"28 November 2016","summary":"Want to learn how to test services in Angular that have an Http dependency? Read more here!","categories":["angular"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/angular/2016/11/28/testing-services-with-http-in-angular-2.html","previous":{"fields":{"slug":"/machine-learning/2016/11/02/understanding-XOR-with-keras-and-tensorlow.html"},"frontmatter":{"date":"2016/11/02","title":"Understanding XOR with Keras and TensorFlow","categories":["machine-learning"]}},"next":{"fields":{"slug":"/angular/2016/12/27/angular-2-advance-testing-with-custom-matchers.html"},"frontmatter":{"date":"2016/12/27","title":"Testing Angular Directives with Custom Matchers","categories":["angular"]}}}}}