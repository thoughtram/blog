{"componentChunkName":"component---src-templates-blog-post-js","path":"/angular/2016/06/14/routing-in-angular-2-revisited.html","webpackCompilationHash":"0c5d630095500f933ccd","result":{"data":{"site":{"siteMetadata":{"title":"Articles by thoughtram","authors":[{"id":"pascal_precht","name":"Pascal Precht","twitter":"PascalPrecht","img":"https://avatars2.githubusercontent.com/u/445106?s=460&v=4"},{"id":"christoph_burgdorf","name":"Christoph Burgdorf","twitter":"cburgdorf","img":"https://avatars0.githubusercontent.com/u/521109?s=460&v=4"},{"id":"dominic_elm","name":"Dominic Elm","twitter":"d3lm","img":"https://avatars0.githubusercontent.com/u/12571019?s=400&v=4"},{"id":"thomas_burleson","name":"Thomas Burleson","twitter":"thomasburleson","img":"https://avatars3.githubusercontent.com/u/210413?s=400&v=4"},{"id":"elvira_eulitz","name":"Elvira Eulitz","twitter":"ElviraEulitz","img":"https://avatars3.githubusercontent.com/u/29247040?s=400&v=4"},{"id":"maxim_koretskyi","name":"Maxim Koretskyi","twitter":"maxim_koretskyi","img":"https://avatars3.githubusercontent.com/u/6124091?s=400&v=4"}]}},"markdownRemark":{"id":"8e06f62f-4b72-559d-8e2f-0b4e0dd47913","excerpt":"A long time ago we’ve written about routing in Angular and you’ve probably noticed that this article is deprecated due to many changes and rewrites that…","html":"<p>A long time ago we’ve written about <a href=\"/angular/2015/06/16/routing-in-angular-2.html\">routing in Angular</a> and you’ve probably noticed that this article is deprecated due to many changes and rewrites that happened in the router module of Angular. Just recently, the Angular team announced yet another version of the new router, in which they considered all the gathered feedback from the community to make it finally sophisticated enough, so it’ll fulfill our needs when we build applications with Angular.</p>\n<p>In this article we want to take a first look at the new and better APIs, touching on the most common scenarios when it comes to routing. We’re going to explore how to define routes, linking to other routes, as well as accessing route parameters. Let’s jump right into it!</p>\n<h2>Defining Routes</h2>\n<p>Let’s say we want to build a contacts application (in fact, this is what we do in our <a href=\"http://thoughtram.io/angular-master-class.html\">Angular Master Class</a>). Our contacts application shows a list of contacts, which is our <code class=\"language-text\">ContactsListComponent</code> and when we click on a contact, we navigate to the <code class=\"language-text\">ContactsDetailComponent</code>, which gives us a detailed view of the selected contact.</p>\n<p>A simplified version of <code class=\"language-text\">ContactsListComponent</code> could look something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  selector<span class=\"token punctuation\">:</span> <span class=\"token string\">'contacts-list'</span><span class=\"token punctuation\">,</span>\n  template<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    &lt;h2>Contacts&lt;/h2>\n    &lt;ul>\n      &lt;li *ngFor=\"let contact of contacts | async\">\n        {{contact.name}}\n      &lt;/li>\n    &lt;/ul>\n  </span><span class=\"token template-punctuation string\">`</span></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ContactsListComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Let’s not worry about how <code class=\"language-text\">ContactsListComponent</code> gets hold of the contact data. We just assume it’s there and we generate a list using <code class=\"language-text\">ngFor</code> in the template.</p>\n<p><code class=\"language-text\">ContactsDetailComponent</code> displays a single contact. Again, we don’t want to worry too much about how this component is implemented yet, but a simplified version could look something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  selector<span class=\"token punctuation\">:</span> <span class=\"token string\">'contacts-detail'</span><span class=\"token punctuation\">,</span>\n  template<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    &lt;h2>{{contact.name}}&lt;/h2>\n\n    &lt;address>\n      &lt;span>{{contact.street}}&lt;/span>\n      &lt;span>{{contact.zip}}&lt;/span>\n      &lt;span>{{contact.city}}&lt;/span>\n      &lt;span>{{contact.country}}&lt;/span>\n    &lt;/address>\n  </span><span class=\"token template-punctuation string\">`</span></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ContactsDetailComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Especially in <code class=\"language-text\">ContactsDetailComponent</code> there are a couple more things we need to consider when it comes to routing (e.g. how to link to that component, how to get access to URL parameters), but for now, the first thing we want to do is defining routes for our application.</p>\n<p>Defining routes is easy. All we have to do is to create a collection of <code class=\"language-text\">Route</code> which simply follows an object structure that looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">Route</span> <span class=\"token punctuation\">{</span>\n  path<span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> string<span class=\"token punctuation\">;</span>\n  component<span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> Type<span class=\"token operator\">|</span>string<span class=\"token punctuation\">;</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>As we can see, there are actually a couple more properties than just the three we show here. We’ll get to them later but this is all we need for now.</p>\n<p>Routes are best defined in a separate module to keep our application easy to test and also to make them easier to reuse. Let’s define routes for our components in a new module (maybe <code class=\"language-text\">contacts.routes.ts</code>?) so we can add them to our application in the next step:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ContactsListComponent <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./contacts-list'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ContactsDetailComponent <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./contacts-detail'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> ContactsAppRoutes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> path<span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> component<span class=\"token punctuation\">:</span> ContactsListComponent <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> path<span class=\"token punctuation\">:</span> <span class=\"token string\">'contacts/:id'</span><span class=\"token punctuation\">,</span> component<span class=\"token punctuation\">:</span> ContactsDetailComponent <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Pretty straight forward right? You might notice that the <code class=\"language-text\">path</code> property on our first <code class=\"language-text\">Route</code> definition is empty. This simply tells the router that this component should be loaded into the view by default (this is especially useful when dealing with child routes). The second route has a placeholder in its path called <code class=\"language-text\">id</code>. This allows us to have some dynamic value in our path which can later be accessed in the component we route to. Think of a contact id in our case, so we can fetch the contact object we want to display the details for.</p>\n<p>The next thing we need to do is to make these routes available to our application. In fact, we first need to make sure there’s a router in our application at all. We do that by importing Angular <code class=\"language-text\">RouterModule</code> into our application module. But not only that, we also configure it with our routes using <code class=\"language-text\">RouterModule.forRoot()</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> NgModule <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/core'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> BrowserModule <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/platform-browser'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> RouterModule <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/router'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ContactsListComponent <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./contacts-list'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ContactsDetailComponent <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./contacts-detail'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ContactsAppComponent <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./app.component'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ContactsAppRoutes <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./app.routes'</span><span class=\"token punctuation\">;</span>\n\n@<span class=\"token function\">NgModule</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  imports<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    BrowserModule<span class=\"token punctuation\">,</span>\n    RouterModule<span class=\"token punctuation\">.</span><span class=\"token function\">forRoot</span><span class=\"token punctuation\">(</span>ContactsAppRoutes<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  declarations<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    ContactsAppComponent<span class=\"token punctuation\">,</span>\n    ContactsListComponent<span class=\"token punctuation\">,</span>\n    ContactsDetailComponent\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  bootstrap<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>ContactsAppComponent<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>You might wonder where <code class=\"language-text\">ContactsAppComponent</code> comes from. Well, this is just the root component we use to bootstrap our application. In fact, it doesn’t really know anything about our <code class=\"language-text\">ContactsListComponent</code> and <code class=\"language-text\">ContactsDetailComponent</code>. We’re going to take a look at <code class=\"language-text\">ContactsAppComponent</code> in the next step though.</p>\n<h2>Displaying loaded components</h2>\n<p>Okay cool, our application now knows about these routes. The next thing we want to do is to make sure that the component we route to, is also displayed in our application. We still need to tell Angular “Hey, here’s where we want to display the thing that is loaded!“.</p>\n<p>For that, we take a look at <code class=\"language-text\">ContactsAppComponent</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  selector<span class=\"token punctuation\">:</span> <span class=\"token string\">'contacts-app'</span><span class=\"token punctuation\">,</span>\n  template<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    &lt;h1>Contacts App&lt;/h1>\n\n    &lt;!-- here's where we want to load\n      the detail and the list view -->\n  </span><span class=\"token template-punctuation string\">`</span></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ContactsAppComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Nothing special going on there. However, we need to change that. In order to tell Angular where to load the component we route to, we need to use a directive called <code class=\"language-text\">RouterOutlet</code>. Since we’ve imported <code class=\"language-text\">RouterModule</code> into our application module, this directive is automatically available to us. Let’s add a <code class=\"language-text\">&lt;router-outlet&gt;</code> tag to our component’s template so that loaded components are displayed accordingly.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n  template<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    &lt;h1>Contacts App&lt;/h1>\n    &lt;router-outlet>&lt;/router-outlet>\n  </span><span class=\"token template-punctuation string\">`</span></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ContactsAppComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Bootstrapping that app now displays a list of contacts! Awesome! The next thing we want to do is to link to <code class=\"language-text\">ContactsDetailComponent</code> when someone clicks on a contact.</p>\n<h2>Linking to other routes</h2>\n<p>With the new router, there are different ways to route to other components and routes. The most straight forward way is to simply use strings, that represent the path we want to route to. We can use a directive called <code class=\"language-text\">RouterLink</code> for that. For instance, if we want to route to <code class=\"language-text\">ContactsDetailComponent</code> and pass the contact id <code class=\"language-text\">3</code>, we can do that by simply writing:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">routerLink</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/contacts/3<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Details<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>This works perfectly fine. <code class=\"language-text\">RouterLink</code> takes care of generating an <code class=\"language-text\">href</code> attribute for us that the browser needs to make linking to other sites work. And since we’ve already imported <code class=\"language-text\">RouterModule</code>, we can simply go ahead and use that directive without further things to do.</p>\n<p>While this is great we realise very quickly that this isn’t the optimal way to handle links, especially if we have dynamic values that we can only represent as expressions in our template. Taking a look at our <code class=\"language-text\">ContactsListComponent</code> template, we see that we’re iterating over a list of contacts:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">*ngFor</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>let contact of contacts | async<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    {{contact.name}}\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>We need a way to evaluate something like <code class=\"language-text\">{% raw %}{{contact.id}}{% endraw %}</code> to generate a link in our template. Luckily, <code class=\"language-text\">RouterLink</code> supports not only strings, but also expressions! As soon as we want to use expressions to generate our links, we have to use an array literal syntax in <code class=\"language-text\">RouterLink</code>.</p>\n<p>Here’s how we could extend <code class=\"language-text\">ContactsListComponent</code> to link to <code class=\"language-text\">ContactsDetailComponent</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  selector<span class=\"token punctuation\">:</span> <span class=\"token string\">'contacts-list'</span><span class=\"token punctuation\">,</span>\n  template<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    &lt;h2>Contacts&lt;/h2>\n    &lt;ul>\n      &lt;li *ngFor=\"let contact of contacts | async\">\n        &lt;a [routerLink]=\"['/contacts', contact.id]\">\n          {{contact.name}}\n        &lt;/a>\n      &lt;/li>\n    &lt;/ul>\n  </span><span class=\"token template-punctuation string\">`</span></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ContactsListComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>There are a couple of things to note here:</p>\n<ul>\n<li>We use the bracket-syntax for <code class=\"language-text\">RouterLink</code> to make expressions work (if this doesn’t make sense to you, you might want to read out article on <a href=\"/angular/2015/08/11/angular-2-template-syntax-demystified-part-1.html\">Angular’s Template Syntax Demystified</a></li>\n<li>The expression takes an array where the first field is the segment that describes the path we want to route to and the second a dynamic value which ends up as route parameter </li>\n</ul>\n<p>Cool! We can now link to <code class=\"language-text\">ContactsDetailComponent</code>. However, this is only half of the story. We still need to teach <code class=\"language-text\">ContactsDetailComponent</code> how to access the route parameters so it can use them to load a contact object.</p>\n<h2>Access Route Parameters</h2>\n<p>A component that we route to has access to something that Angular calls the <code class=\"language-text\">ActivatedRoute</code>. An <code class=\"language-text\">ActivatedRoute</code> is an object that contains information about route parameters, query parameters and URL fragments. <code class=\"language-text\">ContactsDetailComponent</code> needs exactly that to get the id of a contact. We can inject the <code class=\"language-text\">ActivatedRoute</code> into <code class=\"language-text\">ContactsDetailComponent</code>, by using Angular’s DI like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ActivatedRoute <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/router'</span><span class=\"token punctuation\">;</span>\n\n@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  selector<span class=\"token punctuation\">:</span> <span class=\"token string\">'contacts-detail'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ContactsDetailComponent</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token keyword\">private</span> route<span class=\"token punctuation\">:</span> ActivatedRoute</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">ActivatedRoute</code> comes with a <code class=\"language-text\">params</code> property which is an <code class=\"language-text\">Observable</code>. To access the contact id, all we have to do is to subscribe to the parameters <code class=\"language-text\">Observable</code> changes. Let’s say we have a <code class=\"language-text\">ContactsService</code> that takes a number and returns an observable that emits a contact object. Here’s what that could look like:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ActivatedRoute <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/router'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ContactsService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../contacts.service'</span><span class=\"token punctuation\">;</span>\n\n@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  selector<span class=\"token punctuation\">:</span> <span class=\"token string\">'contacts-detail'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ContactsDetailComponent</span> <span class=\"token punctuation\">{</span>\n\n  contact<span class=\"token punctuation\">:</span> Contact<span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token parameter\"><span class=\"token keyword\">private</span> route<span class=\"token punctuation\">:</span> ActivatedRoute<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">private</span> contactsService<span class=\"token punctuation\">:</span> ContactsService</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">ngOnInit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>route<span class=\"token punctuation\">.</span>params\n      <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">params</span> <span class=\"token operator\">=></span> params<span class=\"token punctuation\">[</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">id</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>contactsService\n          <span class=\"token punctuation\">.</span><span class=\"token function\">getContact</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">contact</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>contact <span class=\"token operator\">=</span> contact<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Oh, look what we have here! Notice that we’re nesting two <code class=\"language-text\">subscribe()</code> calls? This is usually an indicator that we can refactor our code using <code class=\"language-text\">flatMap()</code>, or even better <code class=\"language-text\">switchMap()</code>, as we’re calling an asynchronous API and want to deal with out-of-order responses.</p>\n<p>Let’s refactor our code:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">ngOnInit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>route<span class=\"token punctuation\">.</span>params\n    <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">params</span> <span class=\"token operator\">=></span> params<span class=\"token punctuation\">[</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">switchMap</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">id</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>contactsService<span class=\"token punctuation\">.</span><span class=\"token function\">getContact</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">contact</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>contact <span class=\"token operator\">=</span> contact<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Much better! But are observables really required to get hold of our <code class=\"language-text\">id</code> parameter?</p>\n<h2>Using Router Snapshots</h2>\n<p>Sometimes we’re not interested in future changes of a route parameter. All we need is this contact id and once we have it, we can provide the data we want to provide. In this case, an Observable can bit a bit of an overkill, which is why the router supports snapshots. A snapshot is simply a snapshot representation of the activated route. We can access the <code class=\"language-text\">id</code> parameter of the route using snapshots like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">...</span>\n  <span class=\"token function\">ngOnInit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>contactsService\n        <span class=\"token punctuation\">.</span><span class=\"token function\">getContacts</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>route<span class=\"token punctuation\">.</span>snapshot<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">contact</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>contact <span class=\"token operator\">=</span> contact<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<p>Check out the running example <a href=\"http://plnkr.co/edit/I9qFkO?p=preview\">right here</a>!</p>\n<h2>ParamMap since Angular version 4.x</h2>\n<p>Because router parameters can either have single or multiple values, the params type should actually be <code class=\"language-text\">{ [key: string]: string | string[] }</code>. We as developers usually know if we expect a single or multiple values. That’s why since Angular version 4.x, there’s a new <code class=\"language-text\">ParamMap</code> interface that we can use to decide whether we we’re interested in a single value (<code class=\"language-text\">ParamMap.get()</code>) or multiple values (<code class=\"language-text\">ParamMap.getAll()</code>).</p>\n<p>The above code can therefore be rewritten as:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">...</span>\n  <span class=\"token function\">ngOnInit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>contactsService\n        <span class=\"token punctuation\">.</span><span class=\"token function\">getContacts</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>route<span class=\"token punctuation\">.</span>snapshot<span class=\"token punctuation\">.</span>paramMap<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">contact</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>contact <span class=\"token operator\">=</span> contact<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<p>This feature has been introduce in <a href=\"https://github.com/angular/angular/commit/a755b71\">this commit</a>, go ahead and take a look for more information.</p>\n<p>Of course, there’s way more to cover when it comes to routing. We haven’t talked about secondary routes or <strong>guards</strong> yet, but we’ll do that in our upcoming articles. Hopefully this one gives you an idea of what to expect from the new router. For a more in-depth article on the underlying architecture, you might want to read Victor’s <a href=\"http://victorsavkin.com/post/145672529346/angular-router\">awesome blog</a>!</p>","frontmatter":{"author":"pascal_precht","title":"Routing in Angular revisited","imageUrl":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAQGAwX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAWXZ7TL3ycI//8QAGhAAAgMBAQAAAAAAAAAAAAAAAAIBAxEQEv/aAAgBAQABBQJb1IeuT1Wabz//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAAIf/aAAgBAgEBPwGq/8QAGRABAAIDAAAAAAAAAAAAAAAAAQAyICKR/9oACAEBAAY/AthliWO4f//EABoQAQACAwEAAAAAAAAAAAAAAAEAERAxYYH/2gAIAQEAAT8hfodG5qvZxYcXL4T/2gAMAwEAAgADAAAAEKMf/8QAFREBAQAAAAAAAAAAAAAAAAAAACH/2gAIAQMBAT8QiP/EABcRAAMBAAAAAAAAAAAAAAAAAAABEUH/2gAIAQIBAT8QT0Uf/8QAHBABAAICAwEAAAAAAAAAAAAAAQARIWExcaHB/9oACAEBAAE/EGw0I8Tku1dUvsRaRTWMaKDUYZz3EX8p/9k=","aspectRatio":1.5,"src":"/static/328d8e9d0afe8a3fc8c4d1b38a7353c4/30037/routing-in-angular-2-revisited.jpg","srcSet":"/static/328d8e9d0afe8a3fc8c4d1b38a7353c4/10bdc/routing-in-angular-2-revisited.jpg 158w,\n/static/328d8e9d0afe8a3fc8c4d1b38a7353c4/f4ab0/routing-in-angular-2-revisited.jpg 315w,\n/static/328d8e9d0afe8a3fc8c4d1b38a7353c4/30037/routing-in-angular-2-revisited.jpg 630w,\n/static/328d8e9d0afe8a3fc8c4d1b38a7353c4/9810d/routing-in-angular-2-revisited.jpg 945w,\n/static/328d8e9d0afe8a3fc8c4d1b38a7353c4/ff2e4/routing-in-angular-2-revisited.jpg 1260w,\n/static/328d8e9d0afe8a3fc8c4d1b38a7353c4/2a5e2/routing-in-angular-2-revisited.jpg 1500w","sizes":"(max-width: 630px) 100vw, 630px"}}},"date":"14 June 2016","summary":"Learn how to implement basic routing in your Angular application using the latest and greatest APIs!","categories":["angular"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/angular/2016/06/14/routing-in-angular-2-revisited.html","previous":{"fields":{"slug":"/angular/2016/06/08/component-relative-paths-in-angular-2.html"},"frontmatter":{"date":"2016/06/08","title":"Component-Relative Paths in Angular","categories":["angular"]}},"next":{"fields":{"slug":"/angular/2016/06/16/cold-vs-hot-observables.html"},"frontmatter":{"date":"2016/06/16","title":"Cold vs Hot Observables","categories":["angular"]}}}}}