{"componentChunkName":"component---src-templates-blog-post-js","path":"/angular/2017/07/26/a-web-animations-deep-dive-with-angular.html","webpackCompilationHash":"0c5d630095500f933ccd","result":{"data":{"site":{"siteMetadata":{"title":"Articles by thoughtram","authors":[{"id":"pascal_precht","name":"Pascal Precht","twitter":"PascalPrecht","img":"https://avatars2.githubusercontent.com/u/445106?s=460&v=4"},{"id":"christoph_burgdorf","name":"Christoph Burgdorf","twitter":"cburgdorf","img":"https://avatars0.githubusercontent.com/u/521109?s=460&v=4"},{"id":"dominic_elm","name":"Dominic Elm","twitter":"d3lm","img":"https://avatars0.githubusercontent.com/u/12571019?s=400&v=4"},{"id":"thomas_burleson","name":"Thomas Burleson","twitter":"thomasburleson","img":"https://avatars3.githubusercontent.com/u/210413?s=400&v=4"},{"id":"elvira_eulitz","name":"Elvira Eulitz","twitter":"ElviraEulitz","img":"https://avatars3.githubusercontent.com/u/29247040?s=400&v=4"},{"id":"maxim_koretskyi","name":"Maxim Koretskyi","twitter":"maxim_koretskyi","img":"https://avatars3.githubusercontent.com/u/6124091?s=400&v=4"}]}},"markdownRemark":{"id":"d635bdb0-1c73-58b6-b24a-734f9b2bb726","excerpt":"Motion is an important aspect when building modern web applications. In fact, it’s important for all kinds of software products that involve user interfaces and…","html":"<p>Motion is an important aspect when building modern web applications. In fact, it’s important for all kinds of software products that involve user interfaces and interactions. Good user interfaces with well-designed animations help users understand the flow between two states. Imagine we are on a simple website that only has one button. We click that button and without any motion a box appears. Isn’t that boring? Also, we as a user might think that the box appeared because of our action. However, it could have been the result of something else like an http call in the background. In addition, animations can be used to make the user interface more snappy and responsive. They also explain changes in the arrangement of elements on the screen as some user actions may change the UI.</p>\n<p>This could easily drift off into a whole new discussion about user experience and why motion matters. The bottom line is that motion not only makes a site more usable but also more fun. They tell stories, add a perceptible time dimension and improve the overall user experience of applications.</p>\n<p>In this article we’ll briefly look at different ways to approach motion in modern web applications, specifically imperative and declarative animations. We’ll cover the basics of CSS and JavaScript animations before diving diving into a sophisticated animation in the context of an Angular application.</p>\n<p>Let’s start with a deeper breath of how animations in the web generally work.</p>\n<h2>Understanding state transitions</h2>\n<p>With animations we aim to guide users between views so they feel comfortable using the site, draw attention to some parts of application, increase spacial awareness, indicate if data is being loaded, and probably the most important point - <strong>smoothly transition users between states</strong>. All this could be achieved by using CSS (declarative) or JavaScript (mostly imperative) to animate certain elements within your page.</p>\n<p>What’s a transition you may ask. Very good question! The <a href=\"https://en.oxforddictionaries.com/definition/transition\">Oxford Dictionary</a> defines a transition as follows:</p>\n<blockquote>\n<p>The process or a period of changing from one state or condition to another.</p>\n</blockquote>\n<p>Applied to animations, a transition is the visualization of some state changing over time. A <strong>state</strong> could be a person sitting at the airport waiting for his plane to be boarded. It’s a condition something or someone is in at a specific point in time. A button on website could have 4 different states - <code class=\"language-text\">idle</code>, <code class=\"language-text\">hover</code>, <code class=\"language-text\">focus</code> and <code class=\"language-text\">pressed</code>, where the latter is a combination of <code class=\"language-text\">focus</code> and <code class=\"language-text\">active</code>. We could use a finite state machine or simply state transition system to visualize how it works:</p>\n<p><img src=\"/c508c47a09fb305f757a37f706488aed/button_state_machine.gif\" alt=\"button state machine\"></p>\n<p>The point is, a “system” or some element on the page can have multiple states. Instead of simply going from state A to B, we’d like to interpolate the values in between. Therefore, we can listen for <em>state changes</em> and act accordingly using animated transitions from one state to another.</p>\n<h2>What can we use to animate our UI?</h2>\n<p>Nowadays, with modern browsers in mind, we have many technologies at hand to animate our UI including CSS3 or JavaScript. The power of CSS animations (transitions or keyframes) is that they allow animating most HTML elements without using JavaScript. CSS animations are also quite fast and allow hardware acceleration. However, there are some limitations to this approach. For instance, you can’t animate an element along a certain path, use physics-based motion or animate the scroll position with CSS alone. While CSS animations are pretty good for simple transitions between states (e.g. hover-effects), JavaScript-based animations provide far more flexibility.</p>\n<p>As a matter of fact, we can take advantage of the same hardware acceleration in JavaSript too. It’s as easy as setting a CSS property with a 3D characteristic, such as <code class=\"language-text\">translate3d()</code> or <code class=\"language-text\">matrix3d()</code>. This will push the particular element onto another layer which is then processed by the GPU. The GPU itself is highly optimized for moving pixels making it much for effective for animations compared to the CPU. For more information, check out this great article by Paul Lewis and Paul Irish on <a href=\"https://www.html5rocks.com/en/tutorials/speed/high-performance-animations/\">high performance animations</a>.</p>\n<p>CSS animations do not require any 3rd party libraries. However, there are some tools that make your life much easier, for example libraries that provide pre-defined keyframe animations like <a href=\"https://github.com/daneden/animate.css\">Animate.css</a>.</p>\n<p>Looking at JavaScript, we can either use vanilla JavaScript or jQuery to animate our UI. Maintaining vanilla JavaScript animations and manually setting up elements on the stage could be quite a hassle. That’s one reason why many of us switched to jQuery at some point. jQuery makes it easy to query an element on the page. Then, in order to add motion, all we do is to call <code class=\"language-text\">.animate()</code> and specify the properties (e.g. opacity or transform) we’d like to animate. Here is how we’d move a <code class=\"language-text\">div</code> to the right by <code class=\"language-text\">200px</code> animating its <code class=\"language-text\">left</code> property:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    left<span class=\"token punctuation\">:</span> <span class=\"token string\">'200px'</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'slow'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>While this works, it’s better to stick with either the <code class=\"language-text\">transform</code> or <code class=\"language-text\">opacity</code> property as those are the only things a browser can animate cheaply. Note that we use the string <code class=\"language-text\">slow</code> to specify the duration of the animation. It is an equivalent for supplying a duration of <code class=\"language-text\">600</code> milliseconds.</p>\n<p>Turns out there is another cool kid on the block called <a href=\"https://greensock.com/\">GreenSock</a>, a high-performance HTML5 animation library for the modern web. It allows us to define simple animations as well as complex timeline compositions, drag and drop features or even smoothly morph any SVG shape into any other shape. According to GreenSock, GSAP performs 20 times faster than jQuery. If you’d like to see this in action, there is a <a href=\"https://greensock.com/js/speed.html\">speed comparison</a> to stress test the performance of various common JavaScript libraries including jQuery, GSAP or Web Animations.</p>\n<p>Let’s create the same animation as before, but this time using GSAP. More specifically we’ll use <a href=\"https://greensock.com/tweenlite\">TweenLite</a>, a lightweight animation tool that serves as the foundation of GSAP.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> button <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nbutton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  TweenLite<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    left<span class=\"token punctuation\">:</span> <span class=\"token number\">200</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<blockquote>\n<p>Note that the code above requires a plugin called <a href=\"https://greensock.com/CSSPlugin\">CSSPlugin</a>. This plugin allows us to animate almost any CSS property.</p>\n</blockquote>\n<p>When working with frontend frameworks like Angular it could be a whole new story as some of them handle animations differently.</p>\n<p>That doesn’t mean it’s not using some of the core concepts under the hood. They often come with their own animation system. Take Angular’s animation system for example, that is built on top of the Web Animations API (WAAPI). It’s fairly new and currently being implemented in Chrome and Firefox. It’s goal is to unite CSS, JS and SVG. More specifically, it aims to provide the power of CSS performance, add the benefits and flexibility of JS and SVG as well as leave the fundamental work to the browser without the need for additional dependencies.</p>\n<p>If you want to learn more about the Web Animation API, check out <a href=\"http://danielcwilson.com/blog/2015/07/animations-intro/\">this</a> series of posts which goes a lot more into detail while covering advanced features like running multiple animations in parallel or in sequence, animating elements along a motion path or controlling animations using the <code class=\"language-text\">AnimationPlayer</code>.</p>\n<p>Here is a snippet showing the WAAPI in action:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> button <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> wrapper <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nwrapper<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>position <span class=\"token operator\">=</span> <span class=\"token string\">'relative'</span><span class=\"token punctuation\">;</span>\n\nbutton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  wrapper<span class=\"token punctuation\">.</span><span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span> left<span class=\"token punctuation\">:</span> <span class=\"token function\">getComputedStyle</span><span class=\"token punctuation\">(</span>elem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>left <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> left<span class=\"token punctuation\">:</span> <span class=\"token string\">'200px'</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> duration<span class=\"token punctuation\">:</span> <span class=\"token number\">600</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">/* and more like easing, delay etc. */</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Remember, the WAAPI is still a work in progress and things like additive animations are not fully supported yet. That’s why we use <code class=\"language-text\">getComputedStyle()</code> to calculate the very first <code class=\"language-text\">KeyframeEffect</code>. A <code class=\"language-text\">KeyframeEffect</code> is used to specify the values for the properties we’d like to animate. Each effect represents one keyframe and the values are basically interpolated over time. In other words, the array is a collection of keyframes. Here is an equivalent CSS keyframe animation:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">@keyframes moveToRight <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">from</span> <span class=\"token punctuation\">{</span>\n    left<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>px<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  to <span class=\"token punctuation\">{</span>\n    left<span class=\"token punctuation\">:</span> <span class=\"token number\">200</span>px<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\ndiv <span class=\"token punctuation\">{</span>\n  position<span class=\"token punctuation\">:</span> relative<span class=\"token punctuation\">;</span>\n  animation<span class=\"token punctuation\">:</span> moveToRight <span class=\"token number\">600</span>ms forwards<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Similar to the WAAPI, we also need to set the initial value when animating the <code class=\"language-text\">left</code> property. This is not needed if we were translating the element on the X-axis to another location via its <code class=\"language-text\">transform</code> property. With CSS keyframe animations we normally define when the change will happen with either percentage values or the keywords <code class=\"language-text\">from</code> and <code class=\"language-text\">to</code>, which are the same as <code class=\"language-text\">0%</code> and <code class=\"language-text\">100%</code>.</p>\n<p>We do this with the WAAPI by defining an <code class=\"language-text\">offset</code> for each set of property values (keyframe). Keyframes without any offset will have offsets computed, e.g. the first keyframe has an offset of <code class=\"language-text\">0</code>, the last will be <code class=\"language-text\">1</code>.</p>\n<p>So far, we have seen a little bit of CSS and JavaScript animations and how to leverage them to animate parts of our application. In the next section we’ll look at at a specific case study implementing a real-world user profile animation. The goal is to implement the exact same animation both imperatively and declaratively using GSAP and Angular’s built-in animation system. Yes, there’s going to be a lot of Angular!</p>\n<h2>Case study: An animated modal-based user profile</h2>\n<p>Enough about theory! Let’s build a simple modal-based user profile and apply animations to improve the user experience and draw focused-attention to the dialog.</p>\n<p>Here’s a preview of what we are going to build:</p>\n<p><img src=\"/9e1929ff8a274bad3ef09aebd3610f07/animation_preview.gif\" alt=\"animation preview\"></p>\n<p>Our application is going to be very simple and mainly consists of two components:</p>\n<ul>\n<li>DashboardComponent</li>\n<li>ProfileDetailsComponent</li>\n</ul>\n<p>The <code class=\"language-text\">DashboardComponent</code> is the entry point (root component) of our application. It contains almost no logic and merely represents a wrapper composing the <code class=\"language-text\">ProfileDetailsComponent</code>.</p>\n<p>Inside the <code class=\"language-text\">DashboardComponent</code> we initialize the data for the user profile and toggle the visibility of the dialog. An <code class=\"language-text\">ngIf</code> will then show and hide the template. This is important for our animation because we use it as a trigger.</p>\n<p>Here is the template of the <code class=\"language-text\">DashboardComponent</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>header</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>title<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Dashboard<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>image-container<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">(click)</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>toggleProfileDetails()<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">data-tooltip</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>Profile<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>profile-button<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>...<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>header</span><span class=\"token punctuation\">></span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>profile-details</span> <span class=\"token attr-name\">[user]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>user<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">*ngIf</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>showProfileDetails<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>profile-details</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>So far so good. Let’s look at the template of <code class=\"language-text\">ProfileDetailsComponent</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>wrapper<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>header</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>profile-image-wrapper<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>profile-image-border<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>profile-image<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>...<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>profile-header-content<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>username<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>{{ user.name }}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>username-title<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>{{ user.title }}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>header</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>main</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stats<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stats-item<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stats-icon icon-eye<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span><span class=\"token punctuation\">></span></span>{{ user.views }}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stats-item<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stats-icon icon-location<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span><span class=\"token punctuation\">></span></span>{{ user.location }}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stats-item<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stats-icon icon-heart<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span><span class=\"token punctuation\">></span></span>{{ user.hearts }}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>main</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>To achieve the desired animation we need to set some initial CSS properties to enable 3D-space for the children elements inside <code class=\"language-text\">ProfileDetailsComponent</code>. We do that by setting the <code class=\"language-text\">perspective</code> on the <code class=\"language-text\">host</code> element. CSS host selectors are a great way to apply styles without introducing an additional wrapper element.</p>\n<p>Nonetheless, for our animation we still need a wrapper element because the <code class=\"language-text\">perspective</code> property doesn’t affect how the host element is rendered; it simply enables 3D-space for children elements.</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:host</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">perspective</span><span class=\"token punctuation\">:</span> 500px<span class=\"token punctuation\">;</span>\n  ...\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.wrapper</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transform-origin</span><span class=\"token punctuation\">:</span> top center<span class=\"token punctuation\">;</span>\n  ...\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Again, the perspective only affects <strong>children</strong> elements and only those that are transformed in a three-dimensional space, e.g. rotation about X-axis or translation along Z-axis. The value for the perspective determines the strength of the 3D-effect. In other words, it describes the distance between the object and the viewer. Therefore, if the value is very small the effect will be quite impressive as we are extremely close to the object. On the other hand, if the value is high the distance between the object and the viewer will be large and therefore the animation looks rather subtle. That said, we need to set the <code class=\"language-text\">perspective</code> property in order to achieve 3D-effects.</p>\n<p>In addition, we have to specify a point of origin for our upcoming transformation. By default the point of origin is exactly the center of any element. The rest is just simple styling for the dialog.</p>\n<p>Alright. Now that we got this in place, let’s implement our animation imperatively using GreenSocks’s timeline feature.</p>\n<h3>Imperative implementation using GreenSock</h3>\n<p>In order to achieve this animation with GSAP we need to use its timeline feature. Make sure to either use <a href=\"https://greensock.com/tweenmax\">TweenMax</a> or add <a href=\"https://greensock.com/timelinelite\">TimelineLite</a> separately to your project.</p>\n<p>A timeline is basically a container where we place tweens over the course of time. Tweening is the process of generating intermediate frames between two states. With GSAP’s timeline we can easily build sequences of animations and animate an element <code class=\"language-text\">.to()</code> or <code class=\"language-text\">.from()</code> a certain state. In addition, we get a lot of control over our animations. As such, we can stop, pause, resume, or even reverse them. Here is a simple example:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> timeline <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TimelineLite</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">var</span> h1 <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'first'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  timeline\n    <span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'start'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>h1<span class=\"token punctuation\">,</span> <span class=\"token number\">0.7</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> ease<span class=\"token punctuation\">:</span> Power2<span class=\"token punctuation\">.</span>easeIn <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'start'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>h1<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> ease<span class=\"token punctuation\">:</span> Bounce<span class=\"token punctuation\">.</span>easeOut <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'start'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#second'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> backgroundColor<span class=\"token punctuation\">:</span> <span class=\"token string\">'#ffeb3b'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#third'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> repeat<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> yoyo<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-=0.3'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">var</span> button <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByTagName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  button<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    timeline<span class=\"token punctuation\">.</span><span class=\"token function\">restart</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>With <code class=\"language-text\">TimelineLite</code> we have complete control over where tweens are placed on the timeline and they can overlap as much as we want. Notice how we use <code class=\"language-text\">.add()</code> to add a label to the timeline. We can use labels to start multiple animations at the same time. For instance, we use this mechanism to run two animations in parallel. The <code class=\"language-text\">h1</code> will fade and translate in at the same time. Both animations could easily be combined in a single animation, but they have different easing functions. It solely demonstrates how to use labels.</p>\n<p>Let’s see how we can do that in our Angular application. First off, we get all the elements using Angular’s built-in <code class=\"language-text\">@ViewChild()</code> and <code class=\"language-text\">@ViewChildren()</code> decorators. We leverage those to query specific elements within the view of a component.</p>\n<p><code class=\"language-text\">@ViewChild()</code> returns an <code class=\"language-text\">ElementRef</code>, whereas <code class=\"language-text\">@ViewChildren()</code> returns a <code class=\"language-text\">QueryList</code>. Essentially it’s an object that stores a list of elements and implements the <code class=\"language-text\">iterable</code> interface. This makes it possible to be used in combination with <code class=\"language-text\">ngFor</code>. The cool thing is that it’s based on Observables. This means we can subscribe to changes and get notified whenever an element is added, removed, or moved.</p>\n<p>For more information check out Minko’s <a href=\"http://blog.mgechev.com/2016/01/23/angular2-viewchildren-contentchildren-difference-viewproviders/\">blog post</a> about the difference between <strong>view children</strong> and <strong>content children</strong> in Angular.</p>\n<p>Here’s how we use it in our Angular application to grab the elements we need:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">@<span class=\"token function\">ViewChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">'wrapper'</span><span class=\"token punctuation\">)</span> wrapper<span class=\"token punctuation\">:</span> ElementRef<span class=\"token punctuation\">;</span>\n@<span class=\"token function\">ViewChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">'main'</span><span class=\"token punctuation\">)</span> main<span class=\"token punctuation\">:</span> ElementRef<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<p>The decorator takes either a type or a template reference variable. In most cases, such template reference variable is a reference to a DOM element inside a component’s template. The following snippet shows how we’d get a reference to the <code class=\"language-text\">wrapper</code> element:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>wrapper<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">#wrapper</span><span class=\"token punctuation\">></span></span>\n...\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>See the <code class=\"language-text\">#wrapper</code>? That’s how we declare a local template reference for that specific element. We do this for all the elements we need for the animation. With that in place, we can instantiate our timeline.</p>\n<p>Usually we use <code class=\"language-text\">ngOnInit</code> to implement our initialization logic. However, this is a little bit too early in a component’s lifecycle because we have to wait for the component to be fully initialized in order to use the DOM elements we collected. There’s a lifecycle hook called <code class=\"language-text\">ngAfterViewInit</code> which is the perfect moment in a component’s initialization process in which we have everything we need to set up the timeline.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">ngAfterViewInit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timeline <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TimelineLite</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Cool! But before we can construct the timeline for our profile animation there’s one thing left to do. We need to apply an initial transformation to the <code class=\"language-text\">wrapper</code> element via CSS in order to achieve the fancy 3D-effect:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.wrapper</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotateX</span><span class=\"token punctuation\">(</span>-90deg<span class=\"token punctuation\">)</span> <span class=\"token function\">translateY</span><span class=\"token punctuation\">(</span>150px<span class=\"token punctuation\">)</span> <span class=\"token function\">translateZ</span><span class=\"token punctuation\">(</span>50px<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  ...\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We can now apply the concepts we learned to build the timeline:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timeline\n  <span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'start'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>wrapper<span class=\"token punctuation\">.</span>nativeElement<span class=\"token punctuation\">,</span> <span class=\"token number\">.15</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'start'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>wrapper<span class=\"token punctuation\">.</span>nativeElement<span class=\"token punctuation\">,</span> <span class=\"token number\">.3</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> rotationX<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> z<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>  ease<span class=\"token punctuation\">:</span> Power3<span class=\"token punctuation\">.</span>easeIn<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'start'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'image'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-=0.1'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'main'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-=0.15'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'icons'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-=0.1'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-=0.05'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>profileImageBorder<span class=\"token punctuation\">.</span>nativeElement<span class=\"token punctuation\">,</span> <span class=\"token number\">.3</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> scale<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'image'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>profileImage<span class=\"token punctuation\">.</span>nativeElement<span class=\"token punctuation\">,</span> <span class=\"token number\">.3</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> scale<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> delay<span class=\"token punctuation\">:</span> <span class=\"token number\">.05</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'image'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">.</span>nativeElement<span class=\"token punctuation\">,</span> <span class=\"token number\">.4</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> y<span class=\"token punctuation\">:</span> <span class=\"token string\">'100%'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'main'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">staggerFrom</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>username<span class=\"token punctuation\">.</span>nativeElement<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">.</span>nativeElement<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">.3</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> left<span class=\"token punctuation\">:</span> <span class=\"token number\">50</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'image'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">staggerFrom</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>statsIcons<span class=\"token punctuation\">,</span> <span class=\"token number\">.3</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> top<span class=\"token punctuation\">:</span> <span class=\"token number\">10</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'icons'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">staggerFrom</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>statsTexts<span class=\"token punctuation\">,</span> <span class=\"token number\">.3</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Woah! This looks pretty overwhelming at first glance. But all we have to do is to orchestrate our animation using GreenSock’s timeline API. With the help of labels we can run multiple animations in parallel and precisely control the timing of certain animations.</p>\n<p>One thing we haven’t talked about so far is <code class=\"language-text\">.staggerFrom()</code>. A stagger is an animation that contains a delay between each successive animation.</p>\n<p>The whole animation can be illustrated as follows:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/28cc04860f39b83d889139786537558e/8fcfd/animation_timeline.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.83240223463687%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAABYlAAAWJQFJUiTwAAACA0lEQVQoz31Sy4/SYBzkv3RPCwRWgzysgDy6XYWSEAJZq7IShISi4eDZAx6FI3Ag2Q2BcDAeeCwILQilD2jrUPaBuDqHr9N05ptvfv1Mmqapqqrr+j7B2u12i8ViqVTK3SJvIB6P12o1CNbrtelvsyLLravLQj735MTudDptNpvdAIjD4chms61WC7LNZvOAWVit4kz6OUWHYgny9B7hcJimaUHA99VkMoH4wKzpmroQlVB1dPz12vble4hOeAmP2+25g9VqtVgsfr8fuzyQLEnSh8JHio4HqZdhkgzdIhAIRCIRURQhg/OP5N3a6XTy+VyQcHkcj90ul3svFNzn87EsC81h5xtzu11gi6cXn0KJt6/OztCZJMmwARA0N5vN5XL5ftp4wIlVVhQcX1qrLyrX5tefg95niH66B+R7vd5qtXpj1vew+8Noxeay75hzhmEQeNAZo74bkEmWZVyAVCp1boCiKIIgjs2WR0dHJ3Z7u90ej8e9Xq/f7w8Gg+FwCL1qYNsZL28YJhqNxmIxbP8+k2k0GrhD9Xq92WwaRf4J03Q6LbKFi3Q6k8kkk8lK5du2jyLjWHDyHDebzXieh2xHgPl8Ds5xnGm5XPKChK5QS5K4kJQRx3d+9H7O5svFr9FoJBjYEYjRArVBUGE7MHmjqcaotpm4Y7rOy9oM2Zr+f/wGi2WTFapdANEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"animation timeline\"\n        title=\"animation timeline\"\n        src=\"/static/28cc04860f39b83d889139786537558e/8ff1e/animation_timeline.png\"\n        srcset=\"/static/28cc04860f39b83d889139786537558e/9ec3c/animation_timeline.png 200w,\n/static/28cc04860f39b83d889139786537558e/c7805/animation_timeline.png 400w,\n/static/28cc04860f39b83d889139786537558e/8ff1e/animation_timeline.png 800w,\n/static/28cc04860f39b83d889139786537558e/8fcfd/animation_timeline.png 1074w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Here’s the full-fledge solution. Take a look and fiddle with it.</p>\n<iframe style=\"height: 600px\" src=\"https://embed.plnkr.co/RMtC6RqBAzrFmmOiJu4i?show=preview&deferRun&sidebar\" frameborder=\"0\" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>\n<h3>Declarative implementation using Angular Animations</h3>\n<p>In the previous section we have seen how to implement the profile animation with GreenSock in an imperative way. There are some drawbacks to that solution. First, it’s quite some boilerplate and work to collect all the elements and manually set up the timeline. That said, an animation platform like GSAP requires the DOM to be ready. A framework can make much more assumptions about the instructions (animation data) and the environment (app and browser) before animating things. Second, it can be very beneficial if there’s a framework backing the animation engine, like with Angular. GSAP and other animation libraries cannot easily handle DOM insertions or removals because they do not own the DOM transactions. Angular on the other hand has full control over the DOM.</p>\n<p>If you are completely new to animations with Angular, check out <a href=\"/b7e59d849d2bde959f3e59d7d35781b7/2016-09-16-angular-2-animation-important-concepts.md\">this</a> post by Thomas Burleson. It covers the fundamentals and shows an example of a more complex fade animation.</p>\n<p>Alright, let’s refactor our profile animation using the latest animation features introduced with Angular 4.2. To get started, we first have to import the <code class=\"language-text\">BrowserAnimationsModule</code> from <code class=\"language-text\">@angular/platform-browser/animations</code> and add it to the <code class=\"language-text\">imports</code> of our application:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">@<span class=\"token function\">NgModule</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  imports<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    BrowserAnimationsModule\n    <span class=\"token operator\">...</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">DashboardModule</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>Remember, animations in Angular are based on the WAAPI and work in browsers that support it including Chrome and Firefox. However, currently Internet Explorer and Safari do not. In this case a <a href=\"https://github.com/web-animations/web-animations-js\">polyfill</a> is required to achieve similar results. Once animations are properly imported and enabled, we can go ahead and start defining the profile animation.</p>\n<p>To quickly recap, animations are declared with the animations metadata property within the <code class=\"language-text\">@Component()</code> decorator. Each animation is defined by a <code class=\"language-text\">trigger</code> which takes a name and a list of <code class=\"language-text\">state</code> and <code class=\"language-text\">transition</code> entries. Angular’s animation engine works basically like a state machine. That’s right. This should sound familiar. We have seen it in the beginning of this post, remember? The first argument of <code class=\"language-text\">transition</code> allows you to specify a direction from one state to another, also known as <strong>state-change-expression</strong>. Here are some common values:</p>\n<ul>\n<li><code class=\"language-text\">* =&gt; *</code> captures a state change between any states</li>\n<li><code class=\"language-text\">void =&gt; *</code> captures the entering of elements</li>\n<li><code class=\"language-text\">* =&gt; void</code> captures the leaving of elements</li>\n</ul>\n<p>The last two are so common that they have their own aliases:</p>\n<ul>\n<li><code class=\"language-text\">:enter</code> for <code class=\"language-text\">void =&gt; *</code></li>\n<li><code class=\"language-text\">:leave</code> for <code class=\"language-text\">* =&gt; void</code></li>\n</ul>\n<p>Angular 4.2 introduces several new animation features and extends Angular’s animation DSL. Here’s a quick overview of what’s new:</p>\n<ul>\n<li><strong>query()</strong> can be used to find one or more elements within the element that’s being animated</li>\n<li><strong>stagger()</strong> animates a bunch of elements with a delay in between each animation</li>\n<li><strong>group()</strong> specifies a list of animations that are run in parallel</li>\n<li><strong>sequence()</strong> specifies a list of animations that are run one at a time</li>\n<li><strong>animation()</strong> can be used to create reusable animations with input parameters</li>\n<li><strong>useAnimation()</strong> invokes reusable animations created with <code class=\"language-text\">animation()</code></li>\n<li><strong>animateChild()</strong> will invoke child animations which are normally blocked</li>\n</ul>\n<p>Neat! Let’s use that to re-implement our profile animation with Angular’s animation DSL. In order to demonstrate most of the above animation helpers, especially <code class=\"language-text\">animateChild()</code>, we need to refactor our application a bit.</p>\n<p>First of all, we create a new component called <code class=\"language-text\">ProfileStatsComponent</code> which now contains the <code class=\"language-text\">ul</code> that was previously part of the <code class=\"language-text\">DashboardComponent</code>. The template of the <code class=\"language-text\">DashboardComponent</code> now looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>wrapper<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>header</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>profile-image-wrapper<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>profile-image-border<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>profile-image<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://api.adorable.io/avatars/90/me@you.com.png<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>profile-header-content<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>username<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>{{ user.name }}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>username-title<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>{{ user.title }}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>header</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>main</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>profile-stats</span> <span class=\"token attr-name\">[user]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>user<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>profile-stats</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>main</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>The dashboard now composes the <code class=\"language-text\">ProfileStatsComponent</code> which will later define its own animation. For now, let’s focus on the profile animation and talk about child animations in a minute.</p>\n<p>Here’s how we define our <code class=\"language-text\">profileAnimation</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">animations<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token function\">trigger</span><span class=\"token punctuation\">(</span><span class=\"token string\">'profileAnimation'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token function\">transition</span><span class=\"token punctuation\">(</span><span class=\"token string\">':enter'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">group</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n      <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>Within our <code class=\"language-text\">profileAnimation</code> we define one <code class=\"language-text\">transition</code> and on <code class=\"language-text\">:enter</code> (when the dialog enters the DOM) we run several animations in parallel. Next, we use <code class=\"language-text\">query()</code> to grab the DOM elements we need for our animation and set some initial styles using the <code class=\"language-text\">styles</code> helper:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">animations<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token function\">trigger</span><span class=\"token punctuation\">(</span><span class=\"token string\">'profileAnimation'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token function\">transition</span><span class=\"token punctuation\">(</span><span class=\"token string\">':enter'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">group</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n      <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.wrapper'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> transform<span class=\"token punctuation\">:</span> <span class=\"token string\">'rotateX(-90deg) translateY(150px) translateZ(50px)'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.profile-image-border, .profile-image'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> transform<span class=\"token punctuation\">:</span> <span class=\"token string\">'scale(0)'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.username, .username-title'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> transform<span class=\"token punctuation\">:</span> <span class=\"token string\">'translateX(50px)'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">'main'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> transform<span class=\"token punctuation\">:</span> <span class=\"token string\">'translateY(100%)'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>Remember how we collected the DOM elements using <code class=\"language-text\">@ViewChild()</code> and <code class=\"language-text\">@ViewChildren()</code>? We don’t need to do that anymore. Plus, we can get rid of all the local template references because that is now handled by <code class=\"language-text\">query()</code>. Quite powerful, huh?</p>\n<p>Before we implement the profile animation, let’s create a reusable <strong>fade</strong> animation that we can use elsewhere in different places with full input parameter support:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> fadeAnimation <span class=\"token operator\">=</span> <span class=\"token function\">animation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n  <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'{{ duration }}'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> opacity<span class=\"token punctuation\">:</span> <span class=\"token string\">'{{ to }}'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> params<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> duration<span class=\"token punctuation\">:</span> <span class=\"token string\">'1s'</span><span class=\"token punctuation\">,</span> to<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The <code class=\"language-text\">fadeAnimation</code> can now be imported into our application, adjusted via input parameter and invoked using <code class=\"language-text\">useAnimation()</code>. The values we specified for the input parameters are default values.</p>\n<p>Once we have that in place, let’s add the missing pieces to our animation:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">animations<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token function\">trigger</span><span class=\"token punctuation\">(</span><span class=\"token string\">'profileAnimation'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token function\">transition</span><span class=\"token punctuation\">(</span><span class=\"token string\">':enter'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">group</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n      <span class=\"token comment\">// Initial Styles</span>\n      <span class=\"token operator\">...</span>\n\n      <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.wrapper'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">group</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n        <span class=\"token function\">useAnimation</span><span class=\"token punctuation\">(</span>fadeAnimation<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n          params<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            duration<span class=\"token punctuation\">:</span> <span class=\"token string\">'150ms'</span><span class=\"token punctuation\">,</span>\n            to<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'300ms cubic-bezier(0.68, 0, 0.68, 0.19)'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> transform<span class=\"token punctuation\">:</span> <span class=\"token string\">'matrix(1, 0, 0, 1, 0, 0)'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n      <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.profile-image-border'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'200ms 250ms ease-out'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n      <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.profile-image'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'200ms 300ms ease-out'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n      <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.username, .username-title'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">stagger</span><span class=\"token punctuation\">(</span><span class=\"token string\">'100ms'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'200ms 250ms ease-out'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n      <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">'main'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'200ms 250ms ease-out'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>In the code above, we query a bunch of elements and use several animation helpers to achieve the desired effect. All animations will run in parallel because they are defined within a <code class=\"language-text\">group()</code>. Also, there are no “labels” or a similar feature to what GreenSock provides with <code class=\"language-text\">.add()</code>. Turns out, Angular has no timeline support yet and we need to fiddle with delays in order to orchestrate the animation.</p>\n<p>If we take a closer look we can see that there’s actually more to it. For instance for the <code class=\"language-text\">wrapper</code>, we run two animations in parallel one of which is the reusable animation we defined earlier. We can invoke a reusable animation with the <code class=\"language-text\">useAnimation()</code> method. While <code class=\"language-text\">AnimationOptions</code> are optional, we specify them to override the default input paramters.</p>\n<p>Furthermore, we can spot this special style property of <code class=\"language-text\">style(&#39;*&#39;)</code>. This will basically remove all of the special styling we have added (e.g. initial styles) and reset the state of the element. It’s an equivalent of setting each value to <code class=\"language-text\">*</code>. This means that Angular will figure out the values at runtime. On top of that use the <code class=\"language-text\">stagger()</code> animation helper method to animate multiple elements with a time gap in between each animated element.</p>\n<h4>Applying animations using @HostBinding()</h4>\n<p>Ok, but how do we use the animation? For that we can either attach the <strong>trigger</strong> to the element within the component’s template or use a <code class=\"language-text\">@HostBinding()</code>. In our case, we use the <code class=\"language-text\">@HostBinding()</code> because we want to attach the trigger to the host element:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ProfileStatsComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n\n  @<span class=\"token function\">HostBinding</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@profileAnimation'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">public</span> animateProfile <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4>Understanding child animations</h4>\n<p>In a real-world scenario you most likely end up having multiple components and animations on different levels, e.g. parent or child animations. Turns out that parent animations will always get priority and any child animation will be blocked. That’s a shame. But don’t bury your head in the sand yet because Angular got you covered! We can query inner elements and use <code class=\"language-text\">animateChild()</code> to allow child animations to run. The cool thing is we can do that at any point in the animation sequence within a defined <code class=\"language-text\">transition</code>.</p>\n<p>In our example, we created a component called <code class=\"language-text\">ProfileStatsComponent</code>. Let’s see this in action and start off by creating a child animation for this component using everything we know by now:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">animations<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token function\">trigger</span><span class=\"token punctuation\">(</span><span class=\"token string\">'statsAnimation'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token function\">transition</span><span class=\"token punctuation\">(</span><span class=\"token string\">'* => *'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">group</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n      <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.stats-icon'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> transform<span class=\"token punctuation\">:</span> <span class=\"token string\">'scale(0.8) translateY(10px)'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.stats-text'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n      <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.stats-icon'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">stagger</span><span class=\"token punctuation\">(</span><span class=\"token string\">'100ms'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'200ms 250ms ease-out'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n      <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.stats-text'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">stagger</span><span class=\"token punctuation\">(</span><span class=\"token string\">'100ms'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'200ms 250ms ease-out'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>Easy, right? Now we can go ahead and use the <code class=\"language-text\">animateChild()</code> helper as mentioned earlier in our <code class=\"language-text\">profileAnimation</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">animations<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token function\">trigger</span><span class=\"token punctuation\">(</span><span class=\"token string\">'profileAnimation'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token function\">transition</span><span class=\"token punctuation\">(</span><span class=\"token string\">':enter'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">group</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n      <span class=\"token comment\">// Initial Styles</span>\n      <span class=\"token operator\">...</span>\n\n      <span class=\"token comment\">// Animation</span>\n      <span class=\"token operator\">...</span>\n      <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">'profile-stats'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">animateChild</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>That’s it. We fully re-implemented the profile animation using Angular’s built-in animation system. It’s very intuitive, easy to use and declarative.</p>\n<p>Here’s the demo. Try it out and fiddle with it!</p>\n<iframe style=\"height: 600px\" src=\"https://embed.plnkr.co/kfJTtXT1V2AR01sFNfzw?show=preview&deferRun&sidebar\" frameborder=\"0\" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>\n<p>If you want to find out more about the new animation features in Angular 4.2+, check out <a href=\"https://www.yearofmoo.com/2017/06/new-wave-of-animation-features.html#using-animation-and-useanimation\">this</a> excellent post by Matias Niemela.</p>\n<h2>Special Thanks</h2>\n<p>Kudos to <a href=\"https://twitter.com/yearofmoo\">Matias Niemelä</a> for the amazing work on the Angular Animation system!</p>","frontmatter":{"author":"dominic_elm","title":"A web animations deep dive with Angular","imageUrl":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAv/EABYBAQEBAAAAAAAAAAAAAAAAAAIAAf/aAAwDAQACEAMQAAABTQvAbiQ2/8QAGhAAAQUBAAAAAAAAAAAAAAAAAQACAxESIf/aAAgBAQABBQJ3CHUpBZh6t6lL1//EABcRAAMBAAAAAAAAAAAAAAAAAAABAhH/2gAIAQMBAT8BqdEf/8QAFhEBAQEAAAAAAAAAAAAAAAAAAhAR/9oACAECAQE/ASsn/8QAHBAAAwABBQAAAAAAAAAAAAAAAAERQRIhMXFy/9oACAEBAAY/AlcI46KmyVmhb+jJ/8QAGhABAAIDAQAAAAAAAAAAAAAAAQARIUFhUf/aAAgBAQABPyGukAllHByllCIJeGaRV5Gur1pM3HZ//9oADAMBAAIAAwAAABAs3//EABgRAQADAQAAAAAAAAAAAAAAAAEAESEx/9oACAEDAQE/EMy8goqf/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAERMUH/2gAIAQIBAT8QwdHW6f/EAB4QAQEAAgEFAQAAAAAAAAAAAAERACFBMVGRobHB/9oACAEBAAE/ENgbJedFnn1g3QSYut4AiPuMCOuysD+4xcBICrlJhQQAhJ+Z/9k=","aspectRatio":1.4406065711878686,"src":"/static/84ac15a7b1b2b23519f3a69e9cb65e8b/30037/angular-animations.jpg","srcSet":"/static/84ac15a7b1b2b23519f3a69e9cb65e8b/10bdc/angular-animations.jpg 158w,\n/static/84ac15a7b1b2b23519f3a69e9cb65e8b/f4ab0/angular-animations.jpg 315w,\n/static/84ac15a7b1b2b23519f3a69e9cb65e8b/30037/angular-animations.jpg 630w,\n/static/84ac15a7b1b2b23519f3a69e9cb65e8b/9810d/angular-animations.jpg 945w,\n/static/84ac15a7b1b2b23519f3a69e9cb65e8b/ff2e4/angular-animations.jpg 1260w,\n/static/84ac15a7b1b2b23519f3a69e9cb65e8b/16f35/angular-animations.jpg 1710w","sizes":"(max-width: 630px) 100vw, 630px"}}},"date":"26 July 2017","summary":"Angular comes with a built-in animation system that lets us create powerful animations based on the Web Animations API. In this article we'll look at two differet approaches, namely imperative and declarative animations.","categories":["angular"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/angular/2017/07/26/a-web-animations-deep-dive-with-angular.html","previous":{"fields":{"slug":"/announcements/2017/06/23/announcing-angular-master-class-in-houston.html"},"frontmatter":{"date":"2017/06/23","title":"Announcing Angular Master Class in Houston","categories":["announcements"]}},"next":{"fields":{"slug":"/company/2017/08/17/company-offsite-2017.html"},"frontmatter":{"date":"2017/08/17","title":"Company offsite in Spain 2017","categories":["company"]}}}}}