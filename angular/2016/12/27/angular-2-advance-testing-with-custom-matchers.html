<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/commons.743a077edf8bbf03e9ea.css">/*! normalize.css v7.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}[hidden],template{display:none}:root{--thtrm-color-darkblue:#456474;--thtrm-color-midblue:#4c91a7;--thtrm-color-blue:#69caff;--thtrm-color-lighterblue:#dbe8ec;--thtrm-color-teal:#42899b;--thtrm-color-lightblue:#72c7df;--thtrm-color-text:#000;--thtrm-color-lighttext:#7d7d7d;--thtrm-color-gray:#eee;--thtrm-color-lightgray:#f8f8f9;--thtrm-color-ultralightgray:#fbfbfb;--thtrm-color-white:#fff;--thtrm-rustforjs-yellow:#ffd45e;--thtrm-amc-red:#dd0031;--thtrm-git-orange:#de4c36;--thtrm-rxjs-pink:#b7178c;--thtrm-border-color:var(--thtrm-color-gray);--thtrm-base-font:Roboto;--thtrm-base-font-stack:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";--thtrm-base-fontweight:500;--thtrm-base-fontsize:19px;--thtrm-small-fontsize:calc(0.85*var(--thtrm-base-fontsize));--thtrm-nav-fontsize:calc(1*var(--thtrm-base-fontsize));--thtrm-h1-fontszize:calc(1.75*var(--thtrm-base-fontsize));--thtrm-h2-fontszize:calc(1.5*var(--thtrm-base-fontsize));--thtrm-h3-fontszize:calc(1.3*var(--thtrm-base-fontsize));--thtrm-h4-fontszize:calc(1.1*var(--thtrm-base-fontsize));--thtrm-page-margin:5vw;--thtrm-page-neg-margin:-5vw;--thtrm-layer-submarine:-1;--thtrm-layer-deco:9;--thtrm-layer-navigation:99;--thtrm-layer-surface:99999999999}@font-face{font-family:Roboto;font-style:normal;font-weight:300;src:local("Roboto"),local("Roboto")}@font-face{font-family:Roboto;font-weight:500;src:local("Roboto Medium"),local("Roboto Medium")}@font-face{font-family:Roboto;font-style:italic;font-weight:500;src:local("Roboto Medium Italic"),local("Roboto-MediumItalic")}*,:after,:before{box-sizing:border-box;margin:0;padding:0}html{font-family:var(--thtrm-base-font),var(--thtrm-base-font-stack);font-size:var(--thtrm-base-fontsize);font-weight:var(--thtrm-base-fontweight);line-height:1.45;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body{position:relative}h1,h2,h3,h4{font-weight:var(--thtrm-bold-fontweight);line-height:1.2;letter-spacing:0;margin:0}h1{font-size:var(--thtrm-h1-fontszize)}a{color:var(--thtrm-color-midblue);text-decoration:none}.thtrm-page--yellow a{color:#000}a:after{color:currentColor;content:"\203A";font-weight:400;font-size:1.15em;margin-left:.25em}a[title=Home]:after{display:none}img{width:100%;height:auto}@media screen and (min-width:80em){:root{--thtrm-base-fontsize:25px;--thtrm-small-fontsize:calc(0.75*var(--thtrm-base-fontsize));--thtrm-nav-fontsize:calc(1*var(--thtrm-base-fontsize));--thtrm-h1-fontszize:calc(2.25*var(--thtrm-base-fontsize));--thtrm-h2-fontszize:calc(2*var(--thtrm-base-fontsize));--thtrm-page-margin:10vw;--thtrm-page-neg-margin:-10vw}}@media screen and (min-width:120em){:root{--thtrm-base-fontsize:27px}}.thtrm-page{padding-left:5vw;padding-right:5vw;overflow-x:hidden}.thtrm-page.thtrm-page--yellow{background-color:var(--thtrm-rustforjs-yellow)}.thtrm-banner{display:flex;align-items:center;justify-content:space-between;height:90px}@media screen and (min-width:80em){.thtrm-page{padding-left:10vw;padding-right:10vw}.thtrm-banner{height:160px}}@media screen and (min-width:120em){.thtrm-page{padding-left:10vw;padding-right:10vw}.thtrm-banner{height:260px}}@supports (display:grid){.thtrm-page{display:grid;grid-template-columns:[pad-left] 5vw [center] 90vw [pad-left] 5vw;grid-template-rows:[banner] 90px [main] auto [aside] auto [footer] auto;padding-left:0;padding-right:0}@media screen and (min-width:80em){.thtrm-page{grid-template-columns:[pad-left] 10vw [center] 80vw [pad-left] 10vw;grid-template-rows:[banner] 160px [main] auto [aside] auto [footer] auto}}@media screen and (min-width:120em){.thtrm-page{grid-template-columns:[pad-left] 10vw [center] 80vw [pad-left] 10vw;grid-template-rows:[banner] 260px [main] auto [aside] auto [footer] auto}}.thtrm-banner{height:auto;grid-row-start:1;grid-row-end:1}.thtrm-banner,.thtrm-main{grid-column-start:2;grid-column-end:2}.thtrm-main{grid-row-start:2;grid-row-end:2}.thtrm-aside{grid-row-start:3;grid-row-end:3}.thtrm-aside,.thtrm-footer{grid-column-start:2;grid-column-end:2}.thtrm-footer{grid-row-start:4;grid-row-end:4}}.thtrm-banner{position:relative}.thtrm-footer{border-top:5px solid var(--thtrm-color-text);font-size:var(--thtrm-small-fontsize);padding:2rem 0;margin-top:2rem}.thtrm-footer .thtrm-sitemap{margin-bottom:2rem}.thtrm-footer .thtrm-sitemap__heading{font-size:var(--thtrm-base-fontsize);margin-top:1rem;margin-bottom:.5rem}.thtrm-footer .thtrm-copyright{display:flex;align-items:center;justify-content:space-between}.thtrm-footer .thtrm-sitemap nav ul{list-style:none}.thtrm-footer .thtrm-sitemap nav li a{text-decoration:none}.thtrm-footer .thtrm-sitemap nav li a:after{color:currentColor;content:"\203A";font-weight:400;font-size:1.15em;margin-left:.25em}@media screen and (min-width:31.5em){.thtrm-footer .thtrm-sitemap{display:grid;grid-template-columns:33.33333333333% 33.33333333333% 33.33333333333%;margin-bottom:2rem}.thtrm-footer .thtrm-sitemap__item{-ms-grid-column-span:1}.thtrm-footer .thtrm-sitemap__item:first-of-type{-ms-grid-column:1}.thtrm-footer .thtrm-sitemap__item:nth-of-type(2){-ms-grid-column:2}.thtrm-footer .thtrm-sitemap__item:nth-of-type(3){-ms-grid-column:3}.thtrm-footer .thtrm-sitemap__heading{margin-top:0;margin-bottom:1rem}}.thtrm-box{background-color:var(--thtrm-color-midblue);color:var(--thtrm-color-white);font-size:var(--thtrm-small-fontsize);padding:1.5rem;width:100%}.thtrm-box--light{background-color:var(--thtrm-color-lightblue)}.thtrm-box--red{background-color:var(--thtrm-amc-red)}.thtrm-box--red,.thtrm-box--white{box-shadow:0 2px 24px 0 rgba(0,0,0,.04)}.thtrm-box--white{background-color:var(--thtrm-color-white);color:var(--thtrm-color-text)}.thtrm-box--dark{background-color:var(--thtrm-color-darkblue)}.thtrm-box--mid{background-color:var(--thtrm-color-teal)}.thtrm-box>.thtrm-box__heading{margin-bottom:1rem}.thtrm-box--offset-left,.thtrm-box--offset-right{margin-bottom:.5rem}.thtrm-box>.thtrm-box__more-link{color:var(--thtrm-color-white);display:block;font-size:var(--thtrm-base-fontsize);text-decoration:none;margin-top:1rem}@media screen and (min-width:43.75em){.thtrm-box{padding:2rem}.thtrm-box:not([class*=thtrm-box--offset]){width:auto}.thtrm-box--offset-left,.thtrm-box--offset-right{margin-bottom:1rem;position:absolute;top:2.5rem;width:80%;right:-70%;z-index:var(--thtrm-layer-deco)}.thtrm-box--offset-right{right:-70%}.thtrm-box--offset-left{left:-70%}}.thtrm-button,[class*=thtrm-button],[class^=thtrm-button]{border:none;background-color:var(--thtrm-color-darkblue);color:var(--thtrm-color-white);display:inline-block;font-weight:var(--thtrm-base-fontweight);font-size:inherit;padding:.5rem 1rem;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.thtrm-page--yellow .thtrm-button,.thtrm-page--yellow [class*=thtrm-button],.thtrm-page--yellow [class^=thtrm-button]{background-color:#000}.thtrm-button--bordered{border:4px solid;background-color:transparent}.thtrm-button--ghost{color:inherit;padding:.25rem}.thtrm-button--ghost,.thtrm-page--yellow .thtrm-button--ghost{background-color:transparent}.thtrm-card{background-color:var(--thtrm-color-midblue);color:var(--thtrm-color-white);font-size:var(--thtrm-small-fontsize);padding:1rem;width:100%}.thtrm-card--red{background-color:var(--thtrm-amc-red)}.thtrm-card--black,.thtrm-card--red{box-shadow:0 2px 24px 0 rgba(0,0,0,.04)}.thtrm-card--black{background-color:var(--thtrm-git-orange)}.thtrm-card--pink{background-color:var(--thtrm-rxjs-pink)}.thtrm-card--pink,.thtrm-card--white{box-shadow:0 2px 24px 0 rgba(0,0,0,.04)}.thtrm-card--white{background-color:var(--thtrm-color-white);color:var(--thtrm-color-text)}.thtrm-card>.thtrm-card__heading{margin-bottom:1rem}.thtrm-card__topic{font-size:.625rem;margin-bottom:.5rem;color:var(--thtrm-color-white);text-transform:uppercase;letter-spacing:.02em}.thtrm-card__topic.thtrm-card__topic--red{color:var(--thtrm-amc-red)}.thtrm-card__topic.thtrm-card__topic--pink{color:var(--thtrm-rxjs-pink)}.thtrm-card__topic.thtrm-card__topic--grey{color:var(--thtrm-color-lighttext)}.thtrm-card__topic.thtrm-card__topic--black{color:var(--thtrm-git-orange)}.thtrm-card__list{list-style:none}.thtrm-card__list li{position:relative;padding-left:1rem;margin-top:.5em;line-height:1.2}.thtrm-card__list li:before{content:"\2192   ";margin-left:-1rem;position:absolute}.thtrm-card__paragraph{margin:.5rem 0}.thtrm-card__link{color:inherit}@media screen and (min-width:43.75em){.thtrm-card{padding:1.5rem}}.thtrm-form .thtrm-form__label{display:none}.thtrm-form .thtrm-form__input--text{background-color:var(--thtrm-color-gray);border:none;font-size:inherit;padding:.5rem 1rem;min-width:40%}.thtrm-form__info-text{font-size:.4rem;font-weight:400;max-width:500px;color:#aaa;margin:.4em auto auto}.thtrm-form__info-text a{text-decoration:underline;color:#aaa}.thtrm-form__info-text a:after{display:none}.thtrm-form__row{margin-top:16px}.thtrm-form__column-group{display:grid;grid-column-gap:24px;grid-template-columns:1fr 1fr;grid-template-rows:auto auto}.thtrm-form__column-group label{grid-row:1}.thtrm-form__column-group input{grid-row:2}.thtrm-icon,[class^=thtrm-icon--]{color:inherit;display:inline-block;vertical-align:middle;transition:all .25s linear;height:24px;width:24px}svg.thtrm-icon,svg[class^=thtrm-icon]{fill:currentColor}svg.thtrm-icon path:not([fill=none]),svg.thtrm-icon use,svg[class^=thtrm-icon] path:not([fill=none]),svg[class^=thtrm-icon] use{fill:inherit}.thtrm-image-grid{display:flex;flex-flow:column wrap;align-items:center;justify-content:space-around;z-index:var(--thtrm-layer-submarine);margin-top:-.25rem}.thtrm-image-grid img{text-align:center;-o-object-fit:contain;object-fit:contain;font-family:"object-fit: contain;";width:50%;max-width:200px;max-height:200px}@media screen and (min-width:20em){.thtrm-image-grid{flex-flow:row wrap}}@media screen and (min-width:43.75em){.thtrm-image-grid img{width:25%;max-width:18%;max-height:250px;-o-object-fit:contain;object-fit:contain;font-family:"object-fit: contain;"}}.thtrm-layout{display:grid;grid-gap:1rem;padding:1rem;width:100%}.thtrm-layout.thtrm-layout-fourths,.thtrm-layout.thtrm-layout-halfs,.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr}@media screen and (min-width:43.75em){.thtrm-layout.thtrm-layout-fourths,.thtrm-layout.thtrm-layout-halfs,.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr 1fr}}@media screen and (min-width:50em){.thtrm-layout.thtrm-layout-fourths,.thtrm-layout.thtrm-layout-halfs,.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr 1fr}}@media screen and (min-width:64em){.thtrm-layout.thtrm-layout-halfs,.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr 1fr}.thtrm-layout.thtrm-layout-fourths{grid-template-columns:1fr 1fr 1fr}}@media screen and (min-width:80em){.thtrm-layout{grid-gap:1.5rem;padding:1.5rem}.thtrm-layout.thtrm-layout-halfs{grid-template-columns:1fr 1fr}.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr 1fr 1fr}.thtrm-layout.thtrm-layout-fourths{grid-template-columns:1fr 1fr 1fr 1fr}}@media screen and (min-width:120em){.thtrm-layout{display:grid;grid-gap:1.5rem}.thtrm-layout.thtrm-layout-halfs{grid-template-columns:1fr 1fr}.thtrm-layout.thtrm-layout-thirds{grid-template-columns:1fr 1fr 1fr}.thtrm-layout.thtrm-layout-fourths{grid-template-columns:1fr 1fr 1fr 1fr 1fr}}.thtrm-logo{max-height:45px;width:160px;margin-top:-1.65rem}@media screen and (min-width:80em){.thtrm-logo{max-height:80px;width:200px;margin-top:-1rem}}@media screen and (min-width:120em){.thtrm-logo{max-height:100px;width:380px}}.thtrm-nav{display:flex;align-items:center;justify-content:space-between;font-size:var(--thtrm-nav-fontsize)}.thtrm-nav .thtrm-nav__list{background-color:var(--thtrm-color-lightgray);box-shadow:0 1px 2px rgba(50,50,50,.1);list-style:none;text-align:left;position:absolute;right:0;top:70%;width:auto;z-index:99;opacity:0;visibility:hidden;transition:.25s;transform:translate3d(0,-10%,0);padding:1rem .5rem}.thtrm-nav .thtrm-nav__list:before{content:"";width:10px;height:10px;border-right:6px solid transparent;border-left:6px solid transparent;border-bottom:6px solid var(--thtrm-color-lightgray);position:absolute;top:-10px;right:10px}.thtrm-nav .thtrm-nav__list li{padding:0 1rem;margin-top:.5rem}.thtrm-nav .thtrm-nav__list a{color:var(--thtrm-color-text);font-weight:var(--thtrm-base-fontweight);text-decoration:none;transition:.25s}.thtrm-nav .thtrm-nav__list a.active{border-bottom:2px solid var(--thtrm-color-text);padding-bottom:.3em}.thtrm-nav .thtrm-nav__list a:hover{color:var(--thtrm-color-blue)}.thtrm-nav .thtrm-nav__list a:after{content:""}.no-js .thtrm-nav .thtrm-nav__button:focus+.thtrm-nav__list,.no-js .thtrm-nav .thtrm-nav__button:hover+.thtrm-nav__list,.no-js .thtrm-nav__list:hover,.thtrm-nav__list.is-visible{opacity:1;pointer-events:all;visibility:visible;transform:translateZ(0)}.thtrm-nav-toc{border-top:3px solid #000;font-size:.75rem}.thtrm-nav-toc li{display:inline-block}.thtrm-nav-toc li:first-child a{padding-left:0}.thtrm-nav-toc li:last-child a{padding-right:0}.thtrm-nav-toc a{color:var(--thtrm-color-text);display:block;padding:.75rem 1rem}.thtrm-nav-toc a.is-active{color:var(--thtrm-color-midblue)}.thtrm-nav-toc a:after{content:""}@media screen and (min-width:50em){.thtrm-nav .thtrm-nav__list li:last-of-type{padding-right:0}.thtrm-nav .thtrm-nav__button,.thtrm-nav .thtrm-nav__list:before{display:none}.thtrm-nav .thtrm-nav__list{background-color:transparent;box-shadow:none;display:flex;flex-flow:row wrap;align-items:center;justify-content:flex-end;opacity:1;pointer-events:all;visibility:visible;transform:translateZ(0);position:static}}[class*=thtrm-ratio--]{position:relative}[class*=thtrm-ratio--]:before{content:"";display:block;width:100%}[class*=thtrm-ratio--]>*{position:absolute;bottom:0;left:0;right:0;top:0}[class*=thtrm-ratio--]>img{height:100%;-o-object-fit:cover;object-fit:cover}.thtrm-ratio--landscape:before{padding-top:75%}.thtrm-ratio--square:before{padding-top:100%}.thtrm-ratio--stripe:before{padding-top:50%}.thtrm-section,[class^=thtrm-section--]{position:relative;margin-bottom:3rem}.thtrm-section .thtrm-section__item,[class^=thtrm-section--] .thtrm-section__item{width:100%}.thtrm-section .thtrm-section__heading,[class^=thtrm-section--] .thtrm-section__heading{width:100%;margin-top:1.5rem;margin-bottom:.75rem}.thtrm-section .thtrm-section__paragraph,[class^=thtrm-section--] .thtrm-section__paragraph{margin-bottom:1rem}.thtrm-section .thtrm-section__paragraph a:after,[class^=thtrm-section--] .thtrm-section__paragraph a:after{display:none}.thtrm-section .thtrm-section__paragraph--small,[class^=thtrm-section--] .thtrm-section__paragraph--small{font-size:.8rem;font-weight:400}.thtrm-section .thtrm-section__link,[class^=thtrm-section--] .thtrm-section__link{display:inline-block;margin-bottom:1rem}.thtrm-section .thtrm-section__link--black,[class^=thtrm-section--] .thtrm-section__link--black{color:#000}.thtrm-section .thtrm-section__link--black .thtrm-section__link,[class^=thtrm-section--] .thtrm-section__link--black .thtrm-section__link{color:var(--thtrm-color-midblue)}.thtrm-section .thtrm-section__link--black .thtrm-section__link:after,[class^=thtrm-section--] .thtrm-section__link--black .thtrm-section__link:after{color:currentColor}.thtrm-section .thtrm-section__heading--unpadded-top,[class^=thtrm-section--] .thtrm-section__heading--unpadded-top{width:100%;margin-top:0;margin-bottom:.75rem}.thtrm-section .thtrm-section__heading--small,[class^=thtrm-section--] .thtrm-section__heading--small{width:100%;margin-bottom:1rem;font-size:1.25rem;line-height:1.3}.thtrm-section--centered{text-align:center}.thtrm-section--unpadded-bottom{margin-bottom:0}.thtrm-section--fullbleed{margin-left:-5vw;margin-right:-5vw;min-height:300px}.thtrm-section--fullbleed-intrinsic{margin-left:-5vw;margin-right:-5vw;margin-top:0}@media screen and (min-width:80em){.thtrm-section--fullbleed-intrinsic{margin-left:-10vw;margin-right:-10vw}}.thtrm-section--privacy-statement li,.thtrm-section--privacy-statement p,.thtrm-section--privacy-statement strong{font-size:.8rem;font-weight:400}.thtrm-section--privacy-statement p,.thtrm-section--privacy-statement ul{margin-bottom:.75rem}.thtrm-section--privacy-statement ul{margin-left:1rem}.thtrm-section--privacy-statement h3,.thtrm-section--privacy-statement h4{margin-bottom:1rem;margin-top:.5rem}.thtrm-stripe--fullwidth{font-weight:700;color:#fff;font-size:1.5rem;height:6rem;text-align:center;display:flex;width:100%;align-items:center;justify-content:center}.thtrm-section__footer,.thtrm-section__header{text-align:center;width:100%;padding:2rem 5vw}.thtrm-section__footer p+a,.thtrm-section__header p+a{display:inline-block;margin-top:2em}.thtrm-section__footer p>a:after,.thtrm-section__header p>a:after{display:none}.thtrm-section__subheading{margin-bottom:1rem}.thtrm-section--offright-white{background-color:var(--thtrm-color-white)}.thtrm-section__item--flushleft,.thtrm-section__item--flushright,.thtrm-section__item--fullwidth,.thtrm-section__item--halfpadded{width:100%}.thtrm-section__item--columns>*{margin-bottom:1rem}.thtrm-section__item--columns{font-size:var(--thtrm-small-fontsize);left:0}.thtrm-section__hero{width:100%;position:relative;margin-top:1rem;padding-top:6.25rem}.thtrm-section__hero .thtrm-section__hero-image{height:6.25rem;width:6.25rem;-o-object-fit:contain;object-fit:contain;position:absolute;left:0;top:0;z-index:var(--thtrm-layer-deco)}@media screen and (min-width:64em){.thtrm-section__hero{padding-left:16rem;margin-top:2rem;padding-top:0}.thtrm-section__hero .thtrm-section__hero-image{height:14rem;width:14rem}}@media screen and (min-width:120em){.thtrm-section__hero{width:75%}}.thtrm-content-box{background-color:var(--thtrm-color-darkblue);color:var(--thtrm-color-white);font-size:var(--thtrm-small-fontsize);padding:2rem;z-index:var(--thtrm-layer-deco)}.thtrm-section-constrained{max-width:800px;margin-left:auto;margin-right:auto;width:100%}@media screen and (min-width:50em){.thtrm-section--fullbleed{margin-left:var(--thtrm-page-neg-margin);margin-right:var(--thtrm-page-neg-margin);height:50vh;min-height:600px}}@media screen and (min-width:43.75em){.thtrm-section,[class^=thtrm-section--]{display:flex;flex-flow:row wrap;position:relative}.thtrm-section .thtrm-section__item,[class^=thtrm-section--] .thtrm-section__item{width:50%}.thtrm-section .thtrm-section__item--halfpadded,[class^=thtrm-section--] .thtrm-section__item--halfpadded{width:calc(50% - 5vw)}.thtrm-section .thtrm-section__item--flushright,[class^=thtrm-section--] .thtrm-section__item--flushright{position:relative;right:var(--thtrm-page-neg-margin);width:calc(50% + 5vw)}.thtrm-section .thtrm-section__item--flushleft,[class^=thtrm-section--] .thtrm-section__item--flushleft{position:relative;left:var(--thtrm-page-neg-margin);width:calc(50% + 5vw)}.thtrm-section .thtrm-section__item--pulldown,[class^=thtrm-section--] .thtrm-section__item--pulldown{position:relative;transform:translateY(50%);z-index:var(--thtrm-layer-deco)}.thtrm-section .thtrm-section__item--flushright-maxed,[class^=thtrm-section--] .thtrm-section__item--flushright-maxed{position:relative;right:var(--thtrm-page-neg-margin);width:calc(50% + 10vw)}.thtrm-section .thtrm-section__item--flushleft-maxed,[class^=thtrm-section--] .thtrm-section__item--flushleft-maxed{position:relative;left:var(--thtrm-page-neg-margin);width:calc(50% + 10vw)}.thtrm-section .thtrm-content-box,[class^=thtrm-section--] .thtrm-content-box{position:absolute;right:0;bottom:0;max-width:70%;transform:translate3d(0,50%,0)}.thtrm-section--undercut-bottom{margin-bottom:-2rem;z-index:var(--thtrm-layer-deco)}.thtrm-section--offright-white{background-color:var(--thtrm-color-white);max-width:70%;position:relative;right:-5%}.thtrm-section--fullbleed{margin-top:6rem}.thtrm-section__item--columns{display:grid;grid-template-columns:50% 50%;font-size:var(--thtrm-small-fontsize)}.thtrm-section__item--columns>*{margin-left:2%;margin-right:2%;-ms-grid-column-span:1}.thtrm-section__item--columns>:nth-child(odd){-ms-grid-column:1}.thtrm-section__item--columns>:nth-child(2n){-ms-grid-column:2}}@media screen and (min-width:64em){.thtrm-section__item--columns{display:grid;grid-template-columns:33% 33% 33%;font-size:var(--thtrm-small-fontsize)}.thtrm-section__item--columns>*{margin-bottom:.75rem}.thtrm-section__item--columns>:nth-child(3n+1){-ms-grid-column:1}.thtrm-section__item--columns>:nth-child(3n+2){-ms-grid-column:2}.thtrm-section__item--columns>:nth-child(3n+3){-ms-grid-column:3}}@media screen and (min-width:80em){.thtrm-section--padded-bottom{margin-bottom:7rem}.thtrm-section--offright-white{max-width:70%}.thtrm-section__footer p{padding-left:4em;padding-right:4em}}@media screen and (min-width:120em){.thtrm-section,[class^=thtrm-section--]{margin-bottom:5rem}.thtrm-section--fullbleed{height:50vh;min-height:700px}.thtrm-section--offright-white{max-width:50%;right:-30%}}.thtrm-stripe{background-color:var(--thtrm-color-lightblue);color:var(--thtrm-color-white);text-align:center;display:flex;flex-flow:column nowrap;align-items:center;justify-content:space-between;padding:1rem 2rem;min-height:140px;margin:auto;position:relative;z-index:var(--thtrm-layer-deco)}.thtrm-stripe .thtrm-stripe__cta,.thtrm-stripe .thtrm-stripe__location,.thtrm-stripe .thtrm-stripe__title{margin:.5rem 0}@media screen and (min-width:50em){.thtrm-stripe{flex-flow:row nowrap;position:absolute;left:var(--thtrm-page-margin);right:var(--thtrm-page-margin);transform:translateY(-50%)}}.thtrm-testimonials{width:90vw;display:block;overflow:hidden}.thtrm-testimonial{position:relative;width:100%;padding-top:1.75rem;font-size:1rem;line-height:1.5;white-space:normal;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.thtrm-testimonial:before{position:absolute;content:"\201C";top:-35px;left:20px;font-size:8rem;color:var(--thtrm-color-text);z-index:9999}.thtrm-testimonial>.thtrm-testimonial__avatar{display:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none}.thtrm-testimonial>.thtrm-testimonial__quote{background-color:var(--thtrm-color-gray);padding:50px 30px 30px}.thtrm-testimonial>.thtrm-testimonial__quote cite{color:var(--thtrm-color-darkblue);font-size:.75em}.thtrm-testimonial--big{position:relative;right:0;margin-left:auto;max-width:100%}.thtrm-testimonial--big>.thtrm-testimonial__quote{background-color:var(--thtrm-color-white);padding:1rem 0 0;font-weight:400;font-style:italic}.thtrm-testimonial--big>.thtrm-testimonial__avatar{max-width:200px}.thtrm-testimonial--big>.thtrm-testimonial__quote cite{color:var(--thtrm-color-darkblue);font-size:.75em;font-style:normal;font-weight:var(--thtrm-base-fontweight);margin-top:.5rem}.thtrm-testimonial--big .thtrm-testimonial__heading{font-weight:var(--thtrm-base-fontweight);font-style:normal;margin-bottom:1rem}.thtrm-testimonials__navigation{margin-top:.5rem;text-align:center;width:100%}.thtrm-testimonials__thumbnail{width:50px;height:50px;-o-object-fit:cover;object-fit:cover;opacity:.5;font-family:"object-fit: cover;"}.is-active .thtrm-testimonials__thumbnail{opacity:1;transition:.25s}@media screen and (min-width:50em){.thtrm-testimonial{position:relative;width:100%;padding-top:50px}.thtrm-testimonial>.thtrm-testimonial:before{top:-65px;left:0;font-size:10rem}.thtrm-testimonials__thumbnail{width:100px;height:100px}.thtrm-testimonial>.thtrm-testimonial__quote{padding:68px 68px 68px 210px;max-width:80%;position:relative;left:10%;top:0;z-index:98;margin-top:40px}.thtrm-testimonial>.thtrm-testimonial__avatar{display:block;position:absolute;left:3%;top:40px;max-width:240px;z-index:99}.thtrm-testimonial--big{position:relative;right:0;margin-left:auto;top:-300px;max-width:55%;margin-bottom:-300px}.thtrm-testimonial--big>.thtrm-testimonial__quote{background-color:var(--thtrm-color-white);padding:2rem 3rem 0;font-weight:400;font-style:italic;font-size:1.25rem}.thtrm-testimonial--big>.thtrm-testimonial__avatar{position:absolute;bottom:0;left:-200px;max-width:200px}.thtrm-testimonial--big>.thtrm-testimonial__quote cite{color:var(--thtrm-color-darkblue);font-size:.75em;font-style:normal;font-weight:var(--thtrm-base-fontweight);margin-top:.5rem}.thtrm-testimonial--big .thtrm-testimonial__heading{font-weight:var(--thtrm-base-fontweight);font-style:normal;margin-bottom:1rem}}@media screen and (min-width:80em){.thtrm-testimonials{width:80vw}}.thtrm-testimonials .frame{width:100%;position:relative;font-size:0;line-height:0;overflow:hidden;white-space:nowrap}.thtrm-testimonials .slides{display:block}.thtrm-testimonials li{cursor:grab;cursor:-webkit-grab}.thtrm-testimonials li,.thtrm-testimonials li:active{position:relative;display:inline-block;width:100%;vertical-align:top}.thtrm-testimonials li:active{cursor:grabbing;cursor:-webkit-grabbing}.thtrm-teaser{display:flex;flex-direction:column}.thtrm-teaser img{display:block}.thtrm-teaser--row{align-items:flex-start;flex-direction:row;justify-content:space-between}.thtrm-teaser--row .thtrm-teaser__thumb{display:none;margin-top:0;width:160px}@media screen and (min-width:64em){.thtrm-teaser--row .thtrm-teaser__thumb{display:block}}.thtrm-teaser__thumb{margin-top:12px}.thtrm-teaser__title{margin-top:4px}.thtrm-teaser__paragraph{margin-top:8px}.thtrm-teaser__link{margin-top:12px}.thtrm-raw-link{color:var(--thtrm-color-text)}.thtrm-raw-link:hover{color:var(--thtrm-color-midblue)}.thtrm-raw-link:after{display:none}.thtrm-listing{display:flex;flex-direction:column;width:100%}.thtrm-listing__item{margin-top:24px;padding-top:24px;border-top:1px solid var(--thtrm-border-color)}.thtrm-page--yellow .thtrm-listing__item{border-top-color:#000}.thtrm-topic{font-size:var(--thtrm-small-fontsize)}.thtrm-title{font-size:var(--thtrm-h4-fontszize)}.thtrm-article{font-weight:300}.thtrm-article h2,.thtrm-article h3,.thtrm-article h4{margin-top:48px;font-weight:500}.thtrm-article h2:first-child,.thtrm-article h3:first-child,.thtrm-article h4:first-child{margin-top:0}.thtrm-article h2 code,.thtrm-article h3 code,.thtrm-article h4 code{margin:0;padding:0;background:transparent!important;color:inherit;font-family:inherit;font-size:inherit;line-height:inherit;text-shadow:inherit}.thtrm-article a:after{display:none}.thtrm-article p{margin-top:24px;font-size:.8rem}.thtrm-article p code{background-color:var(--thtrm-color-gray)!important;color:var(--thtrm-color-midblue)!important;text-shadow:none!important}.thtrm-article p:first-child{margin-top:0}.thtrm-article ol,.thtrm-article ul{margin-top:24px;padding-left:24px;font-size:.8rem}.thtrm-article ol li,.thtrm-article ul li{margin-top:12px}.thtrm-article ol li code,.thtrm-article ul li code{background-color:var(--thtrm-color-gray);color:var(--thtrm-color-midblue)}.thtrm-article ol li:first-child,.thtrm-article ul li:first-child{margin-top:0}.thtrm-article .gatsby-highlight{margin-top:24px;font-size:.65rem}.thtrm-article code{font-size:.65rem}.thtrm-article iframe{margin-top:24px;width:100%;min-height:400px}.thtrm-article-thumb{margin-bottom:32px}.thtrm-article-caption{margin-top:-16px;font-size:.6rem;width:100%;text-align:right}.thtrm-article-caption a:after{display:none}.thtrm-article-header{text-align:center}.thtrm-article-header,.thtrm-article-header__metabar,.thtrm-media{justify-content:center}.thtrm-media{align-items:center;display:grid;grid-template-rows:auto 1fr;text-align:center}@media screen and (min-width:64em){.thtrm-media{align-items:center;grid-template-columns:200px 1fr;grid-template-rows:none;justify-content:flex-start;text-align:left}}.thtrm-media__asset{margin:0 auto;max-width:200px}@media screen and (min-width:64em){.thtrm-media__asset{grid-column:1;max-width:none}}@media screen and (min-width:64em){.thtrm-media__body{grid-column:2}}.thtrm-media--top-start{align-items:flex-start}.thtrm-media-short{display:flex;flex-direction:row}.thtrm-media-short__body{padding-left:8px}.thtrm-avatar{height:25px;width:25px;border-radius:150px}.thtrm-metabar{flex-wrap:wrap;margin-top:-12px}.thtrm-metabar,.thtrm-metabar__item{align-items:center;display:flex;flex-direction:row}.thtrm-metabar__item{margin-top:4px}.thtrm-metabar__item:after{content:"/ ";padding:0 8px}.thtrm-metabar__item:last-child:after{display:none}.u-text--centered{text-align:center}.u-flex{align-items:center;display:flex;flex-direction:row}.u-flex--start{align-items:flex-start}.u-link-plain:after{display:none}.u-flex--nowrap{flex-wrap:nowrap}.u-flex--justify-center{justify-content:center}.u-flex--justify-end{justify-content:flex-end}.u-distance-reset{margin-top:0!important}.u-distance-tiny{margin-top:8px}.u-distance-small{margin-top:16px}.u-distance{margin-top:24px}.u-distance-medium{margin-top:48px}.u-distance-large{margin-top:100px}.u-distance-bottom-reset{margin-bottom:0!important}.u-unflex{display:block}.u-text--bigger{font-size:2em;line-height:1}.u-text--small{font-size:var(--thtrm-small-fontsize)}.u-min-h1{min-height:712px}.u-img-fit-height{height:100%;-o-object-fit:cover;object-fit:cover;font-family:"object-fit: cover;"}.u-mega-padding-bottom{margin-bottom:200px}.u-offscreen-text{position:absolute;left:-5000px}.u-fill-space{height:100%;width:100%}.u-color--red{color:var(--thtrm-amc-red)}.u-color--pink{color:var(--thtrm-rxjs-pink)}.u-color--grey{color:var(--thtrm-color-lighttext)}.u-bg-lightgray{background-color:var(--thtrm-color-ultralightgray)}.u-bg--red{background-color:var(--thtrm-amc-red)}.u-bg--pink{background-color:var(--thtrm-rxjs-pink)}.u-bg--orange{background-color:var(--thtrm-git-orange)}.u-color--orange{color:var(--thtrm-git-orange)}@media screen and (min-width:50em){.u-max-width--half{max-width:50%;margin:0 auto;width:100%}}@media screen and (min-width:50em){.u-max-width--3-4{max-width:75%;margin:0 auto;width:100%}}</style><style data-href="/styles.246d67a4ef7e9adeefa5.css">code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#f8f8f2}.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.15.21"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#384c54"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=50794189bf1d1bd3459211725d37e57e"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=50794189bf1d1bd3459211725d37e57e"/><title data-react-helmet="true">Testing Angular Directives with Custom Matchers | Articles by thoughtram</title><meta data-react-helmet="true" name="description" content="Deliver terse, DRY, self-documenting unit tests with Angular using custom Jasmine Matchers and  Helper functions."/><meta data-react-helmet="true" name="google-site-verification" content="o9eGPEgIETEqYGombq7NiQuBIB_qa6gz1yAL7PxKyK0"/><meta data-react-helmet="true" name="theme-color" content="#384c54"/><meta data-react-helmet="true" property="og:title" content="Testing Angular Directives with Custom Matchers"/><meta data-react-helmet="true" property="og:description" content="Deliver terse, DRY, self-documenting unit tests with Angular using custom Jasmine Matchers and  Helper functions."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="thoughtram"/><meta data-react-helmet="true" name="twitter:title" content="Testing Angular Directives with Custom Matchers"/><meta data-react-helmet="true" name="twitter:description" content="Deliver terse, DRY, self-documenting unit tests with Angular using custom Jasmine Matchers and  Helper functions."/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-6a14d6c49d22aa388ff9.js"/><link as="script" rel="preload" href="/styles-e0e38ca7b54561c3f057.js"/><link as="script" rel="preload" href="/commons-9a6c7e4a80f98fe6d0b9.js"/><link as="script" rel="preload" href="/app-db11fdec89ef44788bcc.js"/><link as="script" rel="preload" href="/webpack-runtime-c99afa6b532686815600.js"/><link as="fetch" rel="preload" href="/page-data/angular/2016/12/27/angular-2-advance-testing-with-custom-matchers.html/page-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="thtrm-page undefined"><header class="thtrm-banner" role="banner"><a href="https://thoughtram.io" title="Home"><img src="/static/logo-8fe34043fb96d58a991170a33702a469.svg" alt="thoughtram" class="thtrm-logo" title="The thoughtram logo"/></a></header><main class="thtrm-main" role="main"><nav class="thtrm-nav-toc"><a title="Back to Blog" href="/">← Back to Blog</a></nav><div style="margin:auto;text-align:center;min-height:30px" id="codefund"></div><script type="text/javascript" src="https://app.codefund.io/properties/723/funder.js" async=""></script><section class="thtrm-section u-distance-bottom-reset"><div class="thtrm-section__heading thtrm-article-header thtrm-section-constrained u-distance-bottom-reset"><div class="thtrm-metabar thtrm-article-header__metabar"><div class="thtrm-metabar__item thtrm-topic u-color--grey"><div class="thtrm-media-short"><img alt="Author" src="https://avatars3.githubusercontent.com/u/210413?s=400&amp;v=4" class="thtrm-avatar"/><p class="thtrm-media-short__body"><a href="https://twitter.com/thomasburleson" class="u-link-plain">Thomas Burleson</a></p></div></div><time dateTime="27 December 2016" class="thtrm-metabar__item thtrm-topic u-color--grey">27 December 2016</time><p class="thtrm-metabar__item thtrm-topic u-color--grey"><a class="u-link-plain" href="/categories/angular">Angular</a></p></div><h1 class="thtrm-section__subheading u-distance-tiny">Testing Angular Directives with Custom Matchers</h1></div><div class="thtrm-ratio--stripe thtrm-article-thumb u-fill-space u-img-fit-height gatsby-image-wrapper" style="position:relative;overflow:hidden"><div style="width:100%;padding-bottom:67.37373737373737%"></div><img src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAFdMjRJhX//xAAZEAACAwEAAAAAAAAAAAAAAAACIQABAxL/2gAIAQEAAQUCyBcQheZK7hW//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAEhIP/aAAgBAQAGPwKFef/EABgQAQEBAQEAAAAAAAAAAAAAAAERACFR/9oACAEBAAE/IaYQQlfcd5jjJZl3/9oADAMBAAIAAwAAABB7D//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EGf/xAAZEAEBAQEBAQAAAAAAAAAAAAABEQAhQVH/2gAIAQEAAT8QTk6FzMmPHRsmKRE+7tU55gSUDsuub//Z" alt="" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/9633e131aa37bdc19daab3031453bfae/10bdc/testing-directives-with-custom-matchers2.jpg 158w,
/static/9633e131aa37bdc19daab3031453bfae/f4ab0/testing-directives-with-custom-matchers2.jpg 315w,
/static/9633e131aa37bdc19daab3031453bfae/30037/testing-directives-with-custom-matchers2.jpg 630w,
/static/9633e131aa37bdc19daab3031453bfae/9810d/testing-directives-with-custom-matchers2.jpg 945w,
/static/9633e131aa37bdc19daab3031453bfae/ccfd2/testing-directives-with-custom-matchers2.jpg 990w" sizes="(max-width: 630px) 100vw, 630px" /><img loading="lazy" sizes="(max-width: 630px) 100vw, 630px" srcset="/static/9633e131aa37bdc19daab3031453bfae/10bdc/testing-directives-with-custom-matchers2.jpg 158w,
/static/9633e131aa37bdc19daab3031453bfae/f4ab0/testing-directives-with-custom-matchers2.jpg 315w,
/static/9633e131aa37bdc19daab3031453bfae/30037/testing-directives-with-custom-matchers2.jpg 630w,
/static/9633e131aa37bdc19daab3031453bfae/9810d/testing-directives-with-custom-matchers2.jpg 945w,
/static/9633e131aa37bdc19daab3031453bfae/ccfd2/testing-directives-with-custom-matchers2.jpg 990w" src="/static/9633e131aa37bdc19daab3031453bfae/30037/testing-directives-with-custom-matchers2.jpg" alt="" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></section><section class="thtrm-section thtrm-section-constrained thtrm-article u-distance"><div class="thtrm-section__heading u-distance-reset"><h2>Preface</h2>
<p>A few weeks ago, Pascal Precht wrote a blog article on
<a href="http://blog.thoughtram.io/angular/2016/11/28/testing-services-with-http-in-angular-2.html">Testing Services with HTTP with Angular</a>.
In this article, we want to discuss more advanced topics on DRY Angular testing techniques
using <strong>Custom Matchers</strong> and <strong>Special Helpers</strong>.</p>
<p>These are techniques to make your unit-tests incredibly easy to read and to maintain. And to achieve
our learning goals, there are three (3) important testing topics that we want to cover:</p>
<ul>
<li>(1) <a href="#testing-directives">Testing custom Angular <strong>Directives</strong></a></li>
<li>(2) <a href="#testing-with-helpers">Building reusable, DRY TestBed <strong>Helper</strong> methods</a></li>
<li>(3) <a href="#custom-matchers">Using Typescript Jasmine <strong>Custom Matchers</strong></a></li>
</ul>
<blockquote>
<p>These techniques are practically undocumented… yet they dramatically improve the quality of
our tests.</p>
</blockquote>
<p>To whet your appetite, here are some sample DRY tests that we will be showing you how to write:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 750px;"
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 58.80000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAEDBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB5iBezk//xAAZEAACAwEAAAAAAAAAAAAAAAAAARARMRL/2gAIAQEAAQUCFr7i6NP/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAbEAACAQUAAAAAAAAAAAAAAAAAATEQITJxkf/aAAgBAQAGPwIsYrlIT2Qf/8QAGhAAAwADAQAAAAAAAAAAAAAAAAERITGBQf/aAAgBAQABPyHrNEV0S8q4LBb+ANprCviP/9oADAMBAAIAAwAAABAgH//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQEAAgMBAAAAAAAAAAAAAAERACExQXFh/9oACAEBAAE/ELzdH3Nj0qDEXxwWxTrNVA6cqVbqUMQd2jA8z//Z'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Unit Test with Matchers and Helpers"
        title="Unit Test with Matchers and Helpers"
        src="/static/e2c7232dc0a42035fe23169d13b38803/a66cd/example1.jpg"
        srcset="/static/e2c7232dc0a42035fe23169d13b38803/f544b/example1.jpg 200w,
/static/e2c7232dc0a42035fe23169d13b38803/41689/example1.jpg 400w,
/static/e2c7232dc0a42035fe23169d13b38803/a66cd/example1.jpg 750w"
        sizes="(max-width: 750px) 100vw, 750px"
        loading="lazy"
      />
    </span></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 749px;"
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 55.80774365821095%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB5sqxGon/xAAaEAACAgMAAAAAAAAAAAAAAAABAgAQMTJB/9oACAEBAAEFAp0gUmz5/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAgMBAAAAAAAAAAAAAAAAADEBEBFR/9oACAEBAAY/Ajg9tQf/xAAbEAEAAwADAQAAAAAAAAAAAAABABExIUFxUf/aAAgBAQABPyE12ANFB9YB4PgY7M7B9hK0HHRP/9oADAMBAAIAAwAAABBz3//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAQACAgIDAAAAAAAAAAAAAAEAETFBIVFxkbH/2gAIAQEAAT8QS2W8MNpGha9Q0DVkH0maATA54AmOmBoDQTb1P//Z'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Testing Nested DOM Styles"
        title="Testing Nested DOM Styles"
        src="/static/b06d232ad362dd0ce6f2da7e43b805a0/bbc52/example2.jpg"
        srcset="/static/b06d232ad362dd0ce6f2da7e43b805a0/f544b/example2.jpg 200w,
/static/b06d232ad362dd0ce6f2da7e43b805a0/41689/example2.jpg 400w,
/static/b06d232ad362dd0ce6f2da7e43b805a0/bbc52/example2.jpg 749w"
        sizes="(max-width: 749px) 100vw, 749px"
        loading="lazy"
      />
    </span></p>
<h2>Background</h2>
<p>There a several excellent resources already available that developers can read to
learn about Angular testing:</p>
<ul>
<li><a href="https://medium.com/google-developer-experts/angular-2-testing-guide-a485b6cb1ef0#.2ytwy9k9w">Angular 2 - Testing Guide</a> (by <a href="https://twitter.com/gerardsans">Gerard Sans</a>)</li>
<li><a href="https://medium.com/google-developer-experts/angular-2-unit-testing-with-jasmine-defe20421584#.cmk3cg9bc">Angular 2 - Unit Testing Recipes</a> (by <a href="https://twitter.com/gerardsans">Gerard Sans</a>)</li>
<li><a href="https://www.sitepoint.com/angular-2-tutorial/?utm_campaign=NG-Newsletter&#x26;utm_medium=email&#x26;utm_source=NG-Newsletter_180">Testing with the Angular CLI</a>
(by <a href="https://twitter.com/toddmotto">Todd Motto</a>, <a href="https://twitter.com/jvandemo">Jurgen Van de Moere</a>)</li>
<li><a href="http://chariotsolutions.com/blog/post/testing-angular-2-components-unit-tests-testcomponentbuilder/">Testing Angular 2 Components</a> (by <a href="https://twitter.com/krimple">Ken Rimple</a>)</li>
</ul>
<p>The biggest take-aways from these articles is the singular concept that instead of manually
instantiating and testing classes, Angular developers <u>should consider using</u>
the <code class="language-text">TestBed.configureTestingModule()</code> to prepare an entire test Angular DI <strong>environment</strong> for each
test module (*.spec.ts).</p>
<blockquote>
<p>We would not use <code class="language-text">TestBed.configureTestingModule()</code> when we are testing a service that
doesn’t have any dependencies. It’d be easier and less verbose to just instantiate using <code class="language-text">new</code>. The
<strong>TestBed</strong> is for useful for dependencies and injections.</p>
</blockquote>
<h2>Traditional Testing</h2>
<p>Consider the traditional approach of manually instantiating and testing a Service or component:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ServiceA <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./services/ServiceA'</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'ServiceA'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should emit greeting event'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> inst <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServiceA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    inst<span class="token punctuation">.</span>greeting<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">g</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
       <span class="token function">expect</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>greeting<span class="token punctuation">:</span><span class="token string">'hello'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    inst<span class="token punctuation">.</span><span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>It’s fine to do it this way, because <strong>ServiceA</strong> obviously does not need anything
else to be instantiated; it is a self-contained service without external dependencies. </p>
<blockquote>
<p>So assuming that this service won’t get any dependencies in the future, this test is the one we want to write.  </p>
</blockquote>
<h2>Introducing Angular TestBed</h2>
<p>The Angular <strong>TestBed</strong> allows developers to configure <strong>ngModules</strong> that provide instances/values and use
Dependency Injection. This is the same approach developers use in their regular Angular applications. </p>
<p>With the <strong>TestBed</strong> and its support for for component-lifecycle features, Angular components can be
easily instantiated and tested. Here is an example - shown below - that we will continue to
use in this article:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> MyComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./viewer/MyComponent'</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Configure testbed to register components and prepare services
 */</span>
<span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  TestBed<span class="token punctuation">.</span><span class="token function">configureTestingModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    imports<span class="token punctuation">:</span> <span class="token punctuation">[</span> FlexLayoutModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
    declarations<span class="token punctuation">:</span> <span class="token punctuation">[</span>MyComponent<span class="token punctuation">]</span><span class="token punctuation">,</span>
    
    <span class="token comment">// 'MatchMedia' construction requires BreakPointRegistry</span>
    <span class="token comment">// 'MyComponent' construction requires MatchMedia parameter</span>
    
    providers<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      BreakPointRegistry<span class="token punctuation">,</span>
      BreakPointsProvider<span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        provide<span class="token punctuation">:</span> MatchMedia<span class="token punctuation">,</span>
        useClass<span class="token punctuation">:</span> MockMatchMedia
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Helper function to easily build a component Fixture using the specified template
 */</span>
<span class="token keyword">function</span> <span class="token function">createTestComponent</span><span class="token punctuation">(</span><span class="token parameter">template<span class="token punctuation">:</span> string</span><span class="token punctuation">)</span><span class="token punctuation">:</span> ComponentFixture<span class="token operator">&lt;</span>Type<span class="token operator">&lt;</span>any<span class="token operator">>></span>
<span class="token punctuation">{</span>
  <span class="token keyword">return</span> TestBed
    <span class="token punctuation">.</span><span class="token function">overrideComponent</span><span class="token punctuation">(</span>MyComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>template<span class="token punctuation">:</span> template<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">createComponent</span><span class="token punctuation">(</span>MyComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Before each test, we want configure a new, fresh testing module with <u>only</u> the providers,
components, and directives we <u>need for the current test module</u>. </p>
<blockquote>
<p>And notice that we just created a reusable <strong>Helper</strong> function: <code class="language-text">createTestComponent()</code>.
This cool utility function will construct an instance of MyComponent [using the configured TestBed]
using any custom HTML template you specify. </p>
</blockquote>
<p>At first, this complexity may seem like overkill. But let’s consider two critical requirements
shown in the sample above:</p>
<ul>
<li><strong>MatchMedia</strong> instantiation requires an injected <strong>BreakPointRegistry</strong> instance</li>
<li><strong>MyComponent</strong> instantiation requires an injected <strong>MatchMedia</strong> instance</li>
</ul>
<p>Even with these requirements, testing developers should NOT have to worry about all those internals just
to test <strong>MyComponent</strong>. Using ngModule, DI, and Angular… we now don’t have to worry about those
details.</p>
<p>This is just like those real-world scenarios where our components, directives, and services will
have complex dependencies upon providers and non-trivial construction processes. </p>
<p>And this is where <strong>TestBed</strong> demonstrates its real value!</p>
<blockquote>
<p>We are not using external templates nor any other resources or services that are asynchronous.
So we do not discuss the <code class="language-text">async()</code> nor the the <code class="language-text">TestBed::compileComponents()</code> functions. </p>
</blockquote>
<h2>1) Testing Directives</h2>
<p>With relative ease, developers can find literature on testing Angular Services and Components.
Yet the <u>How-to’s for testing Directives</u> is oddly not well documented.</p>
<p>Unlike Components with their associated templates, Directives do not have templates. This means
that we <strong>cannot</strong> simply import a Directive and manually instantiate it. </p>
<p>The solution is rather easy! We only need to:</p>
<ul>
<li>configure a TestBed that imports and declares the directive(s),</li>
<li>prepare a shell test Component, and</li>
<li>use a custom template which uses the Directive selector(s) as attribute(s).</li>
</ul>
<p>Since Directives usually affect the <strong>host element</strong>, our tests will check if those changes to the host
element are present and valid.</p>
<p>So let’s use the Angular <a href="http://github.com/angular/flex-layout">Flex-Layout</a> library as the basis
for the following discussions on Directives, Matchers, and TestBed Helpers.</p>
<blockquote>
<p>Real-world solutions often provide great examples for reusable techniques.</p>
</blockquote>
<p>We will be using both the <strong>fxLayout</strong> directive and excerpts from the unit test for that directive
to explore testing ideas, techniques, and solutions that we can also use in our own tests.</p>
<p>First, let’s import the FlexLayout library into our own tests and prepare to test the <em>fxLayout</em>
directive.</p>
<blockquote>
<p>You can see the actual testing code in <a href="https://github.com/angular/flex-layout/blob/master/src/lib/flexbox/api/layout.spec.ts">layout.spec.ts</a>.
<br/>But <strong>don’t</strong> jump there yet! Wait until you have finished reading this article.</p>
</blockquote>
<h3>Configuring the TestBed</h3>
<p>Very similar to the TestBed sample shown above, we will configure a testing module but we will
not <em>import</em> an external test component. My test component <code class="language-text">TestLayoutComponent</code> is itself defined
within our test (*.spec.ts) module.</p>
<blockquote>
<p>Using an internal test component enables each test module <br/>e.g. <br/><code class="language-text">&lt;directive&gt;.spec.ts</code><br/> to define
and use its own custom test component with custom properties.</p>
</blockquote>
<p>Here is the initial configuration:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> OnInit<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ComponentFixture<span class="token punctuation">,</span> TestBed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core/testing'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  FlexLayoutModule<span class="token punctuation">,</span>
  MockMatchMedia<span class="token punctuation">,</span>
  MatchMedia<span class="token punctuation">,</span>
  BreakPointsProvider<span class="token punctuation">,</span>
  BreakPointRegistry
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/flex-layout'</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'layout directive'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>

  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>

    <span class="token comment">// Configure testbed to prepare services</span>
    TestBed<span class="token punctuation">.</span><span class="token function">configureTestingModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      imports<span class="token punctuation">:</span> <span class="token punctuation">[</span>FlexLayoutModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      declarations<span class="token punctuation">:</span> <span class="token punctuation">[</span>TestLayoutComponent<span class="token punctuation">]</span><span class="token punctuation">,</span>
      providers<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        BreakPointRegistry<span class="token punctuation">,</span> BreakPointsProvider<span class="token punctuation">,</span>
        <span class="token punctuation">{</span>provide<span class="token punctuation">:</span> MatchMedia<span class="token punctuation">,</span> useClass<span class="token punctuation">:</span> MockMatchMedia<span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should add correct styles for default `fxLayout` usage'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
			<span class="token comment">// TEST LOGIC HERE</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
 * Shell component with property 'direction' that will be used
 * with our tests
 */</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token punctuation">:</span> <span class="token string">'test-layout'</span><span class="token punctuation">,</span>
  template<span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;span>PlaceHolder HTML to be Replaced&lt;/span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">TestLayoutComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
  direction <span class="token operator">=</span> <span class="token string">"column"</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token punctuation">}</span>
  <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
 * Custom Helper function to quickly create a `fixture` instance based on
 * the 'TestLayoutComponent' class
 */</span>
<span class="token keyword">function</span> <span class="token function">createTestComponent</span><span class="token punctuation">(</span><span class="token parameter">template<span class="token punctuation">:</span> string</span><span class="token punctuation">)</span><span class="token punctuation">:</span> ComponentFixture<span class="token operator">&lt;</span>TestLayoutComponent<span class="token operator">></span>
<span class="token punctuation">{</span>
  <span class="token keyword">return</span> TestBed
    <span class="token punctuation">.</span><span class="token function">overrideComponent</span><span class="token punctuation">(</span>TestLayoutComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>template<span class="token punctuation">:</span> template<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">createComponent</span><span class="token punctuation">(</span>TestLayoutComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>We now have everything we need to write a Directive test quickly.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should compile with custom directives'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> fixture <span class="token operator">=</span> <span class="token function">createTestComponent</span><span class="token punctuation">(</span><span class="token string">'&lt;div fxLayout>&lt;/div>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span> fixture <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeDefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Wow! That is pretty easy. </p>
<blockquote>
<p>The component has been constructed and prepared with the same
processes and DI that your real world application will use.</p>
</blockquote>
<p>Let’s first write our test using the traditional long-form… one without custom matchers and the
more advanced helper methods.</p>
<p>Since the <strong>fxLayout</strong> directive will add custom flexbox CSS to the host element, our test logic
here will confirm that the initial CSS is correctly assigned.</p>
<h3>Non-DRY Testing</h3>
<p>The traditional approach would probably implement something like this:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should add correct styles for `fxLayout` with template bindings'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> template <span class="token operator">=</span> <span class="token string">'&lt;div [fxLayout]="direction">&lt;/div>'</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> fixture <span class="token operator">=</span> <span class="token function">createTestComponent</span><span class="token punctuation">(</span>template<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> el <span class="token operator">=</span> fixture<span class="token punctuation">.</span>debugElement<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nativeElement<span class="token punctuation">;</span>
  
    fixture<span class="token punctuation">.</span><span class="token function">detectChanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
  <span class="token function">expect</span><span class="token punctuation">(</span> el<span class="token punctuation">.</span>style<span class="token punctuation">[</span><span class="token string">'display'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'flex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span> el<span class="token punctuation">.</span>style<span class="token punctuation">[</span><span class="token string">'box-sizing'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'border-box'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span> el<span class="token punctuation">.</span>style<span class="token punctuation">[</span><span class="token string">'flex-direction'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'column'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    fixture<span class="token punctuation">.</span>componentInstance<span class="token punctuation">.</span>direction <span class="token operator">=</span> <span class="token string">'row'</span><span class="token punctuation">;</span>
    fixture<span class="token punctuation">.</span><span class="token function">detectChanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
  <span class="token function">expect</span><span class="token punctuation">(</span> el<span class="token punctuation">.</span>style<span class="token punctuation">[</span><span class="token string">'flex-direction'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'row'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>In the code above, we </p>
<ul>
<li>defined a custom template with bindings to the component property <code class="language-text">direction</code>, </li>
<li>use deeply nested references to get access to the native element,</li>
<li>test each style individually.</li>
</ul>
<p>All this in one (1) single test. And truly it is not easily read. </p>
<p>Now imagine that our test module has more than 20 individual <code class="language-text">it(...)</code> tests!</p>
<blockquote>
<p>That would be a lot of duplicate code. <br/> And there is certainly nothing DRY (“do not repeat yourself”) about
such code! </p>
</blockquote>
<h2>2) Testing with Helpers</h2>
<p>Above we explored the standard approach to implementing unit tests… an approach which resulted
in verbose, non-reusable code.</p>
<p>Let’s contrast that with the DRY version that we want:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 748px;"
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 55.3475935828877%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAUBAgP/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABWFdSBiJ//8QAGxAAAgEFAAAAAAAAAAAAAAAAAAMCARASITH/2gAIAQEAAQUCOmNLK2ySoH//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPwFX/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGBAAAgMAAAAAAAAAAAAAAAAAAAECEDL/2gAIAQEABj8CrcaimZP/xAAaEAEBAQADAQAAAAAAAAAAAAABABEhUWHx/9oACAEBAAE/Id9jli4ds/QtgGNFgJgv/9oADAMBAAIAAwAAABBz7//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QH//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/EEf/xAAdEAEAAgICAwAAAAAAAAAAAAABABEhQTFxkaHh/9oACAEBAAE/ENrUQJWeVo8QbhuvmKHDBRUiO8SijZfuf//Z'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Testing Directives - DRY Code"
        title="Testing Directives - DRY Code"
        src="/static/45aad0c3439bbd0a58bf296298d6b730/9ae42/example3.jpg"
        srcset="/static/45aad0c3439bbd0a58bf296298d6b730/f544b/example3.jpg 200w,
/static/45aad0c3439bbd0a58bf296298d6b730/41689/example3.jpg 400w,
/static/45aad0c3439bbd0a58bf296298d6b730/9ae42/example3.jpg 748w"
        sizes="(max-width: 748px) 100vw, 748px"
        loading="lazy"
      />
    </span></p>
<p>Now this test is much more readable, maintainable, and DRY. We hide all the
complexities of:</p>
<ul>
<li>forcing change detection, </li>
<li>accessing the native element, and </li>
<li>confirming  1…n DOM CSS styles </li>
</ul>
<p>Those complexities are now encapsulated in a Helper function and a Custom Matcher (respectively). </p>
<p>The custom Helper function <strong>expectNativeEl( )</strong> is similar to the standard <strong>expect( )</strong> function.
In fact, it is wrapper function that internalizes the <code class="language-text">expect( )</code> call. </p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">/**
 * Note: this helper only accesses the 1st-level child within a component
 *       A different helper method is need to access deep-level DOM nodes
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">expectNativeEl</span><span class="token punctuation">(</span><span class="token parameter">fixture<span class="token punctuation">:</span> ComponentFixture<span class="token operator">&lt;</span>any<span class="token operator">></span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> any <span class="token punctuation">{</span>
  fixture<span class="token punctuation">.</span><span class="token function">detectChanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Return response of `expect(...)`</span>
  <span class="token keyword">return</span> <span class="token function">expect</span><span class="token punctuation">(</span>fixture<span class="token punctuation">.</span>debugElement<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nativeElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<blockquote>
<p>It is important to note that these helper methods always return the value of an <code class="language-text">expect(...)</code> call!</p>
</blockquote>
<p>And the resulting code change uses a similar notation to our standard training. So</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">expect(...).toBe</code></pre></div>
<p>becomes</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">expectNativeEl(...).toBe</code></pre></div>
<h3>Testing Nested DOM</h3>
<p>For more complex DOM access, we can use the DebugElement’s query feature to select nested DOM nodes. </p>
<p>Angular’s <strong>DebugElement</strong> has several query features:</p>
<ul>
<li><code class="language-text">query(predicate: Predicate&lt;DebugElement&gt;): DebugElement;</code></li>
<li><code class="language-text">queryAll(predicate: Predicate&lt;DebugElement&gt;): DebugElement[];</code></li>
<li><code class="language-text">queryAllNodes(predicate: Predicate&lt;DebugNode&gt;): DebugNode[];</code></li>
</ul>
<blockquote>
<p>Please note that all debugging apis are currently experimental.</p>
</blockquote>
<p>Consider the following helper function <strong>expectDomForQuery( )</strong>:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 749px;"
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 55.80774365821095%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB5sqxGon/xAAaEAACAgMAAAAAAAAAAAAAAAABAgAQMTJB/9oACAEBAAEFAp0gUmz5/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAgMBAAAAAAAAAAAAAAAAADEBEBFR/9oACAEBAAY/Ajg9tQf/xAAbEAEAAwADAQAAAAAAAAAAAAABABExIUFxUf/aAAgBAQABPyE12ANFB9YB4PgY7M7B9hK0HHRP/9oADAMBAAIAAwAAABBz3//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAQACAgIDAAAAAAAAAAAAAAEAETFBIVFxkbH/2gAIAQEAAT8QS2W8MNpGha9Q0DVkH0maATA54AmOmBoDQTb1P//Z'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="pic6"
        title="pic6"
        src="/static/b06d232ad362dd0ce6f2da7e43b805a0/bbc52/example2.jpg"
        srcset="/static/b06d232ad362dd0ce6f2da7e43b805a0/f544b/example2.jpg 200w,
/static/b06d232ad362dd0ce6f2da7e43b805a0/41689/example2.jpg 400w,
/static/b06d232ad362dd0ce6f2da7e43b805a0/bbc52/example2.jpg 749w"
        sizes="(max-width: 749px) 100vw, 749px"
        loading="lazy"
      />
    </span></p>
<p>In this example, we actually want to test the <u>nested DOM node</u> that hosts the attribute <strong>fxFlex</strong>.
Using another helper method <strong>expectDomForQuery( )</strong> makes that easy.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">/**
 * Create component instance using custom template, the query for the native DOM node
 * based on the query selector
 */</span>
<span class="token keyword">function</span> <span class="token function">expectDomForQuery</span><span class="token punctuation">(</span><span class="token parameter">template<span class="token punctuation">:</span>string<span class="token punctuation">,</span> selector<span class="token punctuation">:</span>string</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> any <span class="token punctuation">{</span>
  <span class="token keyword">let</span> fixture <span class="token operator">=</span> <span class="token function">createTestComponent</span><span class="token punctuation">(</span>template<span class="token punctuation">)</span><span class="token punctuation">;</span>
      fixture<span class="token punctuation">.</span><span class="token function">detectChanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Return response of `expect(...)`</span>
  <span class="token keyword">return</span> <span class="token function">expect</span><span class="token punctuation">(</span> <span class="token function">queryFor</span><span class="token punctuation">(</span>fixture<span class="token punctuation">,</span>selector<span class="token punctuation">)</span><span class="token punctuation">.</span>nativeElement <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Don't forget to import the `By` utilities
 */</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>By<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/platform-browser'</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Reusable Query helper function
 */</span>
<span class="token keyword">function</span>  <span class="token function">queryFor</span><span class="token punctuation">(</span><span class="token parameter">fixture<span class="token punctuation">:</span>ComponentFixture<span class="token operator">&lt;</span>any<span class="token operator">></span><span class="token punctuation">,</span> selector<span class="token punctuation">:</span>string</span><span class="token punctuation">)</span><span class="token punctuation">:</span>any <span class="token punctuation">{</span>
  <span class="token keyword">return</span> fixture<span class="token punctuation">.</span>debugElement<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>And the resulting code change is again a similar notation to our standard training:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">expect</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">.</span>toBe</code></pre></div>
<p>becomes</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">expectDomForQuery</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">.</span>toBe</code></pre></div>
<h3>More Special Helpers</h3>
<p>Earlier, we showed a code snapshot that had a <em>special helper</em> <code class="language-text">activateMediaQuery( )</code>:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 750px;"
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 58.80000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAEDBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB5iBezk//xAAZEAACAwEAAAAAAAAAAAAAAAAAARARMRL/2gAIAQEAAQUCFr7i6NP/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAbEAACAQUAAAAAAAAAAAAAAAAAATEQITJxkf/aAAgBAQAGPwIsYrlIT2Qf/8QAGhAAAwADAQAAAAAAAAAAAAAAAAERITGBQf/aAAgBAQABPyHrNEV0S8q4LBb+ANprCviP/9oADAMBAAIAAwAAABAgH//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQEAAgMBAAAAAAAAAAAAAAERACExQXFh/9oACAEBAAE/ELzdH3Nj0qDEXxwWxTrNVA6cqVbqUMQd2jA8z//Z'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Unit Test with Matchers and Helpers"
        title="Unit Test with Matchers and Helpers"
        src="/static/e2c7232dc0a42035fe23169d13b38803/a66cd/example1.jpg"
        srcset="/static/e2c7232dc0a42035fe23169d13b38803/f544b/example1.jpg 200w,
/static/e2c7232dc0a42035fe23169d13b38803/41689/example1.jpg 400w,
/static/e2c7232dc0a42035fe23169d13b38803/a66cd/example1.jpg 750w"
        sizes="(max-width: 750px) 100vw, 750px"
        loading="lazy"
      />
    </span></p>
<p>The Flex-Layout library has a responsive engine that supports change detection when a mediaQuery
activates (<em>aka</em> when the viewport size changes). The API uses selectors with dot-notation to
indicate which values should be used for which mediaQuery:</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">fxLayout</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span> <span class="token attr-name">fxLayout.md</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<p>Testing these features presents several additional requirements:</p>
<ul>
<li>mock the window API <code class="language-text">window.matchMedia(...)</code></li>
<li>simulate a mediaQuery activation</li>
<li>trigger fixture.detectChange() after a simulated activation</li>
<li>hide all these details from individual tests (DRY)</li>
</ul>
<p>Thankfully the Flex-Layout library actually publishes a MockMatchMedia class. And we use this class
in our TestBed configuration below:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> fixture<span class="token punctuation">:</span> ComponentFixture<span class="token operator">&lt;</span>any<span class="token operator">></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Special Helper
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">activateMediaQuery</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">alias</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> injector <span class="token operator">=</span> fixture<span class="token punctuation">.</span>debugElement<span class="token punctuation">.</span>injector<span class="token punctuation">;</span>
  <span class="token keyword">let</span> matchMedia <span class="token punctuation">:</span> MockMatchMedia <span class="token operator">=</span> injector<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>MatchMedia<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// simulate mediaQuery change and trigger fxLayout changes</span>
  matchMedia<span class="token punctuation">.</span><span class="token function">activate</span><span class="token punctuation">(</span>alias<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// Configure testbed to prepare services</span>
  TestBed<span class="token punctuation">.</span><span class="token function">configureTestingModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    imports<span class="token punctuation">:</span> <span class="token punctuation">[</span>FlexLayoutModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    declarations<span class="token punctuation">:</span> <span class="token punctuation">[</span>TestLayoutComponent<span class="token punctuation">]</span><span class="token punctuation">,</span>
    providers<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      BreakPointRegistry<span class="token punctuation">,</span> BreakPointsProvider<span class="token punctuation">,</span>
      <span class="token punctuation">{</span>provide<span class="token punctuation">:</span> MatchMedia<span class="token punctuation">,</span> useClass<span class="token punctuation">:</span> MockMatchMedia<span class="token punctuation">}</span>   <span class="token comment">//Special mock config</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Let’s explore three (3) very interesting things are happening in this code: </p>
<ul>
<li>configure Dependency Injection providers to override a class with a mock, </li>
<li>dynamic injection using <code class="language-text">injector.get(MatchMedia)</code>, and</li>
<li>use special helper <strong>activateMediaQuery( )</strong> function that hides all these details</li>
</ul>
<p><strong>(1) Overriding DI Providers</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">{</span> provide<span class="token punctuation">:</span> MatchMedia<span class="token punctuation">,</span> useClass<span class="token punctuation">:</span> MockMatchMedia <span class="token punctuation">}</span></code></pre></div>
<p>tells the TestBed DI system to provide an instance of the <code class="language-text">MockMatchMedia</code> <strong>whenever</strong> any code
asks for an instance of the <code class="language-text">MatchMedia</code> token to be injected via DI.</p>
<blockquote>
<p>You can read more about the Angular DI systems here:<br/> <a href="http://blog.thoughtram.io/angular/2015/05/18/dependency-injection-in-angular-2.html">Dependency Injection in Angular</a></p>
</blockquote>
<p><strong>(2) Dynamic Injection</strong></p>
<p>Our special helper <code class="language-text">activateMediaQuery()</code> needs a dynamic injected instance of the MatchMedia token.
Using the <code class="language-text">fixture</code> instance, we can access the injector service for our components. With the injector,
we can dynamically get a <strong>MockMatchMedia</strong> instance using the provider token <strong>MatchMedia</strong>.</p>
<blockquote>
<p>In this case, <strong>MatchMedia</strong> is both a class and a provider token used for D-injection. </p>
</blockquote>
<p>Notice that all this complexity [and construction details] on preparing a MockMatchMedia instance is
encapsulated in our TestBed… and the use of the injector is hidden within our special helper. </p>
<p>Now our individual tests simply use the easy special helper function <strong>activateMediaQuery( )</strong>:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">activateMediayQuery</span><span class="token punctuation">(</span><span class="token string">'md'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>That is very, very cool!</p>
<h2>3) Custom Matchers</h2>
<p>We have only one more tool [in our testing toolkit] to discuss: <strong>Custom Jasmine Matchers</strong>.</p>
<p>For those developers not familiar with the concepts of Jasmine <em>matchers</em>, we recommend the online
Jasmine documentation:</p>
<a href="https://jasmine.github.io/2.0/custom_matcher.html" title="Jasmine Matchers Documentation">
![pic9](https://cloud.githubusercontent.com/assets/210413/21524374/334a2f68-ccdb-11e6-816c-5059fc91d806.png)
</a>
<p>Remember that matchers are used <strong>after</strong> the <code class="language-text">expect()</code> call and should encapsulate complex logic
and reduce code-clutter in our test code.</p>
<blockquote>
<p>This allows our test(s) to remain terse, concise, readable, maintainable, and DRY.</p>
</blockquote>
<p>And we should always give our custom matcher functions clear, readable names. E.g. <strong>toHaveCssStyles()</strong>.</p>
<h3>Building a TypeScript Matcher</h3>
<p>Similar to <code class="language-text">expect(...).toBeTruthy()</code>, we want a custom matcher <code class="language-text">toHaveCSSStyle( )</code>:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">expectNativeEl</span><span class="token punctuation">(</span>fixture<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveCssStyle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string">'display'</span><span class="token punctuation">:</span> <span class="token string">'flex'</span><span class="token punctuation">,</span>
  <span class="token string">'flex-direction'</span><span class="token punctuation">:</span> <span class="token string">'row'</span><span class="token punctuation">,</span>
  <span class="token string">'box-sizing'</span><span class="token punctuation">:</span> <span class="token string">'border-box'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Creating a matcher in JavaScript is documented on the Jasmine site. Our challenge is the harder
goal of creating a <em>custom matcher</em> implemented in TypeScript using well-defined types.</p>
<ul>
<li>we need to enhance the <code class="language-text">expect()</code> API, and </li>
<li>we need to implement custom matchers.</li>
</ul>
<p>The global Jasmine <code class="language-text">expect()</code> method normally returns <code class="language-text">&lt;any&gt;</code> value. To use custom matchers
(with types), we want the <strong>expect( )</strong> function to support returning either a standard matcher or
a custom matcher.</p>
<p>Here is a teaser that shows how that is done:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">expect</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">actual<span class="token punctuation">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> NgMatchers <span class="token operator">=</span> <span class="token operator">&lt;</span>any<span class="token operator">></span> _global<span class="token punctuation">.</span>expect<span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">NgMatchers</span> <span class="token keyword">extends</span> <span class="token class-name">jasmine<span class="token punctuation">.</span>Matchers</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>We assigned the global <em>expect</em> function reference to a new export that states that <code class="language-text">expect()</code> calls
now return references to a <strong>NgMatchers</strong> interface.</p>
<p>Here are the full implementation details of our <code class="language-text">custom-matchers.ts</code> module:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">declare <span class="token keyword">var</span> global<span class="token punctuation">:</span> any<span class="token punctuation">;</span>
<span class="token keyword">const</span> _global <span class="token operator">=</span> <span class="token operator">&lt;</span>any<span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">typeof</span> window <span class="token operator">===</span> <span class="token string">'undefined'</span> <span class="token operator">?</span> global <span class="token punctuation">:</span> window<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Extend the API to support chaining with custom matchers
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">expect</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">actual<span class="token punctuation">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> NgMatchers <span class="token operator">=</span> <span class="token operator">&lt;</span>any<span class="token operator">></span> _global<span class="token punctuation">.</span>expect<span class="token punctuation">;</span>

<span class="token comment">/**
 * Jasmine matchers that support checking custom CSS conditions.
 * !! important to add your custom matcher to the interface
 */</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">NgMatchers</span> <span class="token keyword">extends</span> <span class="token class-name">jasmine<span class="token punctuation">.</span>Matchers</span> <span class="token punctuation">{</span>
  <span class="token function">toHaveCssStyle</span><span class="token punctuation">(</span>expected<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>k<span class="token punctuation">:</span> string<span class="token punctuation">]</span><span class="token punctuation">:</span> string<span class="token punctuation">}</span><span class="token operator">|</span>string<span class="token punctuation">)</span><span class="token punctuation">:</span> boolean<span class="token punctuation">;</span>
  not<span class="token punctuation">:</span> NgMatchers<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Implementation of 1...n custom matchers
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> customMatchers<span class="token punctuation">:</span> jasmine<span class="token punctuation">.</span>CustomMatcherFactories <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// Here is our custom matcher; cloned from @angular/core</span>
  <span class="token function-variable function">toHaveCssStyle</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">compare</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">actual<span class="token punctuation">:</span> any<span class="token punctuation">,</span> styles<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>k<span class="token punctuation">:</span> string<span class="token punctuation">]</span><span class="token punctuation">:</span> string<span class="token punctuation">}</span><span class="token operator">|</span>string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> allPassed<span class="token punctuation">:</span> boolean<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> styles <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          allPassed <span class="token operator">=</span> <span class="token function">getDOM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasStyle</span><span class="token punctuation">(</span>actual<span class="token punctuation">,</span> styles<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          allPassed <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>styles<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">;</span>
          Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>styles<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">prop</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
            allPassed <span class="token operator">=</span> allPassed <span class="token operator">&amp;&amp;</span> <span class="token function">getDOM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasStyle</span><span class="token punctuation">(</span>actual<span class="token punctuation">,</span> prop<span class="token punctuation">,</span> styles<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          pass<span class="token punctuation">:</span> allPassed<span class="token punctuation">,</span>
          <span class="token keyword">get</span> <span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> expectedValueStr <span class="token operator">=</span> <span class="token keyword">typeof</span> styles <span class="token operator">===</span> <span class="token string">'string'</span> <span class="token operator">?</span> styles <span class="token punctuation">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>styles<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Expected </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>actual<span class="token punctuation">.</span>outerHTML<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token operator">!</span>allPassed <span class="token operator">?</span> <span class="token string">' '</span> <span class="token punctuation">:</span> <span class="token string">'not '</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">to contain the
                      CSS </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">typeof</span> styles <span class="token operator">===</span> <span class="token string">'string'</span> <span class="token operator">?</span> <span class="token string">'property'</span> <span class="token punctuation">:</span> <span class="token string">'styles'</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> "</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>expectedValueStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>With the above definitions, we can now use <code class="language-text">expect(...).toHaveCssStyles(...)</code> without any
TypeScript complaints.</p>
<p>Wait! </p>
<p>We need one to discuss one more addition to our custom-matcher code. Did you notice the call to
<strong>getDOM()</strong>.hasStyle() ? But where does <code class="language-text">getDOM</code> come from? </p>
<p>After some inspection of the <strong>@angular/core</strong> code, we were able to
get a reference to the special Angular DOM Adapter:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>__platform_browser_private__<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/platform-browser'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> getDOM <span class="token operator">=</span> __platform_browser_private__<span class="token punctuation">.</span>getDOM<span class="token punctuation">;</span></code></pre></div>
<blockquote>
<p>Please note that the <strong>getDOM()</strong> is a private Angular API and may change in the future.</p>
</blockquote>
<h3>Using a Custom Matcher</h3>
<p>Now we are <em>golden</em> with features. Let’s import and use our custom Jasmine matcher.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>customMatchers<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../utils/testing/custom-matchers'</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'layout directive'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>

  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    jasmine<span class="token punctuation">.</span><span class="token function">addMatchers</span><span class="token punctuation">(</span>customMatchers<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// TestBed stuff here...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Notice that we must register the custom matchers in a <code class="language-text">beforeEach()</code> call to configure the
matchers for each subsequent test. And now everything is ready for the individual tests:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">expect</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveCssStyle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string">'display'</span><span class="token punctuation">:</span> <span class="token string">'flex'</span><span class="token punctuation">,</span>
  <span class="token string">'flex-direction'</span><span class="token punctuation">:</span> <span class="token string">'row'</span><span class="token punctuation">,</span>
  <span class="token string">'box-sizing'</span><span class="token punctuation">:</span> <span class="token string">'border-box'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h2>Protractor + e2e</h2>
<p>It should be noted that the above sample tests confirm whether CSS styles have been applied
correctly to the DOM element. Unit tests perform tests logic and state… but those same
tests cannot easily test how those values affect renderings in the UI.</p>
<p>Jasmine unit tests <strong>do not</strong> test whether the CSS styles or states render the elements in the
browser as expected. Nor do they test renderings across different browsers. Those types of visual
tests are best performed in e2e testing with Protractor and visual differencing tools.</p>
<h2>Summary</h2>
<p>Perhaps you will say: “Wow, this is cool… but totally overkill!”  If you are tempted to say that,
then look at all the DRY tests here:
<a href="https://github.com/angular/flex-layout/blob/master/src/lib/flexbox/api/layout.spec.ts#L45">layout.spec.ts</a>.
You will quickly see the value of using helpers and custom matchers.</p>
<p>You now have the techniques and tools to create your own custom matchers and deliver quality, terse
unit tests.</p>
<p>Enjoy!</p>
<h2>Resources</h2>
<ul>
<li><a href="https://github.com/angular/flex-layout/blob/master/src/lib/utils/testing/custom-matchers.ts">Custom Matchers</a>: a full set of custom Jasmine Matchers</li>
<li><a href="https://github.com/angular/flex-layout/blob/master/src/lib/utils/testing/helpers.ts">Special Helpers</a>: a reusable, importable set of Helpers</li>
<li><a href="https://github.com/angular/flex-layout/blob/master/src/lib/flexbox/api/layout.spec.ts#L45">Usage Samples</a>: a full DRY set of usages.</li>
</ul>
<blockquote>
<p>The Flex-Layout Helper functions are actually partial applications (function currying). Here is
<a href="https://github.com/angular/flex-layout/blob/master/src/lib/flexbox/api/layout.spec.ts#L16-L17">How to use</a> them.</p>
</blockquote></div></section><section class="thtrm-section"><div class="thtrm-section__heading thtrm-article-header thtrm-section-constrained u-distance-reset"><div class="thtrm-metabar thtrm-article-header__metabar"><div class="thtrm-metabar__item thtrm-topic u-color--grey"><div class="thtrm-media-short">Written by  <img alt="Author" src="https://avatars3.githubusercontent.com/u/210413?s=400&amp;v=4" class="thtrm-avatar"/><p class="thtrm-media-short__body"><a href="https://twitter.com/thomasburleson" class="u-link-plain">Thomas Burleson</a></p></div></div></div></div></section></main><footer class="thtrm-footer" role="contentinfo"><div class="thtrm-copyright"><p>© <!-- -->2024<!-- --> The thoughtram Blog Maintainers</p></div></footer><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" hidden=""><symbol viewBox="0 0 24 24" id="icon--chevron-right"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path><path d="M0 0h24v24H0z" fill="none"></path></symbol><symbol viewBox="0 0 24 24" id="icon--chevron-down"><path d="M7.41 7.84L12 12.42l4.59-4.58L18 9.25l-6 6-6-6z"></path><path d="M0-.75h24v24H0z" fill="none"></path></symbol><symbol viewBox="0 0 24 24" id="icon--menu"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path><path d="M0 0h24v24H0z" fill="none"></path></symbol></svg></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-51360648-2', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/angular/2016/12/27/angular-2-advance-testing-with-custom-matchers.html";window.webpackCompilationHash="0c5d630095500f933ccd";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-db11fdec89ef44788bcc.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-6a14d6c49d22aa388ff9.js"],"component---src-templates-category-js":["/component---src-templates-category-js-4376524bed80ab31f5c7.js"],"component---src-pages-404-js":["/component---src-pages-404-js-6a74e57e5569370f5224.js"],"component---src-pages-all-js":["/component---src-pages-all-js-7aa251af6b402c5bb6a7.js"],"component---src-pages-confirmation-thank-you-js":["/component---src-pages-confirmation-thank-you-js-e20b16d362e2acd832ef.js"],"component---src-pages-finish-newsletter-subscription-js":["/component---src-pages-finish-newsletter-subscription-js-9bc9dd352c7e25398f2b.js"],"component---src-pages-index-js":["/component---src-pages-index-js-34313bc70d6e2470e416.js"]};/*]]>*/</script><script src="/webpack-runtime-c99afa6b532686815600.js" async=""></script><script src="/app-db11fdec89ef44788bcc.js" async=""></script><script src="/commons-9a6c7e4a80f98fe6d0b9.js" async=""></script><script src="/styles-e0e38ca7b54561c3f057.js" async=""></script><script src="/component---src-templates-blog-post-js-6a14d6c49d22aa388ff9.js" async=""></script></body></html>